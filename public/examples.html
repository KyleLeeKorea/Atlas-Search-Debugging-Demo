<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atlas Search ë””ë²„ê¹… ì˜ˆì œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Euclid Circular A', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #001E2B;
            color: #FFFFFF;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .subtitle {
            color: #B8C5D1;
            margin-bottom: 40px;
            font-size: 16px;
        }

        .connection-form {
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid rgba(0, 237, 100, 0.2);
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 30px;
        }

        .connection-form input {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            color: #FFFFFF;
            font-size: 14px;
            margin: 8px 0;
        }

        .connection-form input:focus {
            outline: none;
            border-color: #00ED64;
        }

        .connection-form label {
            display: block;
            margin-top: 12px;
            font-size: 14px;
            color: #FFFFFF;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 24px;
            background: transparent;
            border: none;
            color: #B8C5D1;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }

        .tab:hover {
            color: #FFFFFF;
        }

        .tab.active {
            color: #00ED64;
            border-bottom-color: #00ED64;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .scenario {
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid rgba(0, 237, 100, 0.2);
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .scenario h2 {
            font-size: 20px;
            margin-bottom: 16px;
            color: #00ED64;
        }

        .scenario h3 {
            font-size: 16px;
            margin-top: 20px;
            margin-bottom: 12px;
            color: #FFFFFF;
        }

        .problem-box {
            background: rgba(255, 82, 82, 0.1);
            border: 1px solid rgba(255, 82, 82, 0.3);
            border-radius: 6px;
            padding: 16px;
            margin: 16px 0;
        }

        .solution-box {
            background: rgba(0, 237, 100, 0.1);
            border: 1px solid rgba(0, 237, 100, 0.3);
            border-radius: 6px;
            padding: 16px;
            margin: 16px 0;
        }

        .code-block {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            padding: 16px;
            margin: 12px 0;
            overflow-x: auto;
            font-family: 'SF Mono', 'Monaco', 'Courier New', monospace;
            font-size: 13px;
            color: #B8C5D1;
            position: relative;
        }

        .code-block code {
            white-space: pre;
        }

        .execute-btn {
            background: #00ED64;
            color: #001E2B;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            margin-top: 12px;
            transition: all 0.2s;
        }

        .execute-btn:hover {
            background: #00D955;
            transform: translateY(-1px);
        }

        .execute-btn:disabled {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.3);
            cursor: not-allowed;
            transform: none;
        }

        .result-box {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            padding: 16px;
            margin: 12px 0;
            display: none;
        }

        .result-box.show {
            display: block;
        }

        .result-box.success {
            border-color: rgba(0, 237, 100, 0.3);
        }

        .result-box.error {
            border-color: rgba(255, 82, 82, 0.3);
        }

        .result-box pre {
            color: #B8C5D1;
            font-family: 'SF Mono', 'Monaco', 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
            margin: 8px 0;
        }

        .result-box .result-header {
            color: #00ED64;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .result-box.error .result-header {
            color: #FF5252;
        }

        .checklist {
            list-style: none;
            padding-left: 0;
        }

        .checklist li {
            padding: 8px 0;
            padding-left: 24px;
            position: relative;
        }

        .checklist li:before {
            content: "â–¡";
            position: absolute;
            left: 0;
            color: #00ED64;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #00ED64;
            text-decoration: none;
            font-size: 14px;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        p {
            margin: 12px 0;
            color: #B8C5D1;
        }

        strong {
            color: #FFFFFF;
        }

        .loading {
            display: inline-block;
            width: 14px;
            height: 14px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top-color: #00ED64;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
            margin-left: 8px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .footer-link {
            position: fixed;
            top: 12px;
            right: 12px;
            font-size: 10px;
            color: rgba(255, 255, 255, 0.4);
            text-decoration: none;
            z-index: 1000;
            transition: color 0.2s ease;
        }

        .footer-link:hover {
            color: rgba(255, 255, 255, 0.6);
        }

        @media (max-width: 768px) {
            .footer-link {
                font-size: 9px;
                top: 8px;
                right: 8px;
            }
        }
    </style>
</head>
<body>
    <a href="https://github.com/KyleLeeKorea/Atlas-Search-Debugging-Demo" target="_blank" class="footer-link">
        https://github.com/KyleLeeKorea/Atlas-Search-Debugging-Demo , Created by Kyle Lee, 20251218
    </a>
    <div class="container">
        <a href="/" class="back-link">â† ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
        
        <h1>Atlas Search ë””ë²„ê¹… ì˜ˆì œ</h1>
        <p class="subtitle">ê°€ì¥ í”í•œ ë””ë²„ê¹… ì‹œë‚˜ë¦¬ì˜¤ Top 5ì™€ ì‹¤ì „ ì˜ˆì œ</p>

        <div class="connection-form">
            <h3 style="color: #00ED64; margin-bottom: 16px;">ì—°ê²° ì •ë³´</h3>
            <label>MongoDB Atlas ì—°ê²° ë¬¸ìì—´</label>
            <textarea id="connectionString" rows="2" placeholder="mongodb+srv://username:password@cluster.mongodb.net/" style="width: 100%; padding: 12px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 6px; color: #FFFFFF; font-size: 14px; font-family: 'SF Mono', 'Monaco', 'Courier New', monospace; resize: vertical;"></textarea>
            <label>ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„</label>
            <input type="text" id="dbName" placeholder="atlas_search_demo" />
            <p style="margin-top: 12px; font-size: 13px; color: #7A8B99;">
                ë©”ì¸ í˜ì´ì§€ì—ì„œ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë¡œë”©í•œ ê²½ìš°, ì—°ê²° ì •ë³´ê°€ ìë™ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤.
            </p>
            <div id="connectionStatus" style="margin-top: 12px; padding: 12px; border-radius: 6px; display: none;"></div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab(0)">ì‹œë‚˜ë¦¬ì˜¤ 1: ê²€ìƒ‰ ê²°ê³¼ 0ê±´</button>
            <button class="tab" onclick="showTab(1)">ì‹œë‚˜ë¦¬ì˜¤ 2: ê¸°ëŒ€ì™€ ë‹¤ë¥¸ ê²°ê³¼</button>
            <button class="tab" onclick="showTab(2)">ì‹œë‚˜ë¦¬ì˜¤ 3: ì„±ëŠ¥ ë¬¸ì œ</button>
            <button class="tab" onclick="showTab(3)">ì‹œë‚˜ë¦¬ì˜¤ 4: Index ë³€ê²½</button>
            <button class="tab" onclick="showTab(4)">ì‹œë‚˜ë¦¬ì˜¤ 5: ìš´ì˜ í™˜ê²½</button>
            <button class="tab" onclick="showTab(5)">ì²´í¬ë¦¬ìŠ¤íŠ¸</button>
        </div>

        <!-- ì‹œë‚˜ë¦¬ì˜¤ 1: ê²€ìƒ‰ ê²°ê³¼ê°€ 0ê±´ ë‚˜ì˜¤ëŠ” ê²½ìš° -->
        <div class="tab-content active">
            <div class="scenario">
                <h2>ì‹œë‚˜ë¦¬ì˜¤ 1: ê²€ìƒ‰ ê²°ê³¼ê°€ 0ê±´ ë‚˜ì˜¤ëŠ” ê²½ìš°</h2>
                
                <h3>ë¬¸ì œ 1: Indexê°€ ì—†ëŠ” ê²½ìš°</h3>
                <div class="problem-box">
                    <p><strong>ì¦ìƒ:</strong> Index 'productSearch' not found ì˜¤ë¥˜</p>
                    <div class="code-block">
                        <code>{
  $search: {
    index: "productSearch",
    text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
  }
}</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario1-1')">ì¿¼ë¦¬ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario1-1"></div>
                </div>
                <div class="solution-box">
                    <p><strong>í•´ê²° ë°©ë²• 1:</strong> Index ëª©ë¡ í™•ì¸</p>
                    <div class="code-block">
                        <code>// Index ëª©ë¡ í™•ì¸
db.products.getSearchIndexes()</code>
                    </div>
                    <button class="execute-btn" onclick="executeGetIndexes('products')">Index ëª©ë¡ ì¡°íšŒ</button>
                    <div class="result-box" id="result-indexes-products"></div>
                </div>
                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>í•´ê²° ë°©ë²• 2:</strong> Index ìƒì„± (Indexê°€ ì—†ëŠ” ê²½ìš°)</p>
                    <p style="color: #B8C5D1; font-size: 14px; margin: 12px 0;">MongoDB Atlas UIì—ì„œ Search Indexë¥¼ ìƒì„±í•˜ì„¸ìš”:</p>
                    <ol style="color: #B8C5D1; font-size: 14px; margin: 12px 0; padding-left: 20px;">
                        <li>MongoDB Atlas ì½˜ì†”ì— ë¡œê·¸ì¸</li>
                        <li>ì™¼ìª½ ë©”ë‰´ì—ì„œ <strong>Search</strong> í´ë¦­</li>
                        <li><strong>Create Search Index</strong> ë²„íŠ¼ í´ë¦­</li>
                        <li><strong>JSON Editor</strong> ì„ íƒ</li>
                        <li>ì•„ë˜ JSONì„ ë³µì‚¬í•˜ì—¬ ë¶™ì—¬ë„£ê¸°:</li>
                    </ol>
                    <div class="code-block">
                        <code>{
  "mappings": {
    "dynamic": false,
    "fields": {
      "name": {
        "type": "string",
        "analyzer": "lucene.korean"
      },
      "description": {
        "type": "string",
        "analyzer": "lucene.korean"
      },
      "category": {
        "type": "string",
        "analyzer": "lucene.keyword"
      },
      "price": {
        "type": "number"
      }
    }
  }
}</code>
                    </div>
                    <p style="color: #B8C5D1; font-size: 14px; margin: 12px 0;">
                        <strong>Index ì´ë¦„:</strong> <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">productSearch</code>
                    </p>
                    <p style="color: #B8C5D1; font-size: 14px; margin: 12px 0;">
                        <strong>Database:</strong> <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">Debug01</code> (ë˜ëŠ” ì‚¬ìš© ì¤‘ì¸ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„)
                    </p>
                    <p style="color: #B8C5D1; font-size: 14px; margin: 12px 0;">
                        <strong>Collection:</strong> <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">products</code>
                    </p>
                    <p style="color: #B8C5D1; font-size: 13px; margin-top: 12px; padding: 12px; background: rgba(0, 150, 255, 0.1); border-left: 3px solid #0096FF; border-radius: 4px;">
                        ğŸ’¡ <strong>ì°¸ê³ :</strong> Index ìƒì„± í›„ BUILDING ìƒíƒœì—ì„œ READY ìƒíƒœë¡œ ë³€ê²½ë˜ëŠ”ë° ëª‡ ë¶„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. READY ìƒíƒœê°€ ë˜ë©´ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                    <button class="execute-btn" onclick="checkIndexStatus('products', 'productSearch')" style="margin-top: 16px;">ì¸ë±ìŠ¤ ìƒì„± í™•ì¸</button>
                    <div class="result-box" id="result-indexes-products-check"></div>
                </div>

                <h3>ë¬¸ì œ 2: $searchMetaë¡œ ë§¤ì¹­ í™•ì¸</h3>
                <div class="solution-box">
                    <p><strong>ë””ë²„ê¹…:</strong> $searchMetaë¡œ ê²€ìƒ‰ ë§¤ì¹­ ì—¬ë¶€ í™•ì¸</p>
                    <div class="code-block">
                        <code>db.products.aggregate([
  {
    $searchMeta: {
      index: "productSearch",
      text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
    }
  }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario1-2')">$searchMeta ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario1-2"></div>
                </div>
            </div>
        </div>

        <!-- ì‹œë‚˜ë¦¬ì˜¤ 2: ê²°ê³¼ëŠ” ë‚˜ì˜¤ì§€ë§Œ ê¸°ëŒ€ì™€ ë‹¤ë¥¸ ê²½ìš° -->
        <div class="tab-content">
            <div class="scenario">
                <h2>ì‹œë‚˜ë¦¬ì˜¤ 2: ê²°ê³¼ëŠ” ë‚˜ì˜¤ì§€ë§Œ ê¸°ëŒ€ì™€ ë‹¤ë¥¸ ê²½ìš°</h2>
                
                <h3>ë¬¸ì œ 1: text vs autocomplete vs phrase ì°¨ì´</h3>
                <div class="problem-box">
                    <p><strong>ì°¨ì´ì :</strong></p>
                    <ul>
                        <li><strong>text:</strong> ê°¤ëŸ­ì‹œì™€ í”„ë¡œë¥¼ ê°ê° ê²€ìƒ‰ (OR ì¡°ê±´)</li>
                        <li><strong>autocomplete:</strong> ê°¤ëŸ­ì‹œë¡œ ì‹œì‘í•˜ëŠ” ë‹¨ì–´ ê²€ìƒ‰</li>
                        <li><strong>phrase:</strong> ê°¤ëŸ­ì‹œ í”„ë¡œë¥¼ ì •í™•í•œ êµ¬ë¬¸ìœ¼ë¡œ ê²€ìƒ‰</li>
                    </ul>
                </div>
                <div class="solution-box">
                    <p><strong>text ê²€ìƒ‰:</strong></p>
                    <div class="code-block">
                        <code>db.products.aggregate([
  {
    $search: {
      index: "productSearch",
      text: { query: "ê°¤ëŸ­ì‹œ í”„ë¡œ", path: "name" }
    }
  },
  { $limit: 5 }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario2-1-text')">text ê²€ìƒ‰ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario2-1-text"></div>
                </div>

                <h3>ë¬¸ì œ 2: Score í™•ì¸</h3>
                <div class="solution-box">
                    <p><strong>ë””ë²„ê¹…:</strong> Score ê¸°ì¤€ ì •ë ¬ë¡œ ê´€ë ¨ë„ í™•ì¸</p>
                    <div class="code-block">
                        <code>db.products.aggregate([
  {
    $search: {
      index: "productSearch",
      text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
    }
  },
  {
    $addFields: {
      score: { $meta: "searchScore" }
    }
  },
  {
    $sort: { score: -1 }
  },
  { $limit: 5 }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario2-2')">Score í™•ì¸ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario2-2"></div>
                </div>
            </div>
        </div>

        <!-- ì‹œë‚˜ë¦¬ì˜¤ 3: ì„±ëŠ¥ì´ ëŠë¦° ê²½ìš° -->
        <div class="tab-content">
            <div class="scenario">
                <h2>ì‹œë‚˜ë¦¬ì˜¤ 3: ì„±ëŠ¥ì´ ëŠë¦° ê²½ìš°</h2>
                
                <h3>ë¬¸ì œ 1: ë‹¨ìˆœ ê²€ìƒ‰ ì¿¼ë¦¬</h3>
                <div class="solution-box">
                    <p><strong>ì„±ëŠ¥ ì¸¡ì •:</strong> ë‹¨ìˆœ ê²€ìƒ‰ ì¿¼ë¦¬ ì‹¤í–‰ ì‹œê°„ í™•ì¸</p>
                    <div class="code-block">
                        <code>db.products.aggregate([
  {
    $search: {
      index: "productSearch",
      text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
    }
  },
  { $limit: 10 }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario3-1')">ì„±ëŠ¥ ì¸¡ì • ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario3-1"></div>
                </div>
            </div>
        </div>

        <!-- ì‹œë‚˜ë¦¬ì˜¤ 4: Index ë³€ê²½ -->
        <div class="tab-content">
            <div class="scenario">
                <h2>ì‹œë‚˜ë¦¬ì˜¤ 4: Index ë³€ê²½ í›„ ê²°ê³¼ê°€ ì´ìƒí•œ ê²½ìš°</h2>
                
                <h3>ë¬¸ì œ 1: Index Status í™•ì¸</h3>
                <div class="solution-box">
                    <p><strong>ë””ë²„ê¹…:</strong> Index Status í™•ì¸ (BUILDING / READY / FAILED)</p>
                    <div class="code-block">
                        <code>db.products.getSearchIndexes()</code>
                    </div>
                    <button class="execute-btn" onclick="executeGetIndexes('products')">Index Status í™•ì¸</button>
                    <div class="result-box" id="result-scenario4-1"></div>
                </div>
            </div>
        </div>

        <!-- ì‹œë‚˜ë¦¬ì˜¤ 5: ìš´ì˜ í™˜ê²½ -->
        <div class="tab-content">
            <div class="scenario">
                <h2>ì‹œë‚˜ë¦¬ì˜¤ 5: ìš´ì˜ í™˜ê²½ì—ì„œë§Œ ë°œìƒí•˜ëŠ” ë¬¸ì œ</h2>
                
                <h3>ë°ì´í„° í™•ì¸</h3>
                <div class="solution-box">
                    <p><strong>ë°ì´í„° í™•ì¸:</strong> ìƒ˜í”Œ ë°ì´í„° í™•ì¸</p>
                    <div class="code-block">
                        <code>db.products.find().limit(5)</code>
                    </div>
                    <button class="execute-btn" onclick="executeFind('products', {})">ë°ì´í„° í™•ì¸</button>
                    <div class="result-box" id="result-scenario5-1"></div>
                </div>
            </div>
        </div>

        <!-- ì²´í¬ë¦¬ìŠ¤íŠ¸ -->
        <div class="tab-content">
            <div class="scenario">
                <h2>ë””ë²„ê¹… ì²´í¬ë¦¬ìŠ¤íŠ¸</h2>
                
                <h3>ê¸°ë³¸ í™•ì¸ ì‚¬í•­</h3>
                <ul class="checklist">
                    <li>Index ì¡´ì¬ ì—¬ë¶€ í™•ì¸: db.collection.getSearchIndexes()</li>
                    <li>Index Status í™•ì¸ (BUILDING / READY / FAILED)</li>
                    <li>Mapping vs ì‹¤ì œ ë°ì´í„° êµ¬ì¡° ì¼ì¹˜ ì—¬ë¶€</li>
                    <li>Analyzer í™•ì¸</li>
                    <li>$searchMeta í™œìš©</li>
                    <li>ë‹¨ìˆœ ì¿¼ë¦¬ë¶€í„° ë‹¨ê³„ì  í™•ì¥</li>
                </ul>

                <h3>ìœ ìš©í•œ ë””ë²„ê¹… ì¿¼ë¦¬</h3>
                <div class="code-block">
                    <code>// Index ì •ë³´ í™•ì¸
db.collection.getSearchIndexes()

// $searchMetaë¡œ ë§¤ì¹­ í™•ì¸
db.collection.aggregate([
  {
    $searchMeta: {
      index: "indexName",
      text: { query: "ê²€ìƒ‰ì–´", path: "fieldName" }
    }
  }
])</code>
                </div>
            </div>
        </div>
    </div>

    <script>
        // localStorageì—ì„œ ì—°ê²° ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°
        window.addEventListener('DOMContentLoaded', () => {
            const savedConnectionString = localStorage.getItem('atlasDemoConnectionString');
            const savedDbName = localStorage.getItem('atlasDemoDbName');
            
            console.log('ì €ì¥ëœ ì—°ê²° ì •ë³´:', { 
                connectionString: savedConnectionString ? savedConnectionString.substring(0, 30) + '...' : 'ì—†ìŒ',
                connectionStringLength: savedConnectionString ? savedConnectionString.length : 0,
                dbName: savedDbName || 'ì—†ìŒ',
                connectionStringValid: savedConnectionString ? (savedConnectionString.startsWith('mongodb://') || savedConnectionString.startsWith('mongodb+srv://')) : false
            });
            
            const connectionStringInput = document.getElementById('connectionString');
            const dbNameInput = document.getElementById('dbName');
            const statusDiv = document.getElementById('connectionStatus');

            if (savedConnectionString && connectionStringInput) {
                connectionStringInput.value = savedConnectionString;
                console.log('ì—°ê²° ë¬¸ìì—´ ì…ë ¥ í•„ë“œì— ê°’ ì„¤ì • ì™„ë£Œ:', {
                    fieldValue: connectionStringInput.value.substring(0, 30),
                    fieldValueLength: connectionStringInput.value.length
                });
                updateConnectionStatus(true, 'ì—°ê²° ì •ë³´ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');
            } else {
                console.warn('ì €ì¥ëœ ì—°ê²° ë¬¸ìì—´ì´ ì—†ìŠµë‹ˆë‹¤.');
                updateConnectionStatus(false, 'âš ï¸ ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë©”ì¸ í˜ì´ì§€ì—ì„œ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë¨¼ì € ë¡œë”©í•˜ê±°ë‚˜, ì•„ë˜ì— ì—°ê²° ì •ë³´ë¥¼ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”.');
            }
            
            if (savedDbName && dbNameInput) {
                dbNameInput.value = savedDbName;
                console.log('ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ ì…ë ¥ í•„ë“œì— ê°’ ì„¤ì • ì™„ë£Œ:', dbNameInput.value);
            }

            // ì—°ê²° ì •ë³´ê°€ ì—†ìœ¼ë©´ ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ
            if (!savedConnectionString || !savedDbName) {
                updateConnectionStatus(false, 'âš ï¸ ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë©”ì¸ í˜ì´ì§€ì—ì„œ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë¨¼ì € ë¡œë”©í•˜ê±°ë‚˜, ì•„ë˜ì— ì—°ê²° ì •ë³´ë¥¼ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”.');
            }

            // ì…ë ¥ í•„ë“œ ë³€ê²½ ê°ì§€
            if (connectionStringInput) {
                connectionStringInput.addEventListener('input', () => {
                    const value = connectionStringInput.value.trim();
                    if (value && (value.startsWith('mongodb://') || value.startsWith('mongodb+srv://'))) {
                        updateConnectionStatus(true, 'ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì˜¬ë°”ë¦…ë‹ˆë‹¤.');
                        localStorage.setItem('atlasDemoConnectionString', value);
                    } else if (value) {
                        updateConnectionStatus(false, 'ì—°ê²° ë¬¸ìì—´ì€ mongodb:// ë˜ëŠ” mongodb+srv://ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.');
                    } else {
                        updateConnectionStatus(false, 'ì—°ê²° ë¬¸ìì—´ì„ ì…ë ¥í•˜ì„¸ìš”.');
                    }
                });
            }

            if (dbNameInput) {
                dbNameInput.addEventListener('input', () => {
                    const value = dbNameInput.value.trim();
                    if (value) {
                        localStorage.setItem('atlasDemoDbName', value);
                    }
                });
            }
        });

        function updateConnectionStatus(isValid, message) {
            const statusDiv = document.getElementById('connectionStatus');
            if (!statusDiv) return;
            
            statusDiv.style.display = 'block';
            statusDiv.style.background = isValid ? 'rgba(0, 237, 100, 0.1)' : 'rgba(255, 193, 7, 0.1)';
            statusDiv.style.border = isValid ? '1px solid rgba(0, 237, 100, 0.3)' : '1px solid rgba(255, 193, 7, 0.3)';
            statusDiv.style.color = isValid ? '#00ED64' : '#FFC107';
            statusDiv.style.fontSize = '13px';
            statusDiv.textContent = message;
        }

        function showTab(index) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach((tab, i) => {
                if (i === index) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            contents.forEach((content, i) => {
                if (i === index) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
        }

        async function executeQuery(queryId) {
            // ë¨¼ì € localStorageì—ì„œ ì—°ê²° ì •ë³´ í™•ì¸
            let connectionString = localStorage.getItem('atlasDemoConnectionString');
            let dbName = localStorage.getItem('atlasDemoDbName');
            
            console.log('1. localStorageì—ì„œ ì½ì€ ê°’:', {
                connectionString: connectionString ? connectionString.substring(0, 30) + '...' : 'ì—†ìŒ',
                connectionStringLength: connectionString ? connectionString.length : 0,
                dbName: dbName || 'ì—†ìŒ'
            });
            
            // localStorageì— ì—†ìœ¼ë©´ ì…ë ¥ í•„ë“œì—ì„œ ì½ê¸°
            const connectionStringInput = document.getElementById('connectionString');
            const dbNameInput = document.getElementById('dbName');
            
            if (!connectionString && connectionStringInput) {
                connectionString = connectionStringInput.value.trim();
                console.log('2. ì…ë ¥ í•„ë“œì—ì„œ ì½ì€ ê°’:', {
                    connectionString: connectionString ? connectionString.substring(0, 30) + '...' : 'ì—†ìŒ',
                    connectionStringLength: connectionString ? connectionString.length : 0
                });
            }
            
            if (!dbName && dbNameInput) {
                dbName = dbNameInput.value.trim();
            }
            
            // ìµœì¢…ì ìœ¼ë¡œ ì‚¬ìš©í•  ì—°ê²° ì •ë³´
            connectionString = connectionString ? connectionString.trim() : '';
            dbName = dbName ? dbName.trim() : '';
            
            const resultBox = document.getElementById(`result-${queryId}`);
            
            console.log('3. ìµœì¢… ì‚¬ìš©í•  ì—°ê²° ì •ë³´:', { 
                queryId, 
                connectionStringExists: !!connectionString,
                connectionStringLength: connectionString.length,
                connectionStringPreview: connectionString ? connectionString.substring(0, 50) + '...' : 'ë¹„ì–´ìˆìŒ',
                connectionStringStartsWith: connectionString ? (connectionString.startsWith('mongodb://') || connectionString.startsWith('mongodb+srv://')) : false,
                dbName: dbName || 'ë¹„ì–´ìˆìŒ'
            });
            
            // ì—°ê²° ë¬¸ìì—´ ê²€ì¦
            if (!connectionString || connectionString === '') {
                const errorMsg = 'ì—°ê²° ë¬¸ìì—´ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.';
                const hintMsg = 'ì—°ê²° ë¬¸ìì—´ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\n' +
                    'í•´ê²° ë°©ë²•:\n' +
                    '1. ë©”ì¸ í˜ì´ì§€(/)ë¡œ ì´ë™í•˜ì—¬ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë¡œë”©í•˜ì„¸ìš”.\n' +
                    '2. ë˜ëŠ” ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— MongoDB Atlas ì—°ê²° ë¬¸ìì—´ì„ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”.\n\n' +
                    'localStorage ê°’: ' + (localStorage.getItem('atlasDemoConnectionString') ? 'ìˆìŒ' : 'ì—†ìŒ') + '\n' +
                    'ì…ë ¥ í•„ë“œ ê°’: ' + (connectionStringInput && connectionStringInput.value ? 'ìˆìŒ' : 'ì—†ìŒ');
                console.error('âŒ', errorMsg, { 
                    localStorageValue: localStorage.getItem('atlasDemoConnectionString') ? 'ìˆìŒ' : 'ì—†ìŒ',
                    inputFieldValue: connectionStringInput ? connectionStringInput.value : 'í•„ë“œ ì—†ìŒ'
                });
                showError(resultBox, errorMsg, hintMsg);
                return;
            }

            if (!dbName || dbName === '') {
                showError(resultBox, 'ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.', 'ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì—°ê²° ë¬¸ìì—´ í˜•ì‹ ê²€ì¦
            if (!connectionString.startsWith('mongodb://') && !connectionString.startsWith('mongodb+srv://')) {
                const errorMsg = 'ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                const hintMsg = 'ì—°ê²° ë¬¸ìì—´ì€ mongodb:// ë˜ëŠ” mongodb+srv://ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.\n\n' +
                    'í˜„ì¬ ê°’ì˜ ì‹œì‘ ë¶€ë¶„: "' + connectionString.substring(0, 50) + '"\n' +
                    'ì „ì²´ ê¸¸ì´: ' + connectionString.length + 'ì';
                console.error(errorMsg, { connectionString: connectionString.substring(0, 100) });
                showError(resultBox, errorMsg, hintMsg);
                return;
            }

            if (connectionString.includes('localhost') || connectionString.includes('127.0.0.1') || connectionString.includes(':28000')) {
                const errorMsg = 'ì—°ê²° ë¬¸ìì—´ì— localhostê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.';
                const hintMsg = 'MongoDB Atlas ì—°ê²° ë¬¸ìì—´ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.\n\n' +
                    'localhost, 127.0.0.1, ë˜ëŠ” :28000ì´ í¬í•¨ëœ ì—°ê²° ë¬¸ìì—´ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n' +
                    'í˜„ì¬ ì—°ê²° ë¬¸ìì—´: ' + connectionString.substring(0, 100);
                console.error(errorMsg, { connectionString: connectionString.substring(0, 100) });
                showError(resultBox, errorMsg, hintMsg);
                return;
            }

            resultBox.classList.remove('show', 'success', 'error');
            resultBox.classList.add('show');
            resultBox.innerHTML = `
                <div class="result-header">ì‹¤í–‰ ì¤‘...</div>
                <div style="margin-top: 12px; padding: 12px; background: rgba(0, 0, 0, 0.3); border-radius: 4px; font-size: 12px; font-family: monospace;">
                    <div style="color: #B8C5D1; margin-bottom: 4px;">ì—°ê²° ë¬¸ìì—´:</div>
                    <div style="color: #00ED64; word-break: break-all;">${connectionString.substring(0, 80)}...</div>
                    <div style="color: #B8C5D1; margin-top: 8px;">ë°ì´í„°ë² ì´ìŠ¤: ${dbName}</div>
                </div>
                <div class="loading"></div>
            `;

            const queries = {
                'scenario1-1': [
                    {
                        $search: {
                            index: "productSearch",
                            text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
                        }
                    },
                    { $limit: 5 }
                ],
                'scenario1-2': [
                    {
                        $searchMeta: {
                            index: "productSearch",
                            text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
                        }
                    }
                ],
                'scenario2-1-text': [
                    {
                        $search: {
                            index: "productSearch",
                            text: { query: "ê°¤ëŸ­ì‹œ í”„ë¡œ", path: "name" }
                        }
                    },
                    { $limit: 5 }
                ],
                'scenario2-2': [
                    {
                        $search: {
                            index: "productSearch",
                            text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
                        }
                    },
                    {
                        $addFields: {
                            score: { $meta: "searchScore" }
                        }
                    },
                    {
                        $sort: { score: -1 }
                    },
                    { $limit: 5 }
                ],
                'scenario3-1': [
                    {
                        $search: {
                            index: "productSearch",
                            text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
                        }
                    },
                    { $limit: 10 }
                ]
            };

            try {
                // ì—°ê²° ë¬¸ìì—´ ìµœì¢… í™•ì¸ - ë” ì—„ê²©í•˜ê²Œ
                const trimmedConnStr = connectionString.trim();
                const trimmedDbName = dbName.trim();

                console.log('ìµœì¢… ê²€ì¦:', {
                    connectionStringExists: !!trimmedConnStr,
                    connectionStringLength: trimmedConnStr.length,
                    connectionStringPrefix: trimmedConnStr.substring(0, 30),
                    dbNameExists: !!trimmedDbName,
                    dbName: trimmedDbName
                });

                if (!trimmedConnStr || trimmedConnStr === '') {
                    console.error('ì—°ê²° ë¬¸ìì—´ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.');
                    showError(resultBox, 'ì—°ê²° ë¬¸ìì—´ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.', 'ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— MongoDB Atlas ì—°ê²° ë¬¸ìì—´ì„ ì…ë ¥í•˜ì„¸ìš”.\n\ní˜„ì¬ ì…ë ¥ í•„ë“œ ê°’: "' + (connectionStringInput.value || '(ë¹„ì–´ìˆìŒ)') + '"');
                    return;
                }

                if (!trimmedConnStr.startsWith('mongodb://') && !trimmedConnStr.startsWith('mongodb+srv://')) {
                    console.error('ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤:', trimmedConnStr.substring(0, 30));
                    showError(resultBox, 'ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'ì—°ê²° ë¬¸ìì—´ì€ mongodb:// ë˜ëŠ” mongodb+srv://ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.\n\ní˜„ì¬ ê°’ì˜ ì‹œì‘ ë¶€ë¶„: "' + trimmedConnStr.substring(0, 50) + '"');
                    return;
                }

                if (trimmedConnStr.includes('localhost') || trimmedConnStr.includes('127.0.0.1') || trimmedConnStr.includes(':28000')) {
                    console.error('ì—°ê²° ë¬¸ìì—´ì— localhostê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤:', trimmedConnStr);
                    showError(resultBox, 'ì—°ê²° ë¬¸ìì—´ì— localhostê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.', 'MongoDB Atlas ì—°ê²° ë¬¸ìì—´ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. localhost, 127.0.0.1, ë˜ëŠ” :28000ì´ í¬í•¨ëœ ì—°ê²° ë¬¸ìì—´ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

            // ìš”ì²­ ë³¸ë¬¸ ìƒì„± ì „ ìµœì¢… í™•ì¸
            if (!trimmedConnStr || trimmedConnStr === '' || trimmedConnStr.length < 20) {
                console.error('âŒ ì—°ê²° ë¬¸ìì—´ì´ ì—†ê±°ë‚˜ ë„ˆë¬´ ì§§ìŠµë‹ˆë‹¤:', {
                    exists: !!trimmedConnStr,
                    length: trimmedConnStr ? trimmedConnStr.length : 0,
                    value: trimmedConnStr ? trimmedConnStr.substring(0, 50) : 'ì—†ìŒ'
                });
                showError(resultBox, 'ì—°ê²° ë¬¸ìì—´ì´ ì—†ê±°ë‚˜ ë„ˆë¬´ ì§§ìŠµë‹ˆë‹¤.', 
                    'ì—°ê²° ë¬¸ìì—´ì„ í™•ì¸í•˜ì„¸ìš”.\n' +
                    'ê¸¸ì´: ' + (trimmedConnStr ? trimmedConnStr.length : 0) + 'ì\n' +
                    'ê°’: ' + (trimmedConnStr ? trimmedConnStr.substring(0, 50) : 'ì—†ìŒ'));
                return;
            }

            // ì—°ê²° ë¬¸ìì—´ ì¶œë ¥ ë° í™•ì¸
            console.log('='.repeat(60));
            console.log('ğŸ” ì‹œë‚˜ë¦¬ì˜¤ ì¿¼ë¦¬ ì‹¤í–‰ - ì—°ê²° ì •ë³´ í™•ì¸');
            console.log('='.repeat(60));
            console.log('ì—°ê²° ë¬¸ìì—´:', trimmedConnStr);
            console.log('ì—°ê²° ë¬¸ìì—´ ê¸¸ì´:', trimmedConnStr.length);
            console.log('ì—°ê²° ë¬¸ìì—´ ì‹œì‘:', trimmedConnStr.substring(0, 50));
            console.log('ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„:', trimmedDbName);
            console.log('ì¿¼ë¦¬ ID:', queryId);
            console.log('='.repeat(60));

            const requestBody = {
                connectionString: trimmedConnStr,
                dbName: trimmedDbName,
                collection: 'products',
                query: queries[queryId],
                queryType: 'aggregate'
            };

            // ìš”ì²­ ë³¸ë¬¸ ìµœì¢… ê²€ì¦ ë° ì¶œë ¥
            console.log('='.repeat(80));
            console.log('ğŸ“¤ í´ë¼ì´ì–¸íŠ¸: ì„œë²„ë¡œ ì „ì†¡í•  ìš”ì²­ ë³¸ë¬¸');
            console.log('='.repeat(80));
            console.log('ğŸ“¤ connectionString ì „ì²´:', requestBody.connectionString);
            console.log('ğŸ“¤ connectionString ì „ì²´ ê¸¸ì´:', requestBody.connectionString.length);
            console.log('ğŸ“¤ connectionString ì‹œì‘:', requestBody.connectionString.substring(0, 50));
            console.log('ğŸ“¤ connectionString ë:', requestBody.connectionString.substring(Math.max(0, requestBody.connectionString.length - 50)));
            console.log('ğŸ“¤ localhost í¬í•¨ ì—¬ë¶€:', requestBody.connectionString.includes('localhost') || requestBody.connectionString.includes('127.0.0.1') || requestBody.connectionString.includes(':28000'));
            console.log('ğŸ“¤ dbName:', requestBody.dbName);
            console.log('ğŸ“¤ collection:', requestBody.collection);
            console.log('ğŸ“¤ queryType:', requestBody.queryType);
            console.log('ğŸ“¤ JSON ì§ë ¬í™”ëœ ì „ì²´ ìš”ì²­ ë³¸ë¬¸:', JSON.stringify(requestBody));
            console.log('='.repeat(80));

                const response = await fetch('/api/execute-query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestBody)
                });

                console.log('ğŸ“¥ ì„œë²„ ì‘ë‹µ ìƒíƒœ:', response.status);
                const data = await response.json();
                console.log('ğŸ“¥ ì„œë²„ ì‘ë‹µ ë°ì´í„°:', {
                    success: data.success,
                    error: data.error,
                    hint: data.hint,
                    executionTime: data.executionTime,
                    resultCount: data.resultCount
                });
                console.log('='.repeat(60));
                
                if (data.success) {
                    showSuccess(resultBox, data.result, data.executionTime, data.resultCount);
                } else {
                    showError(resultBox, data.error, data.hint);
                }
            } catch (error) {
                console.error('âŒ ìš”ì²­ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                console.log('='.repeat(60));
                showError(resultBox, 'ì„œë²„ì™€ í†µì‹ í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        async function executeGetIndexes(collection) {
            // localStorageì—ì„œ ë¨¼ì € ì½ê¸°
            let connectionString = localStorage.getItem('atlasDemoConnectionString');
            let dbName = localStorage.getItem('atlasDemoDbName');
            
            // ì—†ìœ¼ë©´ ì…ë ¥ í•„ë“œì—ì„œ ì½ê¸°
            const connectionStringInput = document.getElementById('connectionString');
            const dbNameInput = document.getElementById('dbName');
            
            if (!connectionString && connectionStringInput) {
                connectionString = connectionStringInput.value.trim();
            }
            if (!dbName && dbNameInput) {
                dbName = dbNameInput.value.trim();
            }
            
            connectionString = connectionString ? connectionString.trim() : '';
            dbName = dbName ? dbName.trim() : '';
            
            // í˜¸ì¶œí•œ ë²„íŠ¼ í™•ì¸
            const event = window.event || arguments[0];
            const isCheckButton = event && event.target && event.target.textContent && event.target.textContent.includes('ì¸ë±ìŠ¤ ìƒì„± í™•ì¸');
            const resultBox = document.getElementById(isCheckButton ? `result-indexes-${collection}-check` : `result-indexes-${collection}`);
            
            if (!connectionString || !dbName) {
                showError(resultBox, 'ì—°ê²° ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.', 'ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— MongoDB Atlas ì—°ê²° ë¬¸ìì—´ê³¼ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì—°ê²° ë¬¸ìì—´ í˜•ì‹ ê²€ì¦
            if (!connectionString.startsWith('mongodb://') && !connectionString.startsWith('mongodb+srv://')) {
                showError(resultBox, 'ì˜¬ë°”ë¥¸ ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.', 'ì—°ê²° ë¬¸ìì—´ì€ mongodb:// ë˜ëŠ” mongodb+srv://ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            resultBox.classList.remove('show', 'success', 'error');
            resultBox.classList.add('show');
            resultBox.innerHTML = '<div class="result-header">ì‹¤í–‰ ì¤‘...</div><div class="loading"></div>';

            try {
                const response = await fetch('/api/execute-query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        connectionString,
                        dbName,
                        collection: collection,
                        query: null,
                        queryType: 'getSearchIndexes'
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    // Index ëª©ë¡ì´ ë¹„ì–´ìˆìœ¼ë©´ ì•ˆë‚´ ë©”ì‹œì§€ ì¶”ê°€
                    if (Array.isArray(data.result) && data.result.length === 0) {
                        showSuccess(resultBox, data.result, data.executionTime, data.resultCount);
                        // ê²°ê³¼ ë°•ìŠ¤ì— ì¶”ê°€ ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ
                        setTimeout(() => {
                            const resultBoxContent = resultBox.innerHTML;
                            resultBox.innerHTML = resultBoxContent + 
                                '<div style="margin-top: 12px; padding: 12px; background: rgba(255, 193, 7, 0.1); border-left: 3px solid #FFC107; border-radius: 4px;">' +
                                '<p style="color: #FFC107; margin: 0; font-size: 14px;"><strong>âš ï¸ Search Indexê°€ ì—†ìŠµë‹ˆë‹¤.</strong></p>' +
                                '<p style="color: #B8C5D1; margin: 8px 0 0 0; font-size: 13px;">ì•„ë˜ "í•´ê²° ë°©ë²• 2"ì—ì„œ Index ìƒì„± ë°©ë²•ì„ í™•ì¸í•˜ì„¸ìš”.</p>' +
                                '</div>';
                        }, 100);
                    } else {
                        showSuccess(resultBox, data.result, data.executionTime, data.resultCount);
                    }
                } else {
                    // ì—ëŸ¬ê°€ ë°œìƒí•´ë„ Indexê°€ ì—†ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ
                    if (data.error && data.error.includes('getSearchIndexes')) {
                        showError(resultBox, 'Index ëª©ë¡ì„ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 
                            'MongoDB ë“œë¼ì´ë²„ ë²„ì „ ë¬¸ì œë¡œ Index ëª©ë¡ì„ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\n' +
                            'ëŒ€ì‹  MongoDB Atlas UIì—ì„œ ì§ì ‘ í™•ì¸í•˜ì„¸ìš”:\n' +
                            '1. Atlas ì½˜ì†” â†’ Search â†’ Indexes\n' +
                            '2. Indexê°€ ì—†ìœ¼ë©´ "í•´ê²° ë°©ë²• 2"ì—ì„œ Index ìƒì„± ë°©ë²•ì„ í™•ì¸í•˜ì„¸ìš”.');
                    } else {
                        showError(resultBox, data.error, data.hint);
                    }
                }
            } catch (error) {
                console.error('âŒ ìš”ì²­ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                console.log('='.repeat(60));
                showError(resultBox, 'ì„œë²„ì™€ í†µì‹ í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        async function executeFind(collection, query) {
            // localStorageì—ì„œ ë¨¼ì € ì½ê¸°
            let connectionString = localStorage.getItem('atlasDemoConnectionString');
            let dbName = localStorage.getItem('atlasDemoDbName');
            
            console.log('1. [executeFind] localStorageì—ì„œ ì½ì€ ê°’:', {
                connectionString: connectionString ? connectionString.substring(0, 30) + '...' : 'ì—†ìŒ',
                connectionStringLength: connectionString ? connectionString.length : 0,
                dbName: dbName || 'ì—†ìŒ'
            });
            
            // ì—†ìœ¼ë©´ ì…ë ¥ í•„ë“œì—ì„œ ì½ê¸°
            const connectionStringInput = document.getElementById('connectionString');
            const dbNameInput = document.getElementById('dbName');
            
            if (!connectionString && connectionStringInput) {
                connectionString = connectionStringInput.value.trim();
                console.log('2. [executeFind] ì…ë ¥ í•„ë“œì—ì„œ ì½ì€ ê°’:', {
                    connectionString: connectionString ? connectionString.substring(0, 30) + '...' : 'ì—†ìŒ',
                    connectionStringLength: connectionString ? connectionString.length : 0
                });
            }
            if (!dbName && dbNameInput) {
                dbName = dbNameInput.value.trim();
            }
            
            // ìµœì¢…ì ìœ¼ë¡œ ì‚¬ìš©í•  ì—°ê²° ì •ë³´
            connectionString = connectionString ? connectionString.trim() : '';
            dbName = dbName ? dbName.trim() : '';
            
            const resultBox = document.getElementById(`result-scenario5-1`);
            
            console.log('3. [executeFind] ìµœì¢… ì‚¬ìš©í•  ì—°ê²° ì •ë³´:', { 
                connectionStringExists: !!connectionString,
                connectionStringLength: connectionString.length,
                connectionStringPreview: connectionString ? connectionString.substring(0, 50) + '...' : 'ë¹„ì–´ìˆìŒ',
                connectionStringStartsWith: connectionString ? (connectionString.startsWith('mongodb://') || connectionString.startsWith('mongodb+srv://')) : false,
                dbName: dbName || 'ë¹„ì–´ìˆìŒ',
                collection: collection
            });
            
            // ì—°ê²° ë¬¸ìì—´ ê²€ì¦
            if (!connectionString || connectionString === '') {
                const errorMsg = 'ì—°ê²° ë¬¸ìì—´ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.';
                const hintMsg = 'ì—°ê²° ë¬¸ìì—´ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\n' +
                    'í•´ê²° ë°©ë²•:\n' +
                    '1. ë©”ì¸ í˜ì´ì§€(/)ë¡œ ì´ë™í•˜ì—¬ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë¡œë”©í•˜ì„¸ìš”.\n' +
                    '2. ë˜ëŠ” ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— MongoDB Atlas ì—°ê²° ë¬¸ìì—´ì„ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”.\n\n' +
                    'localStorage ê°’: ' + (localStorage.getItem('atlasDemoConnectionString') ? 'ìˆìŒ' : 'ì—†ìŒ') + '\n' +
                    'ì…ë ¥ í•„ë“œ ê°’: ' + (connectionStringInput && connectionStringInput.value ? 'ìˆìŒ' : 'ì—†ìŒ');
                console.error('âŒ [executeFind]', errorMsg, { 
                    localStorageValue: localStorage.getItem('atlasDemoConnectionString') ? 'ìˆìŒ' : 'ì—†ìŒ',
                    inputFieldValue: connectionStringInput ? connectionStringInput.value : 'í•„ë“œ ì—†ìŒ'
                });
                showError(resultBox, errorMsg, hintMsg);
                return;
            }

            if (!dbName || dbName === '') {
                showError(resultBox, 'ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.', 'ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì—°ê²° ë¬¸ìì—´ í˜•ì‹ ê²€ì¦
            if (!connectionString.startsWith('mongodb://') && !connectionString.startsWith('mongodb+srv://')) {
                const errorMsg = 'ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                const hintMsg = 'ì—°ê²° ë¬¸ìì—´ì€ mongodb:// ë˜ëŠ” mongodb+srv://ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.\n\n' +
                    'í˜„ì¬ ê°’ì˜ ì‹œì‘ ë¶€ë¶„: "' + connectionString.substring(0, 50) + '"\n' +
                    'ì „ì²´ ê¸¸ì´: ' + connectionString.length + 'ì';
                console.error('[executeFind]', errorMsg, { connectionString: connectionString.substring(0, 100) });
                showError(resultBox, errorMsg, hintMsg);
                return;
            }

            if (connectionString.includes('localhost') || connectionString.includes('127.0.0.1') || connectionString.includes(':28000')) {
                const errorMsg = 'ì—°ê²° ë¬¸ìì—´ì— localhostê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.';
                const hintMsg = 'MongoDB Atlas ì—°ê²° ë¬¸ìì—´ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.\n\n' +
                    'localhost, 127.0.0.1, ë˜ëŠ” :28000ì´ í¬í•¨ëœ ì—°ê²° ë¬¸ìì—´ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n' +
                    'í˜„ì¬ ì—°ê²° ë¬¸ìì—´: ' + connectionString.substring(0, 100);
                console.error('[executeFind]', errorMsg, { connectionString: connectionString.substring(0, 100) });
                showError(resultBox, errorMsg, hintMsg);
                return;
            }

            resultBox.classList.remove('show', 'success', 'error');
            resultBox.classList.add('show');
            resultBox.innerHTML = `
                <div class="result-header">ì‹¤í–‰ ì¤‘...</div>
                <div style="margin-top: 12px; padding: 12px; background: rgba(0, 0, 0, 0.3); border-radius: 4px; font-size: 12px; font-family: monospace;">
                    <div style="color: #B8C5D1; margin-bottom: 4px;">ì—°ê²° ë¬¸ìì—´:</div>
                    <div style="color: #00ED64; word-break: break-all;">${connectionString.substring(0, 80)}...</div>
                    <div style="color: #B8C5D1; margin-top: 8px;">ë°ì´í„°ë² ì´ìŠ¤: ${dbName}</div>
                </div>
                <div class="loading"></div>
            `;

            try {
                // ì—°ê²° ë¬¸ìì—´ ìµœì¢… í™•ì¸
                const trimmedConnStr = connectionString.trim();
                const trimmedDbName = dbName.trim();

                console.log('='.repeat(60));
                console.log('ğŸ” [executeFind] ì¿¼ë¦¬ ì‹¤í–‰ - ì—°ê²° ì •ë³´ í™•ì¸');
                console.log('='.repeat(60));
                console.log('ì—°ê²° ë¬¸ìì—´:', trimmedConnStr);
                console.log('ì—°ê²° ë¬¸ìì—´ ê¸¸ì´:', trimmedConnStr.length);
                console.log('ì—°ê²° ë¬¸ìì—´ ì‹œì‘:', trimmedConnStr.substring(0, 50));
                console.log('ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„:', trimmedDbName);
                console.log('ì»¬ë ‰ì…˜:', collection);
                console.log('ì¿¼ë¦¬:', JSON.stringify(query, null, 2));
                console.log('='.repeat(60));

                const requestBody = {
                    connectionString: trimmedConnStr,
                    dbName: trimmedDbName,
                    collection: collection,
                    query: query,
                    queryType: 'find'
                };

                console.log('ğŸ“¤ [executeFind] ì„œë²„ë¡œ ì „ì†¡í•  ìš”ì²­ ë³¸ë¬¸:');
                console.log('  - connectionString:', requestBody.connectionString.substring(0, 50) + '...');
                console.log('  - connectionString ì „ì²´ ê¸¸ì´:', requestBody.connectionString.length);
                console.log('  - dbName:', requestBody.dbName);
                console.log('  - collection:', requestBody.collection);
                console.log('  - queryType:', requestBody.queryType);
                console.log('  - query:', JSON.stringify(requestBody.query, null, 2));

                const response = await fetch('/api/execute-query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestBody)
                });

                console.log('ğŸ“¥ [executeFind] ì„œë²„ ì‘ë‹µ ìƒíƒœ:', response.status);
                console.log('ğŸ“¥ [executeFind] ì„œë²„ ì‘ë‹µ í—¤ë”:', Object.fromEntries(response.headers.entries()));

                const data = await response.json();
                
                console.log('ğŸ“¥ [executeFind] ì„œë²„ ì‘ë‹µ ë°ì´í„°:', {
                    success: data.success,
                    resultCount: data.resultCount,
                    executionTime: data.executionTime,
                    error: data.error || 'ì—†ìŒ',
                    hint: data.hint || 'ì—†ìŒ'
                });
                console.log('='.repeat(60));
                
                if (data.success) {
                    showSuccess(resultBox, data.result, data.executionTime, data.resultCount);
                } else {
                    showError(resultBox, data.error, data.hint);
                }
            } catch (error) {
                console.error('âŒ [executeFind] ìš”ì²­ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                console.log('='.repeat(60));
                showError(resultBox, 'ì„œë²„ì™€ í†µì‹ í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        function showSuccess(resultBox, result, executionTime, resultCount) {
            resultBox.classList.remove('error');
            resultBox.classList.add('success', 'show');
            resultBox.innerHTML = `
                <div class="result-header">ì‹¤í–‰ ì„±ê³µ (${executionTime}ms, ê²°ê³¼: ${resultCount}ê°œ)</div>
                <pre>${JSON.stringify(result, null, 2)}</pre>
            `;
        }

        function showError(resultBox, error, hint) {
            resultBox.classList.remove('success');
            resultBox.classList.add('error', 'show');
            resultBox.innerHTML = `
                <div class="result-header">ì˜¤ë¥˜ ë°œìƒ</div>
                <p style="color: #FF5252; margin: 8px 0;">${error}</p>
                ${hint ? `<p style="color: #B8C5D1; font-size: 13px; margin-top: 8px;">${hint}</p>` : ''}
            `;
        }

        async function checkIndexStatus(collection, indexName) {
            // localStorageì—ì„œ ë¨¼ì € ì½ê¸°
            let connectionString = localStorage.getItem('atlasDemoConnectionString');
            let dbName = localStorage.getItem('atlasDemoDbName');
            
            // ì—†ìœ¼ë©´ ì…ë ¥ í•„ë“œì—ì„œ ì½ê¸°
            const connectionStringInput = document.getElementById('connectionString');
            const dbNameInput = document.getElementById('dbName');
            
            if (!connectionString && connectionStringInput) {
                connectionString = connectionStringInput.value.trim();
            }
            if (!dbName && dbNameInput) {
                dbName = dbNameInput.value.trim();
            }
            
            connectionString = connectionString ? connectionString.trim() : '';
            dbName = dbName ? dbName.trim() : '';
            
            const resultBox = document.getElementById(`result-indexes-${collection}-check`);
            
            if (!connectionString || !dbName) {
                showError(resultBox, 'ì—°ê²° ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.', 'ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— MongoDB Atlas ì—°ê²° ë¬¸ìì—´ê³¼ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì—°ê²° ë¬¸ìì—´ í˜•ì‹ ê²€ì¦
            if (!connectionString.startsWith('mongodb://') && !connectionString.startsWith('mongodb+srv://')) {
                showError(resultBox, 'ì˜¬ë°”ë¥¸ ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.', 'ì—°ê²° ë¬¸ìì—´ì€ mongodb:// ë˜ëŠ” mongodb+srv://ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            if (connectionString.includes('localhost') || connectionString.includes('127.0.0.1') || connectionString.includes(':28000')) {
                showError(resultBox, 'ì—°ê²° ë¬¸ìì—´ì— localhostê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.', 'MongoDB Atlas ì—°ê²° ë¬¸ìì—´ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            resultBox.classList.remove('show', 'success', 'error');
            resultBox.classList.add('show');
            resultBox.innerHTML = '<div class="result-header">ì¸ë±ìŠ¤ ìƒíƒœ í™•ì¸ ì¤‘...</div><div class="loading"></div>';

            try {
                const response = await fetch('/api/execute-query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        connectionString,
                        dbName,
                        collection: collection,
                        query: null,
                        queryType: 'getSearchIndexes'
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    const indexList = Array.isArray(data.result) ? data.result : [];
                    
                    if (indexList.length === 0) {
                        // Indexê°€ ì—†ê±°ë‚˜ ì¡°íšŒì— ì‹¤íŒ¨í•œ ê²½ìš°
                        resultBox.classList.remove('success');
                        resultBox.classList.add('error', 'show');
                        resultBox.innerHTML = `
                            <div class="result-header">ì¸ë±ìŠ¤ ìƒíƒœ í™•ì¸ ì™„ë£Œ</div>
                            <p style="color: #FF5252; margin: 8px 0; font-size: 16px; font-weight: bold;">âŒ Indexê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                            <p style="color: #B8C5D1; margin: 8px 0; font-size: 14px;">ì•„ë˜ "í•´ê²° ë°©ë²• 2"ì—ì„œ Index ìƒì„± ë°©ë²•ì„ í™•ì¸í•˜ì„¸ìš”.</p>
                            <p style="color: #7A8B99; margin: 8px 0; font-size: 12px;">ì°¸ê³ : Indexê°€ ìƒì„± ì¤‘ì´ë©´ Atlas UIì—ì„œ í™•ì¸í•˜ì„¸ìš”. Index ìƒì„±ì€ ëª‡ ë¶„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                        `;
                    } else {
                        // Index ëª©ë¡ ì „ì²´ í‘œì‹œ
                        let indexListHTML = '<div style="margin-top: 12px;">';
                        let targetIndexFound = false;
                        
                        indexList.forEach((idx, index) => {
                            // ì¸ë±ìŠ¤ ìƒíƒœ í™•ì¸ (ì—¬ëŸ¬ í•„ë“œ í™•ì¸)
                            let status = 'ì•Œ ìˆ˜ ì—†ìŒ';
                            if (idx.status) {
                                status = idx.status; // READY, BUILDING, FAILED, PENDING ë“±
                            } else if (idx.queryable === true) {
                                status = 'READY';
                            } else if (idx.queryable === false) {
                                status = 'BUILDING';
                            } else if (idx.latestDefinition) {
                                // latestDefinitionì´ ìˆìœ¼ë©´ ìƒì„± ì¤‘ì¼ ìˆ˜ ìˆìŒ
                                status = 'BUILDING';
                            }
                            
                            const statusColor = status === 'READY' ? '#00ED64' : 
                                                status === 'BUILDING' || status === 'PENDING' ? '#FFC107' : 
                                                status === 'FAILED' ? '#FF5252' : '#B8C5D1';
                            const statusIcon = status === 'READY' ? 'âœ…' : 
                                              status === 'BUILDING' || status === 'PENDING' ? 'â³' : 
                                              status === 'FAILED' ? 'âŒ' : 'â“';
                            
                            if (idx.name === indexName) {
                                targetIndexFound = true;
                            }
                            
                            indexListHTML += `
                                <div style="margin-bottom: 16px; padding: 12px; background: rgba(0, 0, 0, 0.2); border-radius: 4px; border-left: 3px solid ${statusColor};">
                                    <p style="color: ${statusColor}; margin: 0 0 8px 0; font-size: 15px; font-weight: bold;">
                                        ${statusIcon} <strong>${idx.name || 'ì´ë¦„ ì—†ìŒ'}</strong> - ìƒíƒœ: <strong>${status}</strong>
                                    </p>
                                    ${status === 'READY' ? 
                                        '<p style="color: #00ED64; margin: 4px 0; font-size: 13px;">âœ… Indexê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤. ê²€ìƒ‰ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>' :
                                        status === 'BUILDING' || status === 'PENDING' ?
                                        '<p style="color: #FFC107; margin: 4px 0; font-size: 13px;">â³ Indexê°€ ìƒì„± ì¤‘ì…ë‹ˆë‹¤. ëª‡ ë¶„ í›„ ë‹¤ì‹œ í™•ì¸í•˜ì„¸ìš”. (ì´ë¦„: ' + (idx.name || 'ì•Œ ìˆ˜ ì—†ìŒ') + ', ìƒíƒœ: ' + status + ')</p>' :
                                        status === 'FAILED' ?
                                        '<p style="color: #FF5252; margin: 4px 0; font-size: 13px;">âŒ Index ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. Atlas UIì—ì„œ í™•ì¸í•˜ì„¸ìš”.</p>' :
                                        '<p style="color: #B8C5D1; margin: 4px 0; font-size: 13px;">â“ Index ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ì´ë¦„: ' + (idx.name || 'ì•Œ ìˆ˜ ì—†ìŒ') + ')</p>'
                                    }
                                    <details style="margin-top: 8px;">
                                        <summary style="color: #B8C5D1; font-size: 12px; cursor: pointer;">ìƒì„¸ ì •ë³´ ë³´ê¸°</summary>
                                        <pre style="margin-top: 8px; padding: 8px; background: rgba(0, 0, 0, 0.3); border-radius: 4px; font-size: 11px; overflow-x: auto;">${JSON.stringify(idx, null, 2)}</pre>
                                    </details>
                                </div>
                            `;
                        });
                        
                        indexListHTML += '</div>';
                        
                        resultBox.classList.remove('error');
                        resultBox.classList.add('success', 'show');
                        resultBox.innerHTML = `
                            <div class="result-header">ì¸ë±ìŠ¤ ëª©ë¡ ë° ìƒíƒœ í™•ì¸ ì™„ë£Œ</div>
                            <p style="color: #B8C5D1; margin: 8px 0; font-size: 14px;">ì´ <strong>${indexList.length}</strong>ê°œì˜ Indexê°€ ìˆìŠµë‹ˆë‹¤.</p>
                            ${targetIndexFound ? 
                                `<p style="color: #00ED64; margin: 8px 0; font-size: 14px;">âœ… ì°¾ê³  ìˆëŠ” Index '${indexName}'ê°€ ëª©ë¡ì— ìˆìŠµë‹ˆë‹¤.</p>` :
                                indexName ? 
                                `<p style="color: #FFC107; margin: 8px 0; font-size: 14px;">âš ï¸ ì°¾ê³  ìˆëŠ” Index '${indexName}'ê°€ ëª©ë¡ì— ì—†ìŠµë‹ˆë‹¤. Index ì´ë¦„ì„ í™•ì¸í•˜ì„¸ìš”.</p>` :
                                ''
                            }
                            ${indexListHTML}
                        `;
                    }
                } else {
                    // ì—ëŸ¬ê°€ ë°œìƒí•œ ê²½ìš°
                    let errorMessage = data.error || 'Index ëª©ë¡ì„ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                    let errorHint = data.hint || '';
                    
                    if (data.error && (data.error.includes('getSearchIndexes') || data.error.includes('Search Index'))) {
                        errorHint = 'MongoDB ë“œë¼ì´ë²„ë¥¼ í†µí•œ Index ëª©ë¡ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\n' +
                            'ê°€ëŠ¥í•œ ì›ì¸:\n' +
                            '1. Indexê°€ ì•„ì§ ìƒì„±ë˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n' +
                            '2. Indexê°€ ìƒì„± ì¤‘(BUILDING)ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n' +
                            '3. MongoDB ë“œë¼ì´ë²„ ë²„ì „ ë¬¸ì œì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n' +
                            'í•´ê²° ë°©ë²•:\n' +
                            '1. MongoDB Atlas UIì—ì„œ ì§ì ‘ í™•ì¸í•˜ì„¸ìš”:\n' +
                            '   - Atlas ì½˜ì†” â†’ Search â†’ Indexes\n' +
                            '   - Index ì´ë¦„ê³¼ ìƒíƒœë¥¼ í™•ì¸í•˜ì„¸ìš”\n' +
                            '2. Indexê°€ BUILDING ìƒíƒœë©´ ëª‡ ë¶„ í›„ ë‹¤ì‹œ í™•ì¸í•˜ì„¸ìš”.\n' +
                            '3. Indexê°€ ì—†ìœ¼ë©´ "í•´ê²° ë°©ë²• 2"ì—ì„œ Index ìƒì„± ë°©ë²•ì„ í™•ì¸í•˜ì„¸ìš”.';
                    }
                    
                    resultBox.classList.remove('success');
                    resultBox.classList.add('error', 'show');
                    resultBox.innerHTML = `
                        <div class="result-header">ì¸ë±ìŠ¤ ìƒíƒœ í™•ì¸ ì™„ë£Œ</div>
                        <p style="color: #FF5252; margin: 8px 0; font-size: 16px; font-weight: bold;">âŒ ${errorMessage}</p>
                        <p style="color: #B8C5D1; margin: 8px 0; font-size: 14px; white-space: pre-line;">${errorHint}</p>
                        <p style="color: #7A8B99; margin: 8px 0; font-size: 12px; margin-top: 12px;">ğŸ’¡ íŒ: Indexê°€ ìƒì„± ì¤‘ì´ë©´ Atlas UIì—ì„œ ì´ë¦„ê³¼ ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    `;
                }
            } catch (error) {
                console.error('âŒ ì¸ë±ìŠ¤ ìƒíƒœ í™•ì¸ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                showError(resultBox, 'ì„œë²„ì™€ í†µì‹ í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }
    </script>
</body>
</html>
