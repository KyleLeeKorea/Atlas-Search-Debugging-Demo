<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atlas Search ë””ë²„ê¹… ì˜ˆì œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Euclid Circular A', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #001E2B;
            color: #FFFFFF;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .subtitle {
            color: #B8C5D1;
            margin-bottom: 40px;
            font-size: 16px;
        }

        .connection-form {
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid rgba(0, 237, 100, 0.2);
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 30px;
        }

        .connection-form input {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            color: #FFFFFF;
            font-size: 14px;
            margin: 8px 0;
        }

        .connection-form input:focus {
            outline: none;
            border-color: #00ED64;
        }

        .connection-form label {
            display: block;
            margin-top: 12px;
            font-size: 14px;
            color: #FFFFFF;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 24px;
            background: transparent;
            border: none;
            color: #B8C5D1;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }

        .tab:hover {
            color: #FFFFFF;
        }

        .tab.active {
            color: #00ED64;
            border-bottom-color: #00ED64;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .scenario {
            background: rgba(26, 26, 26, 0.8);
            border: 1px solid rgba(0, 237, 100, 0.2);
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .scenario h2 {
            font-size: 20px;
            margin-bottom: 16px;
            color: #00ED64;
        }

        .scenario h3 {
            font-size: 16px;
            margin-top: 20px;
            margin-bottom: 12px;
            color: #FFFFFF;
        }

        .problem-box {
            background: rgba(255, 82, 82, 0.1);
            border: 1px solid rgba(255, 82, 82, 0.3);
            border-radius: 6px;
            padding: 16px;
            margin: 16px 0;
        }

        .solution-box {
            background: rgba(0, 237, 100, 0.1);
            border: 1px solid rgba(0, 237, 100, 0.3);
            border-radius: 6px;
            padding: 16px;
            margin: 16px 0;
        }

        .code-block {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            padding: 16px;
            margin: 12px 0;
            overflow-x: auto;
            font-family: 'SF Mono', 'Monaco', 'Courier New', monospace;
            font-size: 13px;
            color: #B8C5D1;
            position: relative;
        }

        .code-block code {
            white-space: pre;
        }

        .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(0, 237, 100, 0.2);
            border: 1px solid rgba(0, 237, 100, 0.4);
            color: #00ED64;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            font-weight: 500;
            transition: all 0.2s;
            z-index: 10;
        }

        .copy-btn:hover {
            background: rgba(0, 237, 100, 0.3);
            border-color: #00ED64;
        }

        .copy-btn:active {
            transform: scale(0.95);
        }

        .copy-btn.copied {
            background: rgba(0, 237, 100, 0.4);
            color: #FFFFFF;
        }

        .execute-btn {
            background: #00ED64;
            color: #001E2B;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            margin-top: 12px;
            transition: all 0.2s;
        }

        .execute-btn:hover {
            background: #00D955;
            transform: translateY(-1px);
        }

        .execute-btn:disabled {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.3);
            cursor: not-allowed;
            transform: none;
        }

        .result-box {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            padding: 0;
            margin: 12px 0;
            display: none;
            overflow: hidden;
        }

        .result-box.show {
            display: block;
        }

        .result-box.collapsed .result-content {
            display: none;
        }

        .result-header {
            padding: 16px;
            cursor: pointer;
            user-select: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .result-header:hover {
            background: rgba(0, 0, 0, 0.3);
        }

        .result-header .toggle-icon {
            font-size: 12px;
            color: #B8C5D1;
            transition: transform 0.3s;
        }

        .result-box.collapsed .result-header .toggle-icon {
            transform: rotate(-90deg);
        }

        .result-content {
            padding: 16px;
        }

        .result-box.success {
            border-color: rgba(0, 237, 100, 0.3);
        }

        .result-box.error {
            border-color: rgba(255, 82, 82, 0.3);
        }

        .result-box pre {
            color: #B8C5D1;
            font-family: 'SF Mono', 'Monaco', 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
            margin: 8px 0;
        }

        .result-box .result-header {
            color: #00ED64;
            font-weight: 600;
            margin-bottom: 0;
        }

        .result-box.error .result-header {
            color: #FF5252;
        }

        .checklist {
            list-style: none;
            padding-left: 0;
        }

        .checklist li {
            padding: 8px 0;
            padding-left: 24px;
            position: relative;
        }

        .checklist li:before {
            content: "â–¡";
            position: absolute;
            left: 0;
            color: #00ED64;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #00ED64;
            text-decoration: none;
            font-size: 14px;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        p {
            margin: 12px 0;
            color: #B8C5D1;
        }

        strong {
            color: #FFFFFF;
        }

        .loading {
            display: inline-block;
            width: 14px;
            height: 14px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-top-color: #00ED64;
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
            margin-left: 8px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .footer-link {
            position: fixed;
            top: 12px;
            right: 12px;
            font-size: 10px;
            color: rgba(255, 255, 255, 0.4);
            text-decoration: none;
            z-index: 1000;
            transition: color 0.2s ease;
        }

        .footer-link:hover {
            color: rgba(255, 255, 255, 0.6);
        }

        @media (max-width: 768px) {
            .footer-link {
                font-size: 9px;
                top: 8px;
                right: 8px;
            }
        }
    </style>
</head>
<body>
    <a href="https://github.com/KyleLeeKorea/Atlas-Search-Debugging-Demo" target="_blank" class="footer-link">
        https://github.com/KyleLeeKorea/Atlas-Search-Debugging-Demo , Created by Kyle Lee, 20251218
    </a>
    <div class="container">
        <a href="/" class="back-link">â† ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
        
        <h1>Atlas Search ë””ë²„ê¹… ì˜ˆì œ</h1>
        <p class="subtitle">ê°€ì¥ í”í•œ ë””ë²„ê¹… ì‹œë‚˜ë¦¬ì˜¤ Top 5ì™€ ì‹¤ì „ ì˜ˆì œ</p>

        <div class="connection-form">
            <h3 style="color: #00ED64; margin-bottom: 16px;">ì—°ê²° ì •ë³´</h3>
            <label>MongoDB Atlas ì—°ê²° ë¬¸ìì—´</label>
            <textarea id="connectionString" rows="2" placeholder="mongodb+srv://username:password@cluster.mongodb.net/" style="width: 100%; padding: 12px; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 6px; color: #FFFFFF; font-size: 14px; font-family: 'SF Mono', 'Monaco', 'Courier New', monospace; resize: vertical;"></textarea>
            <label>ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„</label>
            <input type="text" id="dbName" placeholder="atlas_search_demo" />
            <p style="margin-top: 12px; font-size: 13px; color: #7A8B99;">
                ë©”ì¸ í˜ì´ì§€ì—ì„œ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë¡œë”©í•œ ê²½ìš°, ì—°ê²° ì •ë³´ê°€ ìë™ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤.
            </p>
            <div id="connectionStatus" style="margin-top: 12px; padding: 12px; border-radius: 6px; display: none;"></div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab(0)">ì‹œë‚˜ë¦¬ì˜¤ 1: ê²€ìƒ‰ ê²°ê³¼ 0ê±´</button>
            <button class="tab" onclick="showTab(1)">ì‹œë‚˜ë¦¬ì˜¤ 2: ê¸°ëŒ€ì™€ ë‹¤ë¥¸ ê²°ê³¼</button>
            <button class="tab" onclick="showTab(2)">ì‹œë‚˜ë¦¬ì˜¤ 3: ì„±ëŠ¥ ë¬¸ì œ</button>
            <button class="tab" onclick="showTab(3)">ì‹œë‚˜ë¦¬ì˜¤ 4: Index ë³€ê²½</button>
            <button class="tab" onclick="showTab(4)">ì‹œë‚˜ë¦¬ì˜¤ 5: ìš´ì˜ í™˜ê²½</button>
            <button class="tab" onclick="showTab(5)">ì²´í¬ë¦¬ìŠ¤íŠ¸</button>
        </div>

        <!-- ì‹œë‚˜ë¦¬ì˜¤ 1: ê²€ìƒ‰ ê²°ê³¼ê°€ 0ê±´ ë‚˜ì˜¤ëŠ” ê²½ìš° -->
        <div class="tab-content active">
            <div class="scenario">
                <h2>ì‹œë‚˜ë¦¬ì˜¤ 1: ê²€ìƒ‰ ê²°ê³¼ê°€ 0ê±´ ë‚˜ì˜¤ëŠ” ê²½ìš°</h2>
                
                <h3>ë¬¸ì œ 1: Indexê°€ ì—†ëŠ” ê²½ìš°</h3>
                <div class="problem-box">
                    <p><strong>ì¦ìƒ:</strong> Index 'productSearch' not found ì˜¤ë¥˜</p>
                    <div class="code-block">
                        <code>{
  $search: {
    index: "productSearch",
    text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
  }
}</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario1-1')">ì¿¼ë¦¬ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario1-1"></div>
                </div>
                <div class="solution-box">
                    <p><strong>í•´ê²° ë°©ë²• 1:</strong> Index ëª©ë¡ í™•ì¸</p>
                    <div class="code-block">
                        <code>// Index ëª©ë¡ í™•ì¸
db.products.getSearchIndexes()</code>
                    </div>
                    <button class="execute-btn" onclick="executeGetIndexes('products')">Index ëª©ë¡ ì¡°íšŒ</button>
                    <div class="result-box" id="result-indexes-products"></div>
                </div>
                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>í•´ê²° ë°©ë²• 2:</strong> Index ìƒì„± (Indexê°€ ì—†ëŠ” ê²½ìš°)</p>
                    <p style="color: #B8C5D1; font-size: 14px; margin: 12px 0;">MongoDB Atlas UIì—ì„œ Search Indexë¥¼ ìƒì„±í•˜ì„¸ìš”:</p>
                    <ol style="color: #B8C5D1; font-size: 14px; margin: 12px 0; padding-left: 20px;">
                        <li>MongoDB Atlas ì½˜ì†”ì— ë¡œê·¸ì¸</li>
                        <li>ì™¼ìª½ ë©”ë‰´ì—ì„œ <strong>Search</strong> í´ë¦­</li>
                        <li><strong>Create Search Index</strong> ë²„íŠ¼ í´ë¦­</li>
                        <li><strong>JSON Editor</strong> ì„ íƒ</li>
                        <li>ì•„ë˜ JSONì„ ë³µì‚¬í•˜ì—¬ ë¶™ì—¬ë„£ê¸°:</li>
                    </ol>
                    <div class="code-block">
                        <code>{
  "mappings": {
    "dynamic": false,
    "fields": {
      "name": {
        "type": "string",
        "analyzer": "lucene.korean"
      },
      "description": {
        "type": "string",
        "analyzer": "lucene.korean"
      },
      "category": {
        "type": "string",
        "analyzer": "lucene.keyword"
      },
      "price": {
        "type": "number"
      }
    }
  }
}</code>
                    </div>
                    <p style="color: #B8C5D1; font-size: 14px; margin: 12px 0;">
                        <strong>Index ì´ë¦„:</strong> <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">productSearch</code>
                    </p>
                    <p style="color: #B8C5D1; font-size: 14px; margin: 12px 0;">
                        <strong>Database:</strong> <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">Debug01</code> (ë˜ëŠ” ì‚¬ìš© ì¤‘ì¸ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„)
                    </p>
                    <p style="color: #B8C5D1; font-size: 14px; margin: 12px 0;">
                        <strong>Collection:</strong> <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">products</code>
                    </p>
                    <p style="color: #B8C5D1; font-size: 13px; margin-top: 12px; padding: 12px; background: rgba(0, 150, 255, 0.1); border-left: 3px solid #0096FF; border-radius: 4px;">
                        ğŸ’¡ <strong>ì°¸ê³ :</strong> Index ìƒì„± í›„ BUILDING ìƒíƒœì—ì„œ READY ìƒíƒœë¡œ ë³€ê²½ë˜ëŠ”ë° ëª‡ ë¶„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. READY ìƒíƒœê°€ ë˜ë©´ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                    <button class="execute-btn" onclick="checkIndexStatus('products', 'productSearch')" style="margin-top: 16px;">ì¸ë±ìŠ¤ ìƒì„± í™•ì¸</button>
                    <div class="result-box" id="result-indexes-products-check"></div>
                </div>

                <h3>ë¬¸ì œ 2: $searchMetaë¡œ ë§¤ì¹­ í™•ì¸</h3>
                <div class="solution-box">
                    <p><strong>ë””ë²„ê¹…:</strong> $searchMetaë¡œ ê²€ìƒ‰ ë§¤ì¹­ ì—¬ë¶€ í™•ì¸</p>
                    <div class="code-block">
                        <code>db.products.aggregate([
  {
    $searchMeta: {
      index: "productSearch",
      text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
    }
  }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario1-2')">$searchMeta ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario1-2"></div>
                </div>
            </div>
        </div>

        <!-- ì‹œë‚˜ë¦¬ì˜¤ 2: ê²°ê³¼ëŠ” ë‚˜ì˜¤ì§€ë§Œ ê¸°ëŒ€ì™€ ë‹¤ë¥¸ ê²½ìš° -->
        <div class="tab-content">
            <div class="scenario">
                <h2>ì‹œë‚˜ë¦¬ì˜¤ 2: ê²°ê³¼ëŠ” ë‚˜ì˜¤ì§€ë§Œ ê¸°ëŒ€ì™€ ë‹¤ë¥¸ ê²½ìš°</h2>
                
                <h3>ë¬¸ì œ 1: text vs autocomplete vs phrase ì°¨ì´</h3>
                <div class="problem-box">
                    <p><strong>ì°¨ì´ì :</strong></p>
                    <ul>
                        <li><strong>text:</strong> ê°¤ëŸ­ì‹œì™€ í”„ë¡œë¥¼ ê°ê° ê²€ìƒ‰ (OR ì¡°ê±´)</li>
                        <li><strong>autocomplete:</strong> ê°¤ëŸ­ì‹œë¡œ ì‹œì‘í•˜ëŠ” ë‹¨ì–´ ê²€ìƒ‰</li>
                        <li><strong>phrase:</strong> ê°¤ëŸ­ì‹œ í”„ë¡œë¥¼ ì •í™•í•œ êµ¬ë¬¸ìœ¼ë¡œ ê²€ìƒ‰</li>
                    </ul>
                </div>
                
                <div class="solution-box">
                    <p><strong>text ê²€ìƒ‰:</strong></p>
                    <div class="code-block">
                        <code>db.products.aggregate([
  {
    $search: {
      index: "productSearch",
      text: { query: "ê°¤ëŸ­ì‹œ í”„ë¡œ", path: "name" }
    }
  },
  { $limit: 5 }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario2-1-text')">text ê²€ìƒ‰ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario2-1-text"></div>
                </div>

                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>ë¬¸ì œ1-1: "ì™œ ìŠ¤ë§ˆíŠ¸í°ì´ ì´ì–´í°ë³´ë‹¤ ì•„ë˜ ë‚˜ì˜¤ì£ ?"</strong></p>
                    <p style="color: #B8C5D1; font-size: 13px; margin: 8px 0;">
                        ê²€ìƒ‰ ê²°ê³¼ì—ì„œ íŠ¹ì • ì¹´í…Œê³ ë¦¬(ì˜ˆ: ìŠ¤ë§ˆíŠ¸í°)ì˜ ìƒí’ˆì´ ë‹¤ë¥¸ ì¹´í…Œê³ ë¦¬(ì˜ˆ: ì´ì–´í°)ë³´ë‹¤ ë‚®ì€ ìˆœìœ„ë¡œ ë‚˜íƒ€ë‚˜ëŠ” ê²½ìš°, ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                </div>

                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>í•´ê²° ë°©ë²• 1-1a: Field Boost (í•„ë“œ ê°€ì¤‘ì¹˜ ê°•í™”)</strong></p>
                    <p style="color: #B8C5D1; font-size: 13px; margin: 8px 0;">
                        íŠ¹ì • í•„ë“œ(ì˜ˆ: name)ì— ë” ë†’ì€ ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•˜ê³ , ì¹´í…Œê³ ë¦¬ë³„ ê°€ì¤‘ì¹˜ë„ í•¨ê»˜ ì ìš©í•˜ì—¬ ì›í•˜ëŠ” ì¹´í…Œê³ ë¦¬ì˜ ìƒí’ˆì´ ìƒìœ„ë¡œ ì˜¬ë¼ì˜¤ë„ë¡ í•©ë‹ˆë‹¤.
                    </p>
                    <div class="code-block">
                        <code>db.products.aggregate([
  {
    $search: {
      index: "productSearch",
      compound: {
        must: [
          {
            text: {
              query: "ê°¤ëŸ­ì‹œ",
              path: "name"
            }
          }
        ],
        should: [
          {
            text: {
              query: "ê°¤ëŸ­ì‹œ",
              path: "name",
              score: { boost: { value: 2 } }
            }
          },
          {
            text: {
              query: "ìŠ¤ë§ˆíŠ¸í°",
              path: "category",
              score: { boost: { value: 5 } }
            }
          }
        ],
        minimumShouldMatch: 0
      }
    }
  },
  { $limit: 5 }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario2-1-text-boost')">Field Boost ê²€ìƒ‰ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario2-1-text-boost"></div>
                </div>

                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>í•´ê²° ë°©ë²• 1-1b: Compound + Should (ìƒí’ˆêµ° ê°€ì¤‘ì¹˜)</strong></p>
                    <p style="color: #B8C5D1; font-size: 13px; margin: 8px 0;">
                        compound ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ì¹´í…Œê³ ë¦¬(ì˜ˆ: "ìŠ¤ë§ˆíŠ¸í°")ì— ë§¤ì¹­ë˜ëŠ” ë¬¸ì„œì— ì¶”ê°€ ì ìˆ˜ë¥¼ ë¶€ì—¬í•©ë‹ˆë‹¤.
                    </p>
                    <div class="code-block">
                        <code>db.products.aggregate([
  {
    $search: {
      index: "productSearch",
      compound: {
        must: [
          {
            text: {
              query: "ê°¤ëŸ­ì‹œ",
              path: "name"
            }
          }
        ],
        should: [
          {
            text: {
              query: "ìŠ¤ë§ˆíŠ¸í°",
              path: "category"
            }
          }
        ],
        minimumShouldMatch: 0
      }
    }
  },
  { $limit: 5 }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario2-1-compound-should')">Compound + Should ê²€ìƒ‰ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario2-1-compound-should"></div>
                </div>

                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>autocomplete ê²€ìƒ‰:</strong></p>
                    <p style="color: #FFC107; font-size: 13px; margin: 8px 0; padding: 8px; background: rgba(255, 193, 7, 0.1); border-left: 3px solid #FFC107; border-radius: 4px;">
                        âš ï¸ <strong>ì¤‘ìš”:</strong> autocomplete ê²€ìƒ‰ì„ ì‚¬ìš©í•˜ë ¤ë©´ <strong>ë³„ë„ì˜ Search Index</strong>ë¥¼ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤. <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">productSearch</code> IndexëŠ” <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">string</code> íƒ€ì…ì´ë¯€ë¡œ autocomplete ê²€ìƒ‰ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.
                    </p>
                    <p style="color: #B8C5D1; font-size: 13px; margin: 12px 0;">
                        <strong>í•´ê²° ë°©ë²•:</strong> Atlas UIì—ì„œ ìƒˆë¡œìš´ Indexë¥¼ ìƒì„±í•˜ì„¸ìš”:
                    </p>
                    <ol style="color: #B8C5D1; font-size: 13px; margin: 8px 0; padding-left: 20px;">
                        <li>Atlas ì½˜ì†” â†’ Search â†’ Create Search Index</li>
                        <li><strong>Index ì´ë¦„:</strong> <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">productSearchAutocomplete</code> (ë‹¤ë¥¸ ì´ë¦„ ì‚¬ìš© ê°€ëŠ¥)</li>
                        <li>JSON Editor ì„ íƒ í›„ ì•„ë˜ JSON ì‚¬ìš©:</li>
                    </ol>
                    <div class="code-block" style="font-size: 11px;">
                        <code>{
  "mappings": {
    "dynamic": false,
    "fields": {
      "name": {
        "type": "autocomplete",
        "analyzer": "lucene.korean"
      },
      "description": {
        "type": "autocomplete",
        "analyzer": "lucene.korean"
      }
    }
  }
}</code>
                    </div>
                    <p style="color: #B8C5D1; font-size: 12px; margin: 8px 0;">
                        Index ìƒì„± í›„ ì•„ë˜ ì¿¼ë¦¬ì—ì„œ <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">index: "productSearchAutocomplete"</code>ë¡œ ë³€ê²½í•˜ì—¬ ì‹¤í–‰í•˜ì„¸ìš”.
                    </p>
                    <div class="code-block">
                        <code>db.products.aggregate([
  {
    $search: {
      index: "productSearchAutocomplete",
      autocomplete: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
    }
  },
  { $limit: 5 }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario2-1-autocomplete')">autocomplete ê²€ìƒ‰ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario2-1-autocomplete"></div>
                </div>

                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>phrase ê²€ìƒ‰:</strong></p>
                    <div class="code-block">
                        <code>db.products.aggregate([
  {
    $search: {
      index: "productSearch",
      phrase: { query: "ê°¤ëŸ­ì‹œ í”„ë¡œ", path: "name" }
    }
  },
  { $limit: 5 }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario2-1-phrase')">phrase ê²€ìƒ‰ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario2-1-phrase"></div>
                </div>

                <h3>ë¬¸ì œ 2: Score í™•ì¸</h3>
                <div class="solution-box">
                    <p><strong>ë””ë²„ê¹…:</strong> Score ê¸°ì¤€ ì •ë ¬ë¡œ ê´€ë ¨ë„ í™•ì¸</p>
                    <div class="code-block">
                        <code>db.products.aggregate([
  {
    $search: {
      index: "productSearch",
      text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
    }
  },
  {
    $addFields: {
      score: { $meta: "searchScore" }
    }
  },
  {
    $sort: { score: -1 }
  },
  { $limit: 5 }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario2-2')">Score í™•ì¸ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario2-2"></div>
                </div>
            </div>
        </div>

        <!-- ì‹œë‚˜ë¦¬ì˜¤ 3: ì„±ëŠ¥ì´ ëŠë¦° ê²½ìš° -->
        <div class="tab-content">
            <div class="scenario">
                <h2>ì‹œë‚˜ë¦¬ì˜¤ 3: Atlas ì„±ëŠ¥ ë¬¸ì œ ê°œì„  ì˜ˆì œ</h2>
                <p style="color: #B8C5D1; font-size: 14px; margin: 16px 0;">
                    Before â†’ Afterë¡œ ì´í•´í•˜ëŠ” ì‹¤ì „ ì¼€ì´ìŠ¤
                </p>

                <div class="solution-box" style="margin-bottom: 30px;">
                    <p><strong>âš ï¸ ì‚¬ì „ ì¤€ë¹„: bigProductSearch Index í™•ì¸ ë° ìƒì„±</strong></p>
                    <p style="color: #B8C5D1; font-size: 13px; margin: 8px 0;">
                        ì‹œë‚˜ë¦¬ì˜¤ 3ì€ <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">bigProducts</code> ì»¬ë ‰ì…˜ê³¼ <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">bigProductSearch</code> ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
                    </p>
                    <div class="solution-box" style="margin-top: 16px;">
                        <p><strong>1. Index ëª©ë¡ í™•ì¸</strong></p>
                        <div class="code-block">
                            <code>// Index ëª©ë¡ í™•ì¸
db.bigProducts.getSearchIndexes()</code>
                        </div>
                        <button class="execute-btn" onclick="executeGetIndexes('bigProducts')">Index ëª©ë¡ ì¡°íšŒ</button>
                        <div class="result-box" id="result-indexes-bigProducts"></div>
                    </div>
                    <div class="solution-box" style="margin-top: 20px;">
                        <p><strong>2. Index ìƒì„± (Indexê°€ ì—†ëŠ” ê²½ìš°)</strong></p>
                        <p style="color: #B8C5D1; font-size: 14px; margin: 12px 0;">MongoDB Atlas UIì—ì„œ Search Indexë¥¼ ìƒì„±í•˜ì„¸ìš”:</p>
                        <ol style="color: #B8C5D1; font-size: 14px; margin: 12px 0; padding-left: 20px;">
                            <li>MongoDB Atlas ì½˜ì†”ì— ë¡œê·¸ì¸</li>
                            <li>ì™¼ìª½ ë©”ë‰´ì—ì„œ <strong>Search</strong> í´ë¦­</li>
                            <li><strong>Create Search Index</strong> ë²„íŠ¼ í´ë¦­</li>
                            <li><strong>JSON Editor</strong> ì„ íƒ</li>
                            <li>ì•„ë˜ JSONì„ ë³µì‚¬í•˜ì—¬ ë¶™ì—¬ë„£ê¸°:</li>
                        </ol>
                        <div class="code-block">
                            <code>{
  "mappings": {
    "dynamic": false,
    "fields": {
      "name": {
        "type": "string",
        "analyzer": "lucene.korean"
      },
      "description": {
        "type": "string",
        "analyzer": "lucene.korean"
      },
      "category": {
        "type": "string",
        "analyzer": "lucene.keyword"
      },
      "price": {
        "type": "number"
      }
    }
  }
}</code>
                        </div>
                        <p style="color: #B8C5D1; font-size: 14px; margin: 12px 0;">
                            <strong>Index ì´ë¦„:</strong> <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">bigProductSearch</code>
                        </p>
                        <p style="color: #B8C5D1; font-size: 14px; margin: 12px 0;">
                            <strong>Database:</strong> ì‚¬ìš© ì¤‘ì¸ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„
                        </p>
                        <p style="color: #B8C5D1; font-size: 14px; margin: 12px 0;">
                            <strong>Collection:</strong> <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">bigProducts</code>
                        </p>
                        <p style="color: #B8C5D1; font-size: 13px; margin-top: 12px; padding: 12px; background: rgba(0, 150, 255, 0.1); border-left: 3px solid #0096FF; border-radius: 4px;">
                            ğŸ’¡ <strong>ì°¸ê³ :</strong> Index ìƒì„± í›„ BUILDING ìƒíƒœì—ì„œ READY ìƒíƒœë¡œ ë³€ê²½ë˜ëŠ”ë° ëª‡ ë¶„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. READY ìƒíƒœê°€ ë˜ë©´ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </p>
                        <button class="execute-btn" onclick="checkIndexStatus('bigProducts', 'bigProductSearch')" style="margin-top: 16px;">ì¸ë±ìŠ¤ ìƒì„± í™•ì¸</button>
                        <div class="result-box" id="result-indexes-bigProducts-check"></div>
                    </div>
                </div>

                <h3>ì˜ˆì œ 1: $searchëŠ” ë¹ ë¥¸ë° ì „ì²´ ì¿¼ë¦¬ëŠ” ëŠë¦° ê²½ìš°</h3>
                <div class="problem-box" style="margin-bottom: 20px;">
                    <p><strong>ë¬¸ì œ ìƒí™©:</strong></p>
                    <ul style="color: #B8C5D1; font-size: 13px; margin: 8px 0; padding-left: 20px;">
                        <li>Atlas Search ìì²´ëŠ” ë¹ ë¦„</li>
                        <li>ì „ì²´ aggregationì€ 2~3ì´ˆ ì´ìƒ ì†Œìš”</li>
                    </ul>
                    <p style="color: #FFC107; font-size: 13px; margin: 12px 0; padding: 8px; background: rgba(255, 193, 7, 0.1); border-left: 3px solid #FFC107; border-radius: 4px;">
                        <strong>ë¬¸ì œ ì›ì¸:</strong> $search ê²°ê³¼ ì „ì²´ë¥¼ ë©”ëª¨ë¦¬ë¡œ ê°€ì ¸ì˜´, limitì´ ë„ˆë¬´ ëŠ¦ê²Œ ì ìš©, ë¶ˆí•„ìš”í•œ í•„ë“œê¹Œì§€ ì „ë¶€ ë¡œë”©
                    </p>
                </div>

                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>âŒ Before (ë¬¸ì œ ìˆëŠ” ì¿¼ë¦¬)</strong></p>
                    <div class="code-block">
                        <code>db.bigProducts.aggregate([
  {
    $search: {
      index: "bigProductSearch",
      text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
    }
  },
  {
    $project: {
      name: 1,
      price: 1,
      rating: 1
    }
  },
  { $sort: { price: 1 } },
  { $limit: 10 }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario3-1-before')">Before ì¿¼ë¦¬ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario3-1-before"></div>
                </div>

                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>âœ… After (ì„±ëŠ¥ ê°œì„ )</strong></p>
                    <p style="color: #00ED64; font-size: 13px; margin: 8px 0; padding: 8px; background: rgba(0, 237, 100, 0.1); border-left: 3px solid #00ED64; border-radius: 4px;">
                        <strong>ê°œì„  í¬ì¸íŠ¸:</strong> $limit ì¡°ê¸° ì ìš©, Projection ìµœì†Œí™”, Search ê²°ê³¼ í­ ì œí•œ â†’ ì²´ê° ì„±ëŠ¥: ìˆ˜ ì´ˆ â†’ ìˆ˜ë°± ms
                    </p>
                    <div class="code-block">
                        <code>db.bigProducts.aggregate([
  {
    $search: {
      index: "bigProductSearch",
      text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
    }
  },
  { $limit: 50 },
  {
    $project: {
      name: 1,
      price: 1,
      rating: 1
    }
  },
  { $sort: { price: 1 } },
  { $limit: 10 }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario3-1-after')">After ì¿¼ë¦¬ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario3-1-after"></div>
                </div>

                <h3>ì˜ˆì œ 2: Atlas Search Indexê°€ ë¹„ëŒ€í•´ì§„ ê²½ìš°</h3>
                <div class="problem-box" style="margin-bottom: 20px;">
                    <p><strong>ë¬¸ì œ ìƒí™©:</strong></p>
                    <ul style="color: #B8C5D1; font-size: 13px; margin: 8px 0; padding-left: 20px;">
                        <li>ê²€ìƒ‰ì€ ë˜ì§€ë§Œ ì ì  ëŠë ¤ì§</li>
                        <li>Index Size ê¸‰ì¦</li>
                    </ul>
                    <p style="color: #FFC107; font-size: 13px; margin: 12px 0; padding: 8px; background: rgba(255, 193, 7, 0.1); border-left: 3px solid #FFC107; border-radius: 4px;">
                        <strong>ë¬¸ì œ:</strong> ëª¨ë“  í•„ë“œê°€ Search Index ëŒ€ìƒ, description, specs, logsê¹Œì§€ ì¸ë±ì‹±
                    </p>
                </div>

                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>âŒ Before (ê³¼ë„í•œ dynamic mapping)</strong></p>
                    <div class="code-block">
                        <code>{
  "mappings": {
    "dynamic": true
  }
}</code>
                    </div>
                    <p style="color: #B8C5D1; font-size: 12px; margin: 8px 0;">
                        âš ï¸ ì´ ì„¤ì •ì€ Atlas UIì—ì„œ Index ìƒì„± ì‹œ ì‚¬ìš©í•©ë‹ˆë‹¤. ì›¹ì—ì„œ ì§ì ‘ ì‹¤í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
                    </p>
                    <p style="color: #B8C5D1; font-size: 13px; margin: 8px 0;">
                        <strong>Index ì´ë¦„:</strong> <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">bigProductSearchDynamic</code>
                    </p>
                    <p style="color: #B8C5D1; font-size: 13px; margin: 12px 0; padding: 8px; background: rgba(0, 150, 255, 0.1); border-left: 3px solid #0096FF; border-radius: 4px;">
                        ğŸ’¡ <strong>ì¸ë±ìŠ¤ ì‚¬ì´ì¦ˆ ë¹„êµ:</strong> dynamic: true ì¸ë±ìŠ¤ì˜ ì‚¬ì´ì¦ˆë¥¼ í™•ì¸í•˜ë ¤ë©´ Atlas UIì—ì„œ í™•ì¸í•˜ê±°ë‚˜, ì•„ë˜ ë²„íŠ¼ìœ¼ë¡œ ì¸ë±ìŠ¤ ì •ë³´ë¥¼ ì¡°íšŒí•˜ì„¸ìš”.
                    </p>
                    <button class="execute-btn" onclick="checkIndexSize('bigProducts', 'dynamic')" style="margin-top: 8px;">Dynamic Index ì‚¬ì´ì¦ˆ ì¡°íšŒ</button>
                    <div class="result-box" id="result-index-size-dynamic"></div>
                </div>

                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>âœ… After (í•„ìš”í•œ í•„ë“œë§Œ ì¸ë±ì‹±)</strong></p>
                    <p style="color: #00ED64; font-size: 13px; margin: 8px 0; padding: 8px; background: rgba(0, 237, 100, 0.1); border-left: 3px solid #00ED64; border-radius: 4px;">
                        <strong>íš¨ê³¼:</strong> Index í¬ê¸° ê°ì†Œ, ê²€ìƒ‰ ì†ë„ ì•ˆì •í™”, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê°ì†Œ
                    </p>
                    <div class="code-block">
                        <code>{
  "mappings": {
    "dynamic": false,
    "fields": {
      "name": { "type": "string" },
      "category": { "type": "string" },
      "brand": { "type": "string" }
    }
  }
}</code>
                    </div>
                    <p style="color: #B8C5D1; font-size: 12px; margin: 8px 0;">
                        âš ï¸ ì´ ì„¤ì •ì€ Atlas UIì—ì„œ Index ìƒì„± ì‹œ ì‚¬ìš©í•©ë‹ˆë‹¤. ì›¹ì—ì„œ ì§ì ‘ ì‹¤í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
                    </p>
                    <p style="color: #B8C5D1; font-size: 13px; margin: 8px 0;">
                        <strong>Index ì´ë¦„:</strong> <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">bigProductSearchStatic</code>
                    </p>
                    <p style="color: #B8C5D1; font-size: 13px; margin: 12px 0; padding: 8px; background: rgba(0, 237, 100, 0.1); border-left: 3px solid #00ED64; border-radius: 4px;">
                        ğŸ’¡ <strong>ì¸ë±ìŠ¤ ì‚¬ì´ì¦ˆ ë¹„êµ:</strong> dynamic: false ì¸ë±ìŠ¤ì˜ ì‚¬ì´ì¦ˆë¥¼ í™•ì¸í•˜ë ¤ë©´ Atlas UIì—ì„œ í™•ì¸í•˜ê±°ë‚˜, ì•„ë˜ ë²„íŠ¼ìœ¼ë¡œ ì¸ë±ìŠ¤ ì •ë³´ë¥¼ ì¡°íšŒí•˜ì„¸ìš”.
                    </p>
                    <button class="execute-btn" onclick="checkIndexSize('bigProducts', 'static')" style="margin-top: 8px;">Static Index ì‚¬ì´ì¦ˆ ì¡°íšŒ</button>
                    <div class="result-box" id="result-index-size-static"></div>
                </div>

                <h3>ì˜ˆì œ 3: $matchë¥¼ $searchë¡œ ì˜®ê²¨ì„œ ì„±ëŠ¥ ê°œì„ </h3>
                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>âŒ Before</strong></p>
                    <p style="color: #FFC107; font-size: 13px; margin: 8px 0; padding: 8px; background: rgba(255, 193, 7, 0.1); border-left: 3px solid #FFC107; border-radius: 4px;">
                        <strong>ë¬¸ì œ:</strong> ê²€ìƒ‰ í›„ í•„í„°ë§, ë¶ˆí•„ìš”í•œ ê²°ê³¼ ë‹¤ìˆ˜ ìƒì„±
                    </p>
                    <div class="code-block">
                        <code>db.bigProducts.aggregate([
  {
    $search: {
      index: "bigProductSearch",
      text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
    }
  },
  { $match: { category: "ìŠ¤ë§ˆíŠ¸í°" } }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario3-3-before')">Before ì¿¼ë¦¬ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario3-3-before"></div>
                </div>

                <div class="solution-box" style="margin-top: 20px; background: rgba(255, 82, 82, 0.1); border: 1px solid rgba(255, 82, 82, 0.3);">
                    <p><strong>âŒ ì˜ëª»ëœ After (ë” ëŠë¦¼!)</strong></p>
                    <p style="color: #FF5252; font-size: 13px; margin: 8px 0; padding: 8px; background: rgba(255, 82, 82, 0.1); border-left: 3px solid #FF5252; border-radius: 4px;">
                        <strong>ë¬¸ì œ:</strong> <code>must</code>ì— ë‘ ê°œì˜ <code>text</code> ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ë‘ í•„ë“œ ëª¨ë‘ ì ìˆ˜ ê³„ì‚°ì´ ìˆ˜í–‰ë˜ì–´ ë” ëŠë ¤ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì •í™• ì¼ì¹˜ê°€ í•„ìš”í•œ í•„ë“œëŠ” <code>text</code> ëŒ€ì‹  <code>equals</code>ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
                    </p>
                    <div class="code-block">
                        <code>db.bigProducts.aggregate([
  {
    $search: {
      index: "bigProductSearch",
      compound: {
        must: [
          { text: { query: "ê°¤ëŸ­ì‹œ", path: "name" } },
          { text: { query: "ìŠ¤ë§ˆíŠ¸í°", path: "category" } }
        ]
      }
    }
  }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario3-3-wrong')">ì˜ëª»ëœ After ì¿¼ë¦¬ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario3-3-wrong"></div>
                </div>

                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>âœ… ì˜¬ë°”ë¥¸ After</strong></p>
                    <p style="color: #00ED64; font-size: 13px; margin: 8px 0; padding: 8px; background: rgba(0, 237, 100, 0.1); border-left: 3px solid #00ED64; border-radius: 4px;">
                        <strong>ê°œì„  íš¨ê³¼:</strong> Lucene ë‹¨ê³„ì—ì„œ í•„í„°ë§, I/O, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ëŒ€í­ ê°ì†Œ<br>
                        ğŸ’¡ <strong>í•µì‹¬:</strong> <code>filter</code>ëŠ” ì ìˆ˜ ê³„ì‚° ì—†ì´ í•„í„°ë§ë§Œ ìˆ˜í–‰í•˜ë¯€ë¡œ <code>must</code>ë³´ë‹¤ ë¹ ë¦…ë‹ˆë‹¤. ì •í™• ì¼ì¹˜ê°€ í•„ìš”í•œ ê²½ìš° <code>equals</code>ë¥¼ <code>filter</code>ì— ì‚¬ìš©í•˜ì„¸ìš”.
                    </p>
                    <div class="code-block">
                        <code>db.bigProducts.aggregate([
  {
    $search: {
      index: "bigProductSearch",
      compound: {
        must: [
          { text: { query: "ê°¤ëŸ­ì‹œ", path: "name" } }
        ],
        filter: [
          { equals: { path: "category", value: "ìŠ¤ë§ˆíŠ¸í°" } }
        ]
      }
    }
  }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario3-3-after')">After ì¿¼ë¦¬ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario3-3-after"></div>
                </div>

                <h3>ì˜ˆì œ 4: $searchMetaë¡œ ì„±ëŠ¥ ë¬¸ì œ ì›ì¸ ë¶„ë¦¬</h3>
                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>ëª©ì :</strong> ëŠë¦° ì›ì¸ì´ Searchì¸ì§€ í›„ì† íŒŒì´í”„ë¼ì¸ì¸ì§€ êµ¬ë¶„</p>
                    <div class="code-block">
                        <code>db.products.aggregate([
  {
    $searchMeta: {
      index: "productSearch",
      text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
    }
  }
])</code>
                    </div>
                    <p style="color: #B8C5D1; font-size: 13px; margin: 8px 0; padding: 8px; background: rgba(0, 150, 255, 0.1); border-left: 3px solid #0096FF; border-radius: 4px;">
                        <strong>í•´ì„:</strong> $searchMetaê°€ ë¹ ë¥´ë©´ â†’ SearchëŠ” ì •ìƒ, ëŠë¦¬ë©´ â†’ Index êµ¬ì¡° ë¬¸ì œ
                    </p>
                    <button class="execute-btn" onclick="executeQuery('scenario3-4')">$searchMeta ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario3-4"></div>
                </div>

                <h3>ì˜ˆì œ 5: autocomplete ì„±ëŠ¥ ìµœì í™”</h3>
                
                <div class="solution-box" style="margin-bottom: 30px;">
                    <p><strong>âš ï¸ ì‚¬ì „ ì¤€ë¹„: autocomplete Index í™•ì¸ ë° ìƒì„±</strong></p>
                    <p style="color: #B8C5D1; font-size: 13px; margin: 8px 0;">
                        ì˜ˆì œ 5ëŠ” autocomplete ì „ìš© ì¸ë±ìŠ¤ê°€ í•„ìš”í•©ë‹ˆë‹¤. <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">bigProducts</code> ì»¬ë ‰ì…˜ì— <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">bigProductSearchAutocomplete</code> ì¸ë±ìŠ¤ë¥¼ ìƒì„±í•˜ì„¸ìš”.
                    </p>
                    <div class="solution-box" style="margin-top: 16px;">
                        <p><strong>1. Index ëª©ë¡ í™•ì¸</strong></p>
                        <div class="code-block">
                            <code>// Index ëª©ë¡ í™•ì¸
db.bigProducts.getSearchIndexes()</code>
                        </div>
                        <button class="execute-btn" onclick="executeGetIndexesForExample5('bigProducts')">Index ëª©ë¡ ì¡°íšŒ</button>
                        <div class="result-box" id="result-indexes-bigProducts-example5"></div>
                    </div>
                    <div class="solution-box" style="margin-top: 20px;">
                        <p><strong>2. Index ìƒì„± (Indexê°€ ì—†ëŠ” ê²½ìš°)</strong></p>
                        <p style="color: #B8C5D1; font-size: 14px; margin: 12px 0;">MongoDB Atlas UIì—ì„œ Search Indexë¥¼ ìƒì„±í•˜ì„¸ìš”:</p>
                        <ol style="color: #B8C5D1; font-size: 14px; margin: 12px 0; padding-left: 20px;">
                            <li>MongoDB Atlas ì½˜ì†”ì— ë¡œê·¸ì¸</li>
                            <li>ì™¼ìª½ ë©”ë‰´ì—ì„œ <strong>Search</strong> í´ë¦­</li>
                            <li><strong>Create Search Index</strong> ë²„íŠ¼ í´ë¦­</li>
                            <li><strong>JSON Editor</strong> ì„ íƒ</li>
                            <li>ì•„ë˜ JSONì„ ë³µì‚¬í•˜ì—¬ ë¶™ì—¬ë„£ê¸°:</li>
                        </ol>
                        <div class="code-block">
                            <code>{
  "mappings": {
    "dynamic": false,
    "fields": {
      "name": {
        "type": "autocomplete",
        "minGrams": 2,
        "maxGrams": 15
      }
    }
  }
}</code>
                        </div>
                        <p style="color: #B8C5D1; font-size: 14px; margin: 12px 0;">
                            <strong>Index ì´ë¦„:</strong> <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">bigProductSearchAutocomplete</code>
                        </p>
                        <p style="color: #B8C5D1; font-size: 14px; margin: 12px 0;">
                            <strong>Database:</strong> ì‚¬ìš© ì¤‘ì¸ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„
                        </p>
                        <p style="color: #B8C5D1; font-size: 14px; margin: 12px 0;">
                            <strong>Collection:</strong> <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">bigProducts</code>
                        </p>
                        <p style="color: #B8C5D1; font-size: 13px; margin-top: 12px; padding: 12px; background: rgba(0, 150, 255, 0.1); border-left: 3px solid #0096FF; border-radius: 4px;">
                            ğŸ’¡ <strong>ì°¸ê³ :</strong> Index ìƒì„± í›„ BUILDING ìƒíƒœì—ì„œ READY ìƒíƒœë¡œ ë³€ê²½ë˜ëŠ”ë° ëª‡ ë¶„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. READY ìƒíƒœê°€ ë˜ë©´ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </p>
                        <button class="execute-btn" onclick="checkIndexStatusForExample5('bigProducts', 'bigProductSearchAutocomplete')" style="margin-top: 16px;">ì¸ë±ìŠ¤ ìƒì„± í™•ì¸</button>
                        <div class="result-box" id="result-indexes-bigProducts-autocomplete-check"></div>
                    </div>
                </div>

                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>âŒ Before</strong></p>
                    <p style="color: #FFC107; font-size: 13px; margin: 8px 0; padding: 8px; background: rgba(255, 193, 7, 0.1); border-left: 3px solid #FFC107; border-radius: 4px;">
                        <strong>ë¬¸ì œ:</strong> ê¸´ descriptionê¹Œì§€ autocomplete ëŒ€ìƒìœ¼ë¡œ í•˜ë©´ Index í¬ê¸°ê°€ ì»¤ì§€ê³  ì„±ëŠ¥ì´ ì €í•˜ë©ë‹ˆë‹¤.
                    </p>
                    <div class="code-block">
                        <code>{
  "mappings": {
    "dynamic": false,
    "fields": {
      "name": {
        "type": "autocomplete"
      },
      "description": {
        "type": "autocomplete"
      }
    }
  }
}</code>
                    </div>
                    <p style="color: #B8C5D1; font-size: 12px; margin: 8px 0;">
                        âš ï¸ ì´ ì„¤ì •ì€ Atlas UIì—ì„œ Index ìƒì„± ì‹œ ì‚¬ìš©í•©ë‹ˆë‹¤. Index ì´ë¦„: <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">bigProductSearchAutocompleteBefore</code>
                    </p>
                    <p style="color: #B8C5D1; font-size: 13px; margin: 8px 0; padding: 8px; background: rgba(255, 193, 7, 0.1); border-left: 3px solid #FFC107; border-radius: 4px;">
                        <strong>ğŸ“ Before ì¿¼ë¦¬ ì˜ˆì œ:</strong> descriptionê¹Œì§€ autocomplete ëŒ€ìƒìœ¼ë¡œ í•œ ê²½ìš°
                    </p>
                    <div class="code-block">
                        <code>db.bigProducts.aggregate([
  {
    $search: {
      index: "bigProductSearchAutocompleteBefore",
      autocomplete: {
        query: "ì‚¼ì„±",
        path: "name"
      }
    }
  },
  { $limit: 10 }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario3-5-autocomplete-before')">Before autocomplete ì¿¼ë¦¬ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario3-5-autocomplete-before"></div>
                    <p style="color: #B8C5D1; font-size: 12px; margin: 8px 0; margin-top: 12px; padding: 8px; background: rgba(255, 193, 7, 0.1); border-left: 3px solid #FFC107; border-radius: 4px;">
                        âš ï¸ <strong>ì°¸ê³ :</strong> Before ì¸ë±ìŠ¤(<code>bigProductSearchAutocompleteBefore</code>)ë¥¼ ìƒì„±í•˜ì§€ ì•Šìœ¼ë©´ ì¿¼ë¦¬ê°€ ì‹¤íŒ¨í•©ë‹ˆë‹¤. Before ì¸ë±ìŠ¤ëŠ” ì„ íƒ ì‚¬í•­ì´ë©°, ì„±ëŠ¥ ë¹„êµë¥¼ ìœ„í•´ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                </div>

                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>âœ… After</strong></p>
                    <p style="color: #00ED64; font-size: 13px; margin: 8px 0; padding: 8px; background: rgba(0, 237, 100, 0.1); border-left: 3px solid #00ED64; border-radius: 4px;">
                        <strong>íš¨ê³¼:</strong> Index í¬ê¸° ê°ì†Œ, íƒ€ì´í•‘ ì‘ë‹µ ì†ë„ ê°œì„ 
                    </p>
                    <div class="code-block">
                        <code>{
  "name": {
    "type": "autocomplete",
    "minGrams": 2,
    "maxGrams": 15
  }
}</code>
                    </div>
                    <p style="color: #B8C5D1; font-size: 12px; margin: 8px 0;">
                        âš ï¸ ì´ ì„¤ì •ì€ Atlas UIì—ì„œ Index ìƒì„± ì‹œ ì‚¬ìš©í•©ë‹ˆë‹¤. ì›¹ì—ì„œ ì§ì ‘ ì‹¤í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
                    </p>
                </div>

                <div class="solution-box" style="margin-top: 20px;">
                    <p><strong>ğŸ“ ì‹¤ì œ ì¿¼ë¦¬ ì˜ˆì œ</strong></p>
                    <p style="color: #B8C5D1; font-size: 13px; margin: 8px 0; padding: 8px; background: rgba(0, 150, 255, 0.1); border-left: 3px solid #0096FF; border-radius: 4px;">
                        <strong>ì„¤ëª…:</strong> autocomplete ì¸ë±ìŠ¤ê°€ ìƒì„±ë˜ë©´ ì•„ë˜ ì¿¼ë¦¬ë¡œ ìë™ì™„ì„± ê¸°ëŠ¥ì„ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‚¬ìš©ìê°€ "ì‚¼ì„±"ì„ ì…ë ¥í•˜ë©´ "ì‚¼ì„±"ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ì œí’ˆëª…ì„ ìë™ì™„ì„±ìœ¼ë¡œ ì œì•ˆí•©ë‹ˆë‹¤.
                    </p>
                    <div class="code-block">
                        <code>db.bigProducts.aggregate([
  {
    $search: {
      index: "bigProductSearchAutocomplete",
      autocomplete: {
        query: "ì‚¼ì„±",
        path: "name"
      }
    }
  },
  { $limit: 10 }
])</code>
                    </div>
                    <button class="execute-btn" onclick="executeQuery('scenario3-5-autocomplete')">autocomplete ì¿¼ë¦¬ ì‹¤í–‰</button>
                    <div class="result-box" id="result-scenario3-5-autocomplete"></div>
                    <p style="color: #B8C5D1; font-size: 12px; margin: 8px 0; margin-top: 12px; padding: 8px; background: rgba(0, 150, 255, 0.1); border-left: 3px solid #0096FF; border-radius: 4px;">
                        ğŸ’¡ <strong>íŒ:</strong> autocompleteëŠ” prefix ê¸°ë°˜ìœ¼ë¡œ ë§¤ì¹­ë©ë‹ˆë‹¤. ì œí’ˆëª…ì´ "ì‚¼ì„± ê°¤ëŸ­ì‹œ ..." í˜•ì‹ì´ë¯€ë¡œ "ì‚¼ì„±"ìœ¼ë¡œ ê²€ìƒ‰í•˜ë©´ ê²°ê³¼ê°€ ë‚˜ì˜µë‹ˆë‹¤. ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë¡œë„ í…ŒìŠ¤íŠ¸í•´ë³´ì„¸ìš” (ì˜ˆ: "ê°¤ëŸ­ì‹œ", "ì•„ì´", "í”„ë¡œ"). 
                        <br><br>
                        âš ï¸ <strong>ê²°ê³¼ê°€ 0ê±´ì¸ ê²½ìš°:</strong> 
                        <ul style="margin: 8px 0; padding-left: 20px;">
                            <li>ì¸ë±ìŠ¤ê°€ READY ìƒíƒœì¸ì§€ í™•ì¸í•˜ì„¸ìš” (BUILDING ìƒíƒœë©´ ëª‡ ë¶„ ê¸°ë‹¤ë ¤ì•¼ í•©ë‹ˆë‹¤)</li>
                            <li>ì¸ë±ìŠ¤ ì´ë¦„ì´ <code>bigProductSearchAutocomplete</code>ì¸ì§€ í™•ì¸í•˜ì„¸ìš”</li>
                            <li>ê²€ìƒ‰ì–´ë¥¼ "ì‚¼ì„±", "ê°¤ëŸ­ì‹œ", "ì•„ì´" ë“±ìœ¼ë¡œ ë³€ê²½í•´ë³´ì„¸ìš”</li>
                        </ul>
                    </p>
                </div>

                <div class="problem-box" style="margin-top: 30px; background: rgba(0, 237, 100, 0.05); border: 1px solid rgba(0, 237, 100, 0.2);">
                    <h3 style="color: #00ED64; margin-bottom: 16px;">Atlas ì„±ëŠ¥ ê°œì„  í•µì‹¬ ì²´í¬ë¦¬ìŠ¤íŠ¸</h3>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 12px; background: rgba(0, 0, 0, 0.2); border-radius: 4px; overflow: hidden;">
                        <thead>
                            <tr style="background: rgba(0, 237, 100, 0.1);">
                                <th style="padding: 10px 12px; text-align: left; color: #00ED64; font-size: 13px; font-weight: 600; border-bottom: 1px solid rgba(0, 237, 100, 0.2);">í•­ëª©</th>
                                <th style="padding: 10px 12px; text-align: left; color: #00ED64; font-size: 13px; font-weight: 600; border-bottom: 1px solid rgba(0, 237, 100, 0.2);">ì²´í¬</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                                <td style="padding: 10px 12px; color: #FFFFFF; font-size: 13px;">$limit ì¡°ê¸° ì ìš©</td>
                                <td style="padding: 10px 12px; color: #00ED64; font-size: 13px;">í•„ìˆ˜</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                                <td style="padding: 10px 12px; color: #FFFFFF; font-size: 13px;">Projection ìµœì†Œí™”</td>
                                <td style="padding: 10px 12px; color: #00ED64; font-size: 13px;">í•„ìˆ˜</td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                                <td style="padding: 10px 12px; color: #FFFFFF; font-size: 13px;">dynamic mapping ì‚¬ìš© ì—¬ë¶€</td>
                                <td style="padding: 10px 12px; color: #FFC107; font-size: 13px;">ì¬ê²€í† </td>
                            </tr>
                            <tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                                <td style="padding: 10px 12px; color: #FFFFFF; font-size: 13px;">filterë¥¼ $searchë¡œ ì´ë™</td>
                                <td style="padding: 10px 12px; color: #0096FF; font-size: 13px;">ê¶Œì¥</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px 12px; color: #FFFFFF; font-size: 13px;">$searchMetaë¡œ ë¶„ë¦¬ ì§„ë‹¨</td>
                                <td style="padding: 10px 12px; color: #00ED64; font-size: 13px;">í•„ìˆ˜</td>
                            </tr>
                        </tbody>
                    </table>
                    <p style="color: #B8C5D1; font-size: 13px; margin-top: 16px; padding: 12px; background: rgba(0, 0, 0, 0.2); border-radius: 4px;">
                        <strong>íŒ€ ê³µìœ ìš© í•œ ë¬¸ì¥ ìš”ì•½:</strong><br>
                        Atlas ì„±ëŠ¥ ë¬¸ì œì˜ ëŒ€ë¶€ë¶„ì€ Search ìì²´ê°€ ì•„ë‹ˆë¼ Index ì„¤ê³„, íŒŒì´í”„ë¼ì¸ ìˆœì„œ, ë¶ˆí•„ìš”í•œ ë°ì´í„° ë¡œë”©ì—ì„œ ë°œìƒí•˜ë©°, $limit, $search compound, ëª…ì‹œì  mappingë§Œìœ¼ë¡œë„ í° ê°œì„  íš¨ê³¼ë¥¼ ë‚¼ ìˆ˜ ìˆë‹¤.
                    </p>
                </div>
            </div>
        </div>

        <!-- ì‹œë‚˜ë¦¬ì˜¤ 4: Index ë³€ê²½ -->
        <div class="tab-content">
            <div class="scenario">
                <h2>ì‹œë‚˜ë¦¬ì˜¤ 4: Index ë³€ê²½ í›„ ê²°ê³¼ê°€ ì´ìƒí•œ ê²½ìš°</h2>
                
                <h3>ë¬¸ì œ 1: Index Status í™•ì¸</h3>
                <div class="solution-box">
                    <p><strong>ë””ë²„ê¹…:</strong> Index Status í™•ì¸ (BUILDING / READY / FAILED)</p>
                    <div class="code-block">
                        <code>db.products.getSearchIndexes()</code>
                    </div>
                    <button class="execute-btn" onclick="executeGetIndexes('products')">Index Status í™•ì¸</button>
                    <div class="result-box" id="result-scenario4-1"></div>
                </div>
            </div>
        </div>

        <!-- ì‹œë‚˜ë¦¬ì˜¤ 5: ìš´ì˜ í™˜ê²½ -->
        <div class="tab-content">
            <div class="scenario">
                <h2>ì‹œë‚˜ë¦¬ì˜¤ 5: ìš´ì˜ í™˜ê²½ì—ì„œë§Œ ë°œìƒí•˜ëŠ” ë¬¸ì œ</h2>
                
                <h3>ë°ì´í„° í™•ì¸</h3>
                <div class="solution-box">
                    <p><strong>ë°ì´í„° í™•ì¸:</strong> ìƒ˜í”Œ ë°ì´í„° í™•ì¸</p>
                    <div class="code-block">
                        <code>db.products.find().limit(5)</code>
                    </div>
                    <button class="execute-btn" onclick="executeFind('products', {})">ë°ì´í„° í™•ì¸</button>
                    <div class="result-box" id="result-scenario5-1"></div>
                </div>
            </div>
        </div>

        <!-- ì²´í¬ë¦¬ìŠ¤íŠ¸ -->
        <div class="tab-content">
            <div class="scenario">
                <h2>ë””ë²„ê¹… ì²´í¬ë¦¬ìŠ¤íŠ¸</h2>
                
                <h3>ê¸°ë³¸ í™•ì¸ ì‚¬í•­</h3>
                <ul class="checklist">
                    <li>Index ì¡´ì¬ ì—¬ë¶€ í™•ì¸: db.collection.getSearchIndexes()</li>
                    <li>Index Status í™•ì¸ (BUILDING / READY / FAILED)</li>
                    <li>Mapping vs ì‹¤ì œ ë°ì´í„° êµ¬ì¡° ì¼ì¹˜ ì—¬ë¶€</li>
                    <li>Analyzer í™•ì¸</li>
                    <li>$searchMeta í™œìš©</li>
                    <li>ë‹¨ìˆœ ì¿¼ë¦¬ë¶€í„° ë‹¨ê³„ì  í™•ì¥</li>
                </ul>

                <h3>ìœ ìš©í•œ ë””ë²„ê¹… ì¿¼ë¦¬</h3>
                <div class="code-block">
                    <code>// Index ì •ë³´ í™•ì¸
db.collection.getSearchIndexes()

// $searchMetaë¡œ ë§¤ì¹­ í™•ì¸
db.collection.aggregate([
  {
    $searchMeta: {
      index: "indexName",
      text: { query: "ê²€ìƒ‰ì–´", path: "fieldName" }
    }
  }
])</code>
                </div>
            </div>
        </div>
    </div>

    <script>
        // localStorageì—ì„œ ì—°ê²° ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°
        window.addEventListener('DOMContentLoaded', () => {
            const savedConnectionString = localStorage.getItem('atlasDemoConnectionString');
            const savedDbName = localStorage.getItem('atlasDemoDbName');
            
            console.log('ì €ì¥ëœ ì—°ê²° ì •ë³´:', { 
                connectionString: savedConnectionString ? savedConnectionString.substring(0, 30) + '...' : 'ì—†ìŒ',
                connectionStringLength: savedConnectionString ? savedConnectionString.length : 0,
                dbName: savedDbName || 'ì—†ìŒ',
                connectionStringValid: savedConnectionString ? (savedConnectionString.startsWith('mongodb://') || savedConnectionString.startsWith('mongodb+srv://')) : false
            });
            
            const connectionStringInput = document.getElementById('connectionString');
            const dbNameInput = document.getElementById('dbName');
            const statusDiv = document.getElementById('connectionStatus');

            if (savedConnectionString && connectionStringInput) {
                connectionStringInput.value = savedConnectionString;
                console.log('ì—°ê²° ë¬¸ìì—´ ì…ë ¥ í•„ë“œì— ê°’ ì„¤ì • ì™„ë£Œ:', {
                    fieldValue: connectionStringInput.value.substring(0, 30),
                    fieldValueLength: connectionStringInput.value.length
                });
                updateConnectionStatus(true, 'ì—°ê²° ì •ë³´ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');
            } else {
                console.warn('ì €ì¥ëœ ì—°ê²° ë¬¸ìì—´ì´ ì—†ìŠµë‹ˆë‹¤.');
                updateConnectionStatus(false, 'âš ï¸ ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë©”ì¸ í˜ì´ì§€ì—ì„œ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë¨¼ì € ë¡œë”©í•˜ê±°ë‚˜, ì•„ë˜ì— ì—°ê²° ì •ë³´ë¥¼ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”.');
            }
            
            if (savedDbName && dbNameInput) {
                dbNameInput.value = savedDbName;
                console.log('ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ ì…ë ¥ í•„ë“œì— ê°’ ì„¤ì • ì™„ë£Œ:', dbNameInput.value);
            }

            // ì—°ê²° ì •ë³´ê°€ ì—†ìœ¼ë©´ ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ
            if (!savedConnectionString || !savedDbName) {
                updateConnectionStatus(false, 'âš ï¸ ì—°ê²° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë©”ì¸ í˜ì´ì§€ì—ì„œ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë¨¼ì € ë¡œë”©í•˜ê±°ë‚˜, ì•„ë˜ì— ì—°ê²° ì •ë³´ë¥¼ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”.');
            }

            // ì…ë ¥ í•„ë“œ ë³€ê²½ ê°ì§€
            if (connectionStringInput) {
                connectionStringInput.addEventListener('input', () => {
                    const value = connectionStringInput.value.trim();
                    if (value && (value.startsWith('mongodb://') || value.startsWith('mongodb+srv://'))) {
                        updateConnectionStatus(true, 'ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì˜¬ë°”ë¦…ë‹ˆë‹¤.');
                        localStorage.setItem('atlasDemoConnectionString', value);
                    } else if (value) {
                        updateConnectionStatus(false, 'ì—°ê²° ë¬¸ìì—´ì€ mongodb:// ë˜ëŠ” mongodb+srv://ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.');
                    } else {
                        updateConnectionStatus(false, 'ì—°ê²° ë¬¸ìì—´ì„ ì…ë ¥í•˜ì„¸ìš”.');
                    }
                });
            }

            if (dbNameInput) {
                dbNameInput.addEventListener('input', () => {
                    const value = dbNameInput.value.trim();
                    if (value) {
                        localStorage.setItem('atlasDemoDbName', value);
                    }
                });
            }
        });

        function updateConnectionStatus(isValid, message) {
            const statusDiv = document.getElementById('connectionStatus');
            if (!statusDiv) return;
            
            statusDiv.style.display = 'block';
            statusDiv.style.background = isValid ? 'rgba(0, 237, 100, 0.1)' : 'rgba(255, 193, 7, 0.1)';
            statusDiv.style.border = isValid ? '1px solid rgba(0, 237, 100, 0.3)' : '1px solid rgba(255, 193, 7, 0.3)';
            statusDiv.style.color = isValid ? '#00ED64' : '#FFC107';
            statusDiv.style.fontSize = '13px';
            statusDiv.textContent = message;
        }

        function showTab(index) {
            const tabs = document.querySelectorAll('.tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach((tab, i) => {
                if (i === index) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            contents.forEach((content, i) => {
                if (i === index) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
        }

        async function executeQuery(queryId) {
            // ë¨¼ì € localStorageì—ì„œ ì—°ê²° ì •ë³´ í™•ì¸
            let connectionString = localStorage.getItem('atlasDemoConnectionString');
            let dbName = localStorage.getItem('atlasDemoDbName');
            
            console.log('1. localStorageì—ì„œ ì½ì€ ê°’:', {
                connectionString: connectionString ? connectionString.substring(0, 30) + '...' : 'ì—†ìŒ',
                connectionStringLength: connectionString ? connectionString.length : 0,
                dbName: dbName || 'ì—†ìŒ'
            });
            
            // localStorageì— ì—†ìœ¼ë©´ ì…ë ¥ í•„ë“œì—ì„œ ì½ê¸°
            const connectionStringInput = document.getElementById('connectionString');
            const dbNameInput = document.getElementById('dbName');
            
            if (!connectionString && connectionStringInput) {
                connectionString = connectionStringInput.value.trim();
                console.log('2. ì…ë ¥ í•„ë“œì—ì„œ ì½ì€ ê°’:', {
                    connectionString: connectionString ? connectionString.substring(0, 30) + '...' : 'ì—†ìŒ',
                    connectionStringLength: connectionString ? connectionString.length : 0
                });
            }
            
            if (!dbName && dbNameInput) {
                dbName = dbNameInput.value.trim();
            }
            
            // ìµœì¢…ì ìœ¼ë¡œ ì‚¬ìš©í•  ì—°ê²° ì •ë³´
            connectionString = connectionString ? connectionString.trim() : '';
            dbName = dbName ? dbName.trim() : '';
            
            const resultBox = document.getElementById(`result-${queryId}`);
            
            console.log('3. ìµœì¢… ì‚¬ìš©í•  ì—°ê²° ì •ë³´:', { 
                queryId, 
                connectionStringExists: !!connectionString,
                connectionStringLength: connectionString.length,
                connectionStringPreview: connectionString ? connectionString.substring(0, 50) + '...' : 'ë¹„ì–´ìˆìŒ',
                connectionStringStartsWith: connectionString ? (connectionString.startsWith('mongodb://') || connectionString.startsWith('mongodb+srv://')) : false,
                dbName: dbName || 'ë¹„ì–´ìˆìŒ'
            });
            
            // ì—°ê²° ë¬¸ìì—´ ê²€ì¦
            if (!connectionString || connectionString === '') {
                const errorMsg = 'ì—°ê²° ë¬¸ìì—´ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.';
                const hintMsg = 'ì—°ê²° ë¬¸ìì—´ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\n' +
                    'í•´ê²° ë°©ë²•:\n' +
                    '1. ë©”ì¸ í˜ì´ì§€(/)ë¡œ ì´ë™í•˜ì—¬ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë¡œë”©í•˜ì„¸ìš”.\n' +
                    '2. ë˜ëŠ” ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— MongoDB Atlas ì—°ê²° ë¬¸ìì—´ì„ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”.\n\n' +
                    'localStorage ê°’: ' + (localStorage.getItem('atlasDemoConnectionString') ? 'ìˆìŒ' : 'ì—†ìŒ') + '\n' +
                    'ì…ë ¥ í•„ë“œ ê°’: ' + (connectionStringInput && connectionStringInput.value ? 'ìˆìŒ' : 'ì—†ìŒ');
                console.error('âŒ', errorMsg, { 
                    localStorageValue: localStorage.getItem('atlasDemoConnectionString') ? 'ìˆìŒ' : 'ì—†ìŒ',
                    inputFieldValue: connectionStringInput ? connectionStringInput.value : 'í•„ë“œ ì—†ìŒ'
                });
                showError(resultBox, errorMsg, hintMsg);
                return;
            }

            if (!dbName || dbName === '') {
                showError(resultBox, 'ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.', 'ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì—°ê²° ë¬¸ìì—´ í˜•ì‹ ê²€ì¦
            if (!connectionString.startsWith('mongodb://') && !connectionString.startsWith('mongodb+srv://')) {
                const errorMsg = 'ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                const hintMsg = 'ì—°ê²° ë¬¸ìì—´ì€ mongodb:// ë˜ëŠ” mongodb+srv://ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.\n\n' +
                    'í˜„ì¬ ê°’ì˜ ì‹œì‘ ë¶€ë¶„: "' + connectionString.substring(0, 50) + '"\n' +
                    'ì „ì²´ ê¸¸ì´: ' + connectionString.length + 'ì';
                console.error(errorMsg, { connectionString: connectionString.substring(0, 100) });
                showError(resultBox, errorMsg, hintMsg);
                return;
            }

            if (connectionString.includes('localhost') || connectionString.includes('127.0.0.1') || connectionString.includes(':28000')) {
                const errorMsg = 'ì—°ê²° ë¬¸ìì—´ì— localhostê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.';
                const hintMsg = 'MongoDB Atlas ì—°ê²° ë¬¸ìì—´ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.\n\n' +
                    'localhost, 127.0.0.1, ë˜ëŠ” :28000ì´ í¬í•¨ëœ ì—°ê²° ë¬¸ìì—´ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n' +
                    'í˜„ì¬ ì—°ê²° ë¬¸ìì—´: ' + connectionString.substring(0, 100);
                console.error(errorMsg, { connectionString: connectionString.substring(0, 100) });
                showError(resultBox, errorMsg, hintMsg);
                return;
            }

            resultBox.classList.remove('show', 'success', 'error');
            resultBox.classList.add('show');
            resultBox.innerHTML = `
                <div class="result-header">ì‹¤í–‰ ì¤‘...</div>
                <div style="margin-top: 12px; padding: 12px; background: rgba(0, 0, 0, 0.3); border-radius: 4px; font-size: 12px; font-family: monospace;">
                    <div style="color: #B8C5D1; margin-bottom: 4px;">ì—°ê²° ë¬¸ìì—´:</div>
                    <div style="color: #00ED64; word-break: break-all;">${connectionString.substring(0, 80)}...</div>
                    <div style="color: #B8C5D1; margin-top: 8px;">ë°ì´í„°ë² ì´ìŠ¤: ${dbName}</div>
                </div>
                <div class="loading"></div>
            `;

            const queries = {
                'scenario1-1': [
                    {
                        $search: {
                            index: "productSearch",
                            text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
                        }
                    },
                    { $limit: 5 }
                ],
                'scenario1-2': [
                    {
                        $searchMeta: {
                            index: "productSearch",
                            text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
                        }
                    }
                ],
                'scenario2-1-text': [
                    {
                        $search: {
                            index: "productSearch",
                            text: { query: "ê°¤ëŸ­ì‹œ í”„ë¡œ", path: "name" }
                        }
                    },
                    { $limit: 5 }
                ],
                'scenario2-1-text-boost': [
                    {
                        $search: {
                            index: "productSearch",
                            compound: {
                                must: [
                                    {
                                        text: {
                                            query: "ê°¤ëŸ­ì‹œ",
                                            path: "name"
                                        }
                                    }
                                ],
                                should: [
                                    {
                                        text: {
                                            query: "ê°¤ëŸ­ì‹œ",
                                            path: "name",
                                            score: { boost: { value: 2 } }
                                        }
                                    },
                                    {
                                        text: {
                                            query: "ìŠ¤ë§ˆíŠ¸í°",
                                            path: "category",
                                            score: { boost: { value: 5 } }
                                        }
                                    }
                                ],
                                minimumShouldMatch: 0
                            }
                        }
                    },
                    { $limit: 5 }
                ],
                'scenario2-1-compound-should': [
                    {
                        $search: {
                            index: "productSearch",
                            compound: {
                                must: [
                                    {
                                        text: {
                                            query: "ê°¤ëŸ­ì‹œ",
                                            path: "name"
                                        }
                                    }
                                ],
                                should: [
                                    {
                                        text: {
                                            query: "ìŠ¤ë§ˆíŠ¸í°",
                                            path: "category"
                                        }
                                    }
                                ],
                                minimumShouldMatch: 0
                            }
                        }
                    },
                    { $limit: 5 }
                ],
                'scenario2-1-autocomplete': [
                    {
                        $search: {
                            index: "productSearchAutocomplete",
                            autocomplete: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
                        }
                    },
                    { $limit: 5 }
                ],
                'scenario2-1-phrase': [
                    {
                        $search: {
                            index: "productSearch",
                            phrase: { query: "ê°¤ëŸ­ì‹œ í”„ë¡œ", path: "name" }
                        }
                    },
                    { $limit: 5 }
                ],
                'scenario2-2': [
                    {
                        $search: {
                            index: "productSearch",
                            text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
                        }
                    },
                    {
                        $addFields: {
                            score: { $meta: "searchScore" }
                        }
                    },
                    {
                        $sort: { score: -1 }
                    },
                    { $limit: 5 }
                ],
                'scenario3-1-before': [
                    {
                        $search: {
                            index: "bigProductSearch",
                            text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
                        }
                    },
                    {
                        $project: {
                            name: 1,
                            price: 1,
                            rating: 1
                        }
                    },
                    { $sort: { price: 1 } },
                    { $limit: 10 }
                ],
                'scenario3-1-after': [
                    {
                        $search: {
                            index: "bigProductSearch",
                            text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
                        }
                    },
                    { $limit: 50 },
                    {
                        $project: {
                            name: 1,
                            price: 1,
                            rating: 1
                        }
                    },
                    { $sort: { price: 1 } },
                    { $limit: 10 }
                ],
                'scenario3-3-before': [
                    {
                        $search: {
                            index: "bigProductSearch",
                            text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
                        }
                    },
                    { $match: { category: "ìŠ¤ë§ˆíŠ¸í°" } },
                    { $limit: 10 }
                ],
                'scenario3-3-wrong': [
                    {
                        $search: {
                            index: "bigProductSearch",
                            compound: {
                                must: [
                                    { text: { query: "ê°¤ëŸ­ì‹œ", path: "name" } },
                                    { text: { query: "ìŠ¤ë§ˆíŠ¸í°", path: "category" } }
                                ]
                            }
                        }
                    },
                    { $limit: 10 }
                ],
                'scenario3-3-after': [
                    {
                        $search: {
                            index: "bigProductSearch",
                            compound: {
                                must: [
                                    { text: { query: "ê°¤ëŸ­ì‹œ", path: "name" } }
                                ],
                                filter: [
                                    { equals: { path: "category", value: "ìŠ¤ë§ˆíŠ¸í°" } }
                                ]
                            }
                        }
                    },
                    { $limit: 10 }
                ],
                'scenario3-4': [
                    {
                        $searchMeta: {
                            index: "bigProductSearch",
                            text: { query: "ê°¤ëŸ­ì‹œ", path: "name" }
                        }
                    }
                ],
                'scenario3-5-autocomplete-before': [
                    {
                        $search: {
                            index: "bigProductSearchAutocompleteBefore",
                            autocomplete: {
                                query: "ì‚¼ì„±",
                                path: "name"
                            }
                        }
                    },
                    { $limit: 10 }
                ],
                'scenario3-5-autocomplete': [
                    {
                        $search: {
                            index: "bigProductSearchAutocomplete",
                            autocomplete: {
                                query: "ì‚¼ì„±",
                                path: "name"
                            }
                        }
                    },
                    { $limit: 10 }
                ]
            };

            try {
                // ì—°ê²° ë¬¸ìì—´ ìµœì¢… í™•ì¸ - ë” ì—„ê²©í•˜ê²Œ
                const trimmedConnStr = connectionString.trim();
                const trimmedDbName = dbName.trim();

                console.log('ìµœì¢… ê²€ì¦:', {
                    connectionStringExists: !!trimmedConnStr,
                    connectionStringLength: trimmedConnStr.length,
                    connectionStringPrefix: trimmedConnStr.substring(0, 30),
                    dbNameExists: !!trimmedDbName,
                    dbName: trimmedDbName
                });

                if (!trimmedConnStr || trimmedConnStr === '') {
                    console.error('ì—°ê²° ë¬¸ìì—´ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.');
                    showError(resultBox, 'ì—°ê²° ë¬¸ìì—´ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.', 'ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— MongoDB Atlas ì—°ê²° ë¬¸ìì—´ì„ ì…ë ¥í•˜ì„¸ìš”.\n\ní˜„ì¬ ì…ë ¥ í•„ë“œ ê°’: "' + (connectionStringInput.value || '(ë¹„ì–´ìˆìŒ)') + '"');
                    return;
                }

                if (!trimmedConnStr.startsWith('mongodb://') && !trimmedConnStr.startsWith('mongodb+srv://')) {
                    console.error('ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤:', trimmedConnStr.substring(0, 30));
                    showError(resultBox, 'ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'ì—°ê²° ë¬¸ìì—´ì€ mongodb:// ë˜ëŠ” mongodb+srv://ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.\n\ní˜„ì¬ ê°’ì˜ ì‹œì‘ ë¶€ë¶„: "' + trimmedConnStr.substring(0, 50) + '"');
                    return;
                }

                if (trimmedConnStr.includes('localhost') || trimmedConnStr.includes('127.0.0.1') || trimmedConnStr.includes(':28000')) {
                    console.error('ì—°ê²° ë¬¸ìì—´ì— localhostê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤:', trimmedConnStr);
                    showError(resultBox, 'ì—°ê²° ë¬¸ìì—´ì— localhostê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.', 'MongoDB Atlas ì—°ê²° ë¬¸ìì—´ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤. localhost, 127.0.0.1, ë˜ëŠ” :28000ì´ í¬í•¨ëœ ì—°ê²° ë¬¸ìì—´ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

            // ìš”ì²­ ë³¸ë¬¸ ìƒì„± ì „ ìµœì¢… í™•ì¸
            if (!trimmedConnStr || trimmedConnStr === '' || trimmedConnStr.length < 20) {
                console.error('âŒ ì—°ê²° ë¬¸ìì—´ì´ ì—†ê±°ë‚˜ ë„ˆë¬´ ì§§ìŠµë‹ˆë‹¤:', {
                    exists: !!trimmedConnStr,
                    length: trimmedConnStr ? trimmedConnStr.length : 0,
                    value: trimmedConnStr ? trimmedConnStr.substring(0, 50) : 'ì—†ìŒ'
                });
                showError(resultBox, 'ì—°ê²° ë¬¸ìì—´ì´ ì—†ê±°ë‚˜ ë„ˆë¬´ ì§§ìŠµë‹ˆë‹¤.', 
                    'ì—°ê²° ë¬¸ìì—´ì„ í™•ì¸í•˜ì„¸ìš”.\n' +
                    'ê¸¸ì´: ' + (trimmedConnStr ? trimmedConnStr.length : 0) + 'ì\n' +
                    'ê°’: ' + (trimmedConnStr ? trimmedConnStr.substring(0, 50) : 'ì—†ìŒ'));
                return;
            }

            // ì—°ê²° ë¬¸ìì—´ ì¶œë ¥ ë° í™•ì¸
            console.log('='.repeat(60));
            console.log('ğŸ” ì‹œë‚˜ë¦¬ì˜¤ ì¿¼ë¦¬ ì‹¤í–‰ - ì—°ê²° ì •ë³´ í™•ì¸');
            console.log('='.repeat(60));
            console.log('ì—°ê²° ë¬¸ìì—´:', trimmedConnStr);
            console.log('ì—°ê²° ë¬¸ìì—´ ê¸¸ì´:', trimmedConnStr.length);
            console.log('ì—°ê²° ë¬¸ìì—´ ì‹œì‘:', trimmedConnStr.substring(0, 50));
            console.log('ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„:', trimmedDbName);
            console.log('ì¿¼ë¦¬ ID:', queryId);
            console.log('='.repeat(60));

            // $searchMeta ì¿¼ë¦¬ì¸ì§€ í™•ì¸
            const isSearchMeta = queryId === 'scenario3-4';
            
            // ì‹œë‚˜ë¦¬ì˜¤ 3ì€ bigProducts ì»¬ë ‰ì…˜ ì‚¬ìš©
            let collection = 'products';
            if (queryId && queryId.startsWith('scenario3')) {
                collection = 'bigProducts';
                console.log('ì‹œë‚˜ë¦¬ì˜¤ 3 ê°ì§€: bigProducts ì»¬ë ‰ì…˜ ì‚¬ìš©');
            }
            
            console.log('ì‚¬ìš©í•  ì»¬ë ‰ì…˜:', collection, 'queryId:', queryId);
            
            const requestBody = {
                connectionString: trimmedConnStr,
                dbName: trimmedDbName,
                collection: collection,
                query: queries[queryId],
                queryType: isSearchMeta ? 'aggregate' : 'aggregate'
            };

            // ìš”ì²­ ë³¸ë¬¸ ìµœì¢… ê²€ì¦ ë° ì¶œë ¥
            console.log('='.repeat(80));
            console.log('ğŸ“¤ í´ë¼ì´ì–¸íŠ¸: ì„œë²„ë¡œ ì „ì†¡í•  ìš”ì²­ ë³¸ë¬¸');
            console.log('='.repeat(80));
            console.log('ğŸ“¤ connectionString ì „ì²´:', requestBody.connectionString);
            console.log('ğŸ“¤ connectionString ì „ì²´ ê¸¸ì´:', requestBody.connectionString.length);
            console.log('ğŸ“¤ connectionString ì‹œì‘:', requestBody.connectionString.substring(0, 50));
            console.log('ğŸ“¤ connectionString ë:', requestBody.connectionString.substring(Math.max(0, requestBody.connectionString.length - 50)));
            console.log('ğŸ“¤ localhost í¬í•¨ ì—¬ë¶€:', requestBody.connectionString.includes('localhost') || requestBody.connectionString.includes('127.0.0.1') || requestBody.connectionString.includes(':28000'));
            console.log('ğŸ“¤ dbName:', requestBody.dbName);
            console.log('ğŸ“¤ collection:', requestBody.collection);
            console.log('ğŸ“¤ queryType:', requestBody.queryType);
            console.log('ğŸ“¤ JSON ì§ë ¬í™”ëœ ì „ì²´ ìš”ì²­ ë³¸ë¬¸:', JSON.stringify(requestBody));
            console.log('='.repeat(80));

                const response = await fetch('/api/execute-query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestBody)
                });

                console.log('ğŸ“¥ ì„œë²„ ì‘ë‹µ ìƒíƒœ:', response.status);
                const data = await response.json();
                console.log('ğŸ“¥ ì„œë²„ ì‘ë‹µ ë°ì´í„°:', {
                    success: data.success,
                    error: data.error,
                    hint: data.hint,
                    executionTime: data.executionTime,
                    resultCount: data.resultCount
                });
                console.log('='.repeat(60));
                
                if (data.success) {
                    // autocomplete ê²€ìƒ‰ì¸ ê²½ìš° ì„¤ëª… ì¶”ê°€
                    if (queryId === 'scenario2-1-autocomplete') {
                        const autocompleteExplanation = `
                            <div style="margin-bottom: 20px; padding: 16px; background: rgba(0, 150, 255, 0.05); border: 1px solid rgba(0, 150, 255, 0.2); border-radius: 4px;">
                                <p style="color: #0096FF; font-size: 14px; font-weight: 600; margin-bottom: 12px;">1. ì´ ê²°ê³¼ì˜ ì •ì²´ (í•œ ì¤„ ìš”ì•½)</p>
                                <p style="color: #B8C5D1; font-size: 14px; line-height: 1.6; margin-bottom: 12px;">
                                    ì´ ê²°ê³¼ëŠ” ì‚¬ìš©ìê°€ "ê°¤ëŸ­ì‹œ"ë¥¼ ì…ë ¥ ì¤‘ì¼ ë•Œ, ì œí’ˆëª…ì„ ìë™ ì™„ì„±í•˜ê¸° ìœ„í•´ prefix ê¸°ë°˜ìœ¼ë¡œ ë§¤ì¹­ëœ í›„ë³´ ëª©ë¡ì´ë‹¤.
                                </p>
                                <p style="color: #B8C5D1; font-size: 14px; line-height: 1.6; margin-top: 12px;">
                                    <strong>ì¦‰:</strong>
                                </p>
                                <ul style="color: #B8C5D1; font-size: 14px; line-height: 1.6; margin: 8px 0; padding-left: 20px;">
                                    <li style="margin: 4px 0;">"ê°€ì¥ ê´€ë ¨ ìˆëŠ” ìƒí’ˆ"ì´ ì•„ë‹ˆë¼</li>
                                    <li style="margin: 4px 0;">"ì´ ì…ë ¥ìœ¼ë¡œ ì‹œì‘í•  ìˆ˜ ìˆëŠ” ì´ë¦„ë“¤"ì˜ ì œì•ˆ ëª©ë¡</li>
                                </ul>
                            </div>
                            <div style="margin-bottom: 20px; padding: 16px; background: rgba(0, 150, 255, 0.05); border: 1px solid rgba(0, 150, 255, 0.2); border-radius: 4px;">
                                <p style="color: #0096FF; font-size: 14px; font-weight: 600; margin-bottom: 12px;">2. autocompleteì˜ í•µì‹¬ ë™ì‘ ë°©ì‹</p>
                                <p style="color: #B8C5D1; font-size: 13px; font-weight: 600; margin-bottom: 8px;">2.1 text ê²€ìƒ‰ê³¼ì˜ ê·¼ë³¸ì  ì°¨ì´</p>
                                <table style="width: 100%; border-collapse: collapse; margin-top: 8px; background: rgba(0, 0, 0, 0.2); border-radius: 4px; overflow: hidden;">
                                    <thead>
                                        <tr style="background: rgba(0, 150, 255, 0.1);">
                                            <th style="padding: 10px 12px; text-align: left; color: #0096FF; font-size: 13px; font-weight: 600; border-bottom: 1px solid rgba(0, 150, 255, 0.2);">í•­ëª©</th>
                                            <th style="padding: 10px 12px; text-align: left; color: #0096FF; font-size: 13px; font-weight: 600; border-bottom: 1px solid rgba(0, 150, 255, 0.2);">text</th>
                                            <th style="padding: 10px 12px; text-align: left; color: #0096FF; font-size: 13px; font-weight: 600; border-bottom: 1px solid rgba(0, 150, 255, 0.2);">autocomplete</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                                            <td style="padding: 10px 12px; color: #FFFFFF; font-size: 13px;">ëª©ì </td>
                                            <td style="padding: 10px 12px; color: #B8C5D1; font-size: 13px;">ì •í™•í•œ ê²€ìƒ‰</td>
                                            <td style="padding: 10px 12px; color: #B8C5D1; font-size: 13px;">ì…ë ¥ ë³´ì¡°</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                                            <td style="padding: 10px 12px; color: #FFFFFF; font-size: 13px;">ê¸°ì¤€</td>
                                            <td style="padding: 10px 12px; color: #B8C5D1; font-size: 13px;">relevance</td>
                                            <td style="padding: 10px 12px; color: #B8C5D1; font-size: 13px;">prefix ë§¤ì¹­</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                                            <td style="padding: 10px 12px; color: #FFFFFF; font-size: 13px;">í† í°í™”</td>
                                            <td style="padding: 10px 12px; color: #B8C5D1; font-size: 13px;">ì¼ë°˜ analyzer</td>
                                            <td style="padding: 10px 12px; color: #B8C5D1; font-size: 13px;">edge n-gram</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 10px 12px; color: #FFFFFF; font-size: 13px;">ì ìˆ˜ ì˜ë¯¸</td>
                                            <td style="padding: 10px 12px; color: #B8C5D1; font-size: 13px;">ì¤‘ìš”</td>
                                            <td style="padding: 10px 12px; color: #B8C5D1; font-size: 13px;">ê±°ì˜ ì˜ë¯¸ ì—†ìŒ</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        `;
                        resultBox.classList.remove('error');
                        resultBox.classList.add('success', 'show', 'collapsed');
                        resultBox.innerHTML = `
                            <div class="result-header" onclick="toggleResultBox(this)">
                                <span>ì‹¤í–‰ ì„±ê³µ (${data.executionTime}ms, ê²°ê³¼: ${data.resultCount}ê°œ)</span>
                                <span class="toggle-icon">â–¼</span>
                            </div>
                            <div class="result-content">
                                ${autocompleteExplanation}
                                <div style="margin-top: 16px;">
                                    <p style="color: #00ED64; font-size: 13px; font-weight: 600; margin-bottom: 8px;">ê²€ìƒ‰ ê²°ê³¼:</p>
                                    <pre style="background: rgba(0, 0, 0, 0.3); padding: 12px; border-radius: 4px; overflow-x: auto; font-size: 12px;">${JSON.stringify(data.result, null, 2)}</pre>
                                </div>
                            </div>
                        `;
                    } else if (queryId === 'scenario2-2') {
                        // Score í™•ì¸ ì˜ˆì œì¸ ê²½ìš° ì„¤ëª… ì¶”ê°€
                        const scoreExplanation = `
                            <div style="margin-bottom: 20px; padding: 16px; background: rgba(0, 150, 255, 0.05); border: 1px solid rgba(0, 150, 255, 0.2); border-radius: 4px;">
                                <p style="color: #0096FF; font-size: 14px; font-weight: 600; margin-bottom: 12px;">ì´ ì˜ˆì œì˜ ëª©ì :</p>
                                <p style="color: #B8C5D1; font-size: 14px; line-height: 1.6; margin-bottom: 12px;">
                                    Atlas Searchê°€ ê° ë¬¸ì„œì— ì–´ë–¤ ì ìˆ˜(score)ë¥¼ ë¶€ì—¬í–ˆê³ , ê·¸ ì ìˆ˜ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬í–ˆì„ ë•Œ ìƒìœ„ ë¬¸ì„œê°€ ë¬´ì—‡ì¸ì§€ í™•ì¸í•˜ëŠ” ë””ë²„ê¹… ì˜ˆì œ
                                </p>
                                <p style="color: #B8C5D1; font-size: 14px; line-height: 1.6; margin-bottom: 12px; margin-top: 16px;">
                                    <strong>ìŠ¤ì½”ì–´ë§ ë°©ì‹:</strong> Atlas SearchëŠ” ë‚´ë¶€ì ìœ¼ë¡œ Lucene BM25 ê³„ì—´ ìŠ¤ì½”ì–´ë§ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
                                </p>
                                <p style="color: #B8C5D1; font-size: 14px; line-height: 1.6; margin-bottom: 12px;">
                                    ì¦‰, scoreëŠ” ë‹¤ìŒ ìš”ì†Œë“¤ì˜ ì¡°í•© ê²°ê³¼ì…ë‹ˆë‹¤.
                                </p>
                                <table style="width: 100%; border-collapse: collapse; margin-top: 12px; background: rgba(0, 0, 0, 0.2); border-radius: 4px; overflow: hidden;">
                                    <thead>
                                        <tr style="background: rgba(0, 237, 100, 0.1);">
                                            <th style="padding: 10px 12px; text-align: left; color: #00ED64; font-size: 13px; font-weight: 600; border-bottom: 1px solid rgba(0, 237, 100, 0.2);">ìš”ì†Œ</th>
                                            <th style="padding: 10px 12px; text-align: left; color: #00ED64; font-size: 13px; font-weight: 600; border-bottom: 1px solid rgba(0, 237, 100, 0.2);">ì˜í–¥</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                                            <td style="padding: 10px 12px; color: #FFFFFF; font-size: 13px;">í† í° ë§¤ì¹­ ì—¬ë¶€</td>
                                            <td style="padding: 10px 12px; color: #B8C5D1; font-size: 13px;">ê¸°ë³¸ ì¡°ê±´</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                                            <td style="padding: 10px 12px; color: #FFFFFF; font-size: 13px;">í† í° ìœ„ì¹˜</td>
                                            <td style="padding: 10px 12px; color: #B8C5D1; font-size: 13px;">ì•ì— ìˆì„ìˆ˜ë¡ ìœ ë¦¬</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                                            <td style="padding: 10px 12px; color: #FFFFFF; font-size: 13px;">í•„ë“œ ê¸¸ì´</td>
                                            <td style="padding: 10px 12px; color: #B8C5D1; font-size: 13px;">ì§§ì„ìˆ˜ë¡ ìœ ë¦¬</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                                            <td style="padding: 10px 12px; color: #FFFFFF; font-size: 13px;">ë‹¤ë¥¸ í† í°ê³¼ì˜ ì¡°í•©</td>
                                            <td style="padding: 10px 12px; color: #B8C5D1; font-size: 13px;">ë¬¸ë§¥ì  ê´€ë ¨ì„±</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 10px 12px; color: #FFFFFF; font-size: 13px;">ì „ì²´ ë¬¸ì„œ ëŒ€ë¹„ í¬ì†Œì„±</td>
                                            <td style="padding: 10px 12px; color: #B8C5D1; font-size: 13px;">í”í• ìˆ˜ë¡ ë¶ˆë¦¬</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        `;
                        resultBox.classList.remove('error');
                        resultBox.classList.add('success', 'show', 'collapsed');
                        resultBox.innerHTML = `
                            <div class="result-header" onclick="toggleResultBox(this)">
                                <span>ì‹¤í–‰ ì„±ê³µ (${data.executionTime}ms, ê²°ê³¼: ${data.resultCount}ê°œ)</span>
                                <span class="toggle-icon">â–¼</span>
                            </div>
                            <div class="result-content">
                                ${scoreExplanation}
                                <div style="margin-top: 16px;">
                                    <p style="color: #00ED64; font-size: 13px; font-weight: 600; margin-bottom: 8px;">ê²€ìƒ‰ ê²°ê³¼ (score ê¸°ì¤€ ì •ë ¬):</p>
                                    <pre style="background: rgba(0, 0, 0, 0.3); padding: 12px; border-radius: 4px; overflow-x: auto; font-size: 12px;">${JSON.stringify(data.result, null, 2)}</pre>
                                </div>
                            </div>
                        `;
                    } else {
                        showSuccess(resultBox, data.result, data.executionTime, data.resultCount);
                    }
                } else {
                    showError(resultBox, data.error, data.hint);
                }
            } catch (error) {
                console.error('âŒ ìš”ì²­ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                console.log('='.repeat(60));
                showError(resultBox, 'ì„œë²„ì™€ í†µì‹ í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        async function executeGetIndexes(collection) {
            // localStorageì—ì„œ ë¨¼ì € ì½ê¸°
            let connectionString = localStorage.getItem('atlasDemoConnectionString');
            let dbName = localStorage.getItem('atlasDemoDbName');
            
            // ì—†ìœ¼ë©´ ì…ë ¥ í•„ë“œì—ì„œ ì½ê¸°
            const connectionStringInput = document.getElementById('connectionString');
            const dbNameInput = document.getElementById('dbName');
            
            if (!connectionString && connectionStringInput) {
                connectionString = connectionStringInput.value.trim();
            }
            if (!dbName && dbNameInput) {
                dbName = dbNameInput.value.trim();
            }
            
            connectionString = connectionString ? connectionString.trim() : '';
            dbName = dbName ? dbName.trim() : '';
            
            // í˜¸ì¶œí•œ ë²„íŠ¼ í™•ì¸
            const event = window.event || arguments[0];
            const isCheckButton = event && event.target && event.target.textContent && event.target.textContent.includes('ì¸ë±ìŠ¤ ìƒì„± í™•ì¸');
            const resultBox = document.getElementById(isCheckButton ? `result-indexes-${collection}-check` : `result-indexes-${collection}`);
            
            if (!connectionString || !dbName) {
                showError(resultBox, 'ì—°ê²° ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.', 'ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— MongoDB Atlas ì—°ê²° ë¬¸ìì—´ê³¼ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì—°ê²° ë¬¸ìì—´ í˜•ì‹ ê²€ì¦
            if (!connectionString.startsWith('mongodb://') && !connectionString.startsWith('mongodb+srv://')) {
                showError(resultBox, 'ì˜¬ë°”ë¥¸ ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.', 'ì—°ê²° ë¬¸ìì—´ì€ mongodb:// ë˜ëŠ” mongodb+srv://ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            resultBox.classList.remove('show', 'success', 'error');
            resultBox.classList.add('show');
            resultBox.innerHTML = '<div class="result-header">ì‹¤í–‰ ì¤‘...</div><div class="loading"></div>';

            try {
                const response = await fetch('/api/execute-query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        connectionString,
                        dbName,
                        collection: collection,
                        query: null,
                        queryType: 'getSearchIndexes'
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    // Index ëª©ë¡ì´ ë¹„ì–´ìˆìœ¼ë©´ ì•ˆë‚´ ë©”ì‹œì§€ ì¶”ê°€
                    if (Array.isArray(data.result) && data.result.length === 0) {
                        showSuccess(resultBox, data.result, data.executionTime, data.resultCount);
                        // ê²°ê³¼ ë°•ìŠ¤ì— ì¶”ê°€ ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ
                        setTimeout(() => {
                            const resultBoxContent = resultBox.innerHTML;
                            resultBox.innerHTML = resultBoxContent + 
                                '<div style="margin-top: 12px; padding: 12px; background: rgba(255, 193, 7, 0.1); border-left: 3px solid #FFC107; border-radius: 4px;">' +
                                '<p style="color: #FFC107; margin: 0; font-size: 14px;"><strong>âš ï¸ Search Indexê°€ ì—†ìŠµë‹ˆë‹¤.</strong></p>' +
                                '<p style="color: #B8C5D1; margin: 8px 0 0 0; font-size: 13px;">ì•„ë˜ "í•´ê²° ë°©ë²• 2"ì—ì„œ Index ìƒì„± ë°©ë²•ì„ í™•ì¸í•˜ì„¸ìš”.</p>' +
                                '</div>';
                        }, 100);
                    } else {
                        showSuccess(resultBox, data.result, data.executionTime, data.resultCount);
                    }
                } else {
                    // ì—ëŸ¬ê°€ ë°œìƒí•´ë„ Indexê°€ ì—†ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ
                    if (data.error && data.error.includes('getSearchIndexes')) {
                        showError(resultBox, 'Index ëª©ë¡ì„ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 
                            'MongoDB ë“œë¼ì´ë²„ ë²„ì „ ë¬¸ì œë¡œ Index ëª©ë¡ì„ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\n' +
                            'ëŒ€ì‹  MongoDB Atlas UIì—ì„œ ì§ì ‘ í™•ì¸í•˜ì„¸ìš”:\n' +
                            '1. Atlas ì½˜ì†” â†’ Search â†’ Indexes\n' +
                            '2. Indexê°€ ì—†ìœ¼ë©´ "í•´ê²° ë°©ë²• 2"ì—ì„œ Index ìƒì„± ë°©ë²•ì„ í™•ì¸í•˜ì„¸ìš”.');
                    } else {
                        showError(resultBox, data.error, data.hint);
                    }
                }
            } catch (error) {
                console.error('âŒ ìš”ì²­ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                console.log('='.repeat(60));
                showError(resultBox, 'ì„œë²„ì™€ í†µì‹ í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        async function executeGetIndexesForExample5(collection) {
            // localStorageì—ì„œ ë¨¼ì € ì½ê¸°
            let connectionString = localStorage.getItem('atlasDemoConnectionString');
            let dbName = localStorage.getItem('atlasDemoDbName');
            
            // ì—†ìœ¼ë©´ ì…ë ¥ í•„ë“œì—ì„œ ì½ê¸°
            const connectionStringInput = document.getElementById('connectionString');
            const dbNameInput = document.getElementById('dbName');
            
            if (!connectionString && connectionStringInput) {
                connectionString = connectionStringInput.value.trim();
            }
            if (!dbName && dbNameInput) {
                dbName = dbNameInput.value.trim();
            }
            
            connectionString = connectionString ? connectionString.trim() : '';
            dbName = dbName ? dbName.trim() : '';
            
            // ì˜ˆì œ 5 ì „ìš© ê²°ê³¼ ë°•ìŠ¤ ID ì‚¬ìš©
            const resultBox = document.getElementById('result-indexes-bigProducts-example5');
            
            if (!connectionString || !dbName) {
                showError(resultBox, 'ì—°ê²° ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.', 'ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— MongoDB Atlas ì—°ê²° ë¬¸ìì—´ê³¼ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì—°ê²° ë¬¸ìì—´ í˜•ì‹ ê²€ì¦
            if (!connectionString.startsWith('mongodb://') && !connectionString.startsWith('mongodb+srv://')) {
                showError(resultBox, 'ì˜¬ë°”ë¥¸ ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.', 'ì—°ê²° ë¬¸ìì—´ì€ mongodb:// ë˜ëŠ” mongodb+srv://ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            resultBox.classList.remove('show', 'success', 'error');
            resultBox.classList.add('show');
            resultBox.innerHTML = '<div class="result-header">ì‹¤í–‰ ì¤‘...</div><div class="loading"></div>';

            try {
                const response = await fetch('/api/execute-query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        connectionString,
                        dbName,
                        collection: collection,
                        query: null,
                        queryType: 'getSearchIndexes'
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    // Index ëª©ë¡ì´ ë¹„ì–´ìˆìœ¼ë©´ ì•ˆë‚´ ë©”ì‹œì§€ ì¶”ê°€
                    if (Array.isArray(data.result) && data.result.length === 0) {
                        showSuccess(resultBox, data.result, data.executionTime, data.resultCount);
                        // ê²°ê³¼ ë°•ìŠ¤ì— ì¶”ê°€ ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ
                        setTimeout(() => {
                            const resultBoxContent = resultBox.innerHTML;
                            resultBox.innerHTML = resultBoxContent + 
                                '<div style="margin-top: 12px; padding: 12px; background: rgba(255, 193, 7, 0.1); border-left: 3px solid #FFC107; border-radius: 4px;">' +
                                '<p style="color: #FFC107; margin: 0; font-size: 14px;"><strong>âš ï¸ Search Indexê°€ ì—†ìŠµë‹ˆë‹¤.</strong></p>' +
                                '<p style="color: #B8C5D1; margin: 8px 0 0 0; font-size: 13px;">ì•„ë˜ "Index ìƒì„±" ì„¹ì…˜ì—ì„œ Index ìƒì„± ë°©ë²•ì„ í™•ì¸í•˜ì„¸ìš”.</p>' +
                                '</div>';
                        }, 100);
                    } else {
                        showSuccess(resultBox, data.result, data.executionTime, data.resultCount);
                    }
                } else {
                    // ì—ëŸ¬ê°€ ë°œìƒí•´ë„ Indexê°€ ì—†ì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ
                    if (data.error && data.error.includes('getSearchIndexes')) {
                        showError(resultBox, 'Index ëª©ë¡ì„ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 
                            'MongoDB ë“œë¼ì´ë²„ ë²„ì „ ë¬¸ì œë¡œ Index ëª©ë¡ì„ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\n' +
                            'ëŒ€ì‹  MongoDB Atlas UIì—ì„œ ì§ì ‘ í™•ì¸í•˜ì„¸ìš”:\n' +
                            '1. Atlas ì½˜ì†” â†’ Search â†’ Indexes\n' +
                            '2. Indexê°€ ì—†ìœ¼ë©´ ì•„ë˜ "Index ìƒì„±" ì„¹ì…˜ì—ì„œ Index ìƒì„± ë°©ë²•ì„ í™•ì¸í•˜ì„¸ìš”.');
                    } else {
                        showError(resultBox, data.error, data.hint);
                    }
                }
            } catch (error) {
                console.error('âŒ ìš”ì²­ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                console.log('='.repeat(60));
                showError(resultBox, 'ì„œë²„ì™€ í†µì‹ í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        async function executeFind(collection, query) {
            // localStorageì—ì„œ ë¨¼ì € ì½ê¸°
            let connectionString = localStorage.getItem('atlasDemoConnectionString');
            let dbName = localStorage.getItem('atlasDemoDbName');
            
            console.log('1. [executeFind] localStorageì—ì„œ ì½ì€ ê°’:', {
                connectionString: connectionString ? connectionString.substring(0, 30) + '...' : 'ì—†ìŒ',
                connectionStringLength: connectionString ? connectionString.length : 0,
                dbName: dbName || 'ì—†ìŒ'
            });
            
            // ì—†ìœ¼ë©´ ì…ë ¥ í•„ë“œì—ì„œ ì½ê¸°
            const connectionStringInput = document.getElementById('connectionString');
            const dbNameInput = document.getElementById('dbName');
            
            if (!connectionString && connectionStringInput) {
                connectionString = connectionStringInput.value.trim();
                console.log('2. [executeFind] ì…ë ¥ í•„ë“œì—ì„œ ì½ì€ ê°’:', {
                    connectionString: connectionString ? connectionString.substring(0, 30) + '...' : 'ì—†ìŒ',
                    connectionStringLength: connectionString ? connectionString.length : 0
                });
            }
            if (!dbName && dbNameInput) {
                dbName = dbNameInput.value.trim();
            }
            
            // ìµœì¢…ì ìœ¼ë¡œ ì‚¬ìš©í•  ì—°ê²° ì •ë³´
            connectionString = connectionString ? connectionString.trim() : '';
            dbName = dbName ? dbName.trim() : '';
            
            const resultBox = document.getElementById(`result-scenario5-1`);
            
            console.log('3. [executeFind] ìµœì¢… ì‚¬ìš©í•  ì—°ê²° ì •ë³´:', { 
                connectionStringExists: !!connectionString,
                connectionStringLength: connectionString.length,
                connectionStringPreview: connectionString ? connectionString.substring(0, 50) + '...' : 'ë¹„ì–´ìˆìŒ',
                connectionStringStartsWith: connectionString ? (connectionString.startsWith('mongodb://') || connectionString.startsWith('mongodb+srv://')) : false,
                dbName: dbName || 'ë¹„ì–´ìˆìŒ',
                collection: collection
            });
            
            // ì—°ê²° ë¬¸ìì—´ ê²€ì¦
            if (!connectionString || connectionString === '') {
                const errorMsg = 'ì—°ê²° ë¬¸ìì—´ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.';
                const hintMsg = 'ì—°ê²° ë¬¸ìì—´ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\n' +
                    'í•´ê²° ë°©ë²•:\n' +
                    '1. ë©”ì¸ í˜ì´ì§€(/)ë¡œ ì´ë™í•˜ì—¬ ìƒ˜í”Œ ë°ì´í„°ë¥¼ ë¡œë”©í•˜ì„¸ìš”.\n' +
                    '2. ë˜ëŠ” ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— MongoDB Atlas ì—°ê²° ë¬¸ìì—´ì„ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”.\n\n' +
                    'localStorage ê°’: ' + (localStorage.getItem('atlasDemoConnectionString') ? 'ìˆìŒ' : 'ì—†ìŒ') + '\n' +
                    'ì…ë ¥ í•„ë“œ ê°’: ' + (connectionStringInput && connectionStringInput.value ? 'ìˆìŒ' : 'ì—†ìŒ');
                console.error('âŒ [executeFind]', errorMsg, { 
                    localStorageValue: localStorage.getItem('atlasDemoConnectionString') ? 'ìˆìŒ' : 'ì—†ìŒ',
                    inputFieldValue: connectionStringInput ? connectionStringInput.value : 'í•„ë“œ ì—†ìŒ'
                });
                showError(resultBox, errorMsg, hintMsg);
                return;
            }

            if (!dbName || dbName === '') {
                showError(resultBox, 'ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.', 'ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì—°ê²° ë¬¸ìì—´ í˜•ì‹ ê²€ì¦
            if (!connectionString.startsWith('mongodb://') && !connectionString.startsWith('mongodb+srv://')) {
                const errorMsg = 'ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                const hintMsg = 'ì—°ê²° ë¬¸ìì—´ì€ mongodb:// ë˜ëŠ” mongodb+srv://ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.\n\n' +
                    'í˜„ì¬ ê°’ì˜ ì‹œì‘ ë¶€ë¶„: "' + connectionString.substring(0, 50) + '"\n' +
                    'ì „ì²´ ê¸¸ì´: ' + connectionString.length + 'ì';
                console.error('[executeFind]', errorMsg, { connectionString: connectionString.substring(0, 100) });
                showError(resultBox, errorMsg, hintMsg);
                return;
            }

            if (connectionString.includes('localhost') || connectionString.includes('127.0.0.1') || connectionString.includes(':28000')) {
                const errorMsg = 'ì—°ê²° ë¬¸ìì—´ì— localhostê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.';
                const hintMsg = 'MongoDB Atlas ì—°ê²° ë¬¸ìì—´ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.\n\n' +
                    'localhost, 127.0.0.1, ë˜ëŠ” :28000ì´ í¬í•¨ëœ ì—°ê²° ë¬¸ìì—´ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n' +
                    'í˜„ì¬ ì—°ê²° ë¬¸ìì—´: ' + connectionString.substring(0, 100);
                console.error('[executeFind]', errorMsg, { connectionString: connectionString.substring(0, 100) });
                showError(resultBox, errorMsg, hintMsg);
                return;
            }

            resultBox.classList.remove('show', 'success', 'error');
            resultBox.classList.add('show');
            resultBox.innerHTML = `
                <div class="result-header">ì‹¤í–‰ ì¤‘...</div>
                <div style="margin-top: 12px; padding: 12px; background: rgba(0, 0, 0, 0.3); border-radius: 4px; font-size: 12px; font-family: monospace;">
                    <div style="color: #B8C5D1; margin-bottom: 4px;">ì—°ê²° ë¬¸ìì—´:</div>
                    <div style="color: #00ED64; word-break: break-all;">${connectionString.substring(0, 80)}...</div>
                    <div style="color: #B8C5D1; margin-top: 8px;">ë°ì´í„°ë² ì´ìŠ¤: ${dbName}</div>
                </div>
                <div class="loading"></div>
            `;

            try {
                // ì—°ê²° ë¬¸ìì—´ ìµœì¢… í™•ì¸
                const trimmedConnStr = connectionString.trim();
                const trimmedDbName = dbName.trim();

                console.log('='.repeat(60));
                console.log('ğŸ” [executeFind] ì¿¼ë¦¬ ì‹¤í–‰ - ì—°ê²° ì •ë³´ í™•ì¸');
                console.log('='.repeat(60));
                console.log('ì—°ê²° ë¬¸ìì—´:', trimmedConnStr);
                console.log('ì—°ê²° ë¬¸ìì—´ ê¸¸ì´:', trimmedConnStr.length);
                console.log('ì—°ê²° ë¬¸ìì—´ ì‹œì‘:', trimmedConnStr.substring(0, 50));
                console.log('ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„:', trimmedDbName);
                console.log('ì»¬ë ‰ì…˜:', collection);
                console.log('ì¿¼ë¦¬:', JSON.stringify(query, null, 2));
                console.log('='.repeat(60));

                const requestBody = {
                    connectionString: trimmedConnStr,
                    dbName: trimmedDbName,
                    collection: collection,
                    query: query,
                    queryType: 'find'
                };

                console.log('ğŸ“¤ [executeFind] ì„œë²„ë¡œ ì „ì†¡í•  ìš”ì²­ ë³¸ë¬¸:');
                console.log('  - connectionString:', requestBody.connectionString.substring(0, 50) + '...');
                console.log('  - connectionString ì „ì²´ ê¸¸ì´:', requestBody.connectionString.length);
                console.log('  - dbName:', requestBody.dbName);
                console.log('  - collection:', requestBody.collection);
                console.log('  - queryType:', requestBody.queryType);
                console.log('  - query:', JSON.stringify(requestBody.query, null, 2));

                const response = await fetch('/api/execute-query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestBody)
                });

                console.log('ğŸ“¥ [executeFind] ì„œë²„ ì‘ë‹µ ìƒíƒœ:', response.status);
                console.log('ğŸ“¥ [executeFind] ì„œë²„ ì‘ë‹µ í—¤ë”:', Object.fromEntries(response.headers.entries()));

                const data = await response.json();
                
                console.log('ğŸ“¥ [executeFind] ì„œë²„ ì‘ë‹µ ë°ì´í„°:', {
                    success: data.success,
                    resultCount: data.resultCount,
                    executionTime: data.executionTime,
                    error: data.error || 'ì—†ìŒ',
                    hint: data.hint || 'ì—†ìŒ'
                });
                console.log('='.repeat(60));
                
                if (data.success) {
                    showSuccess(resultBox, data.result, data.executionTime, data.resultCount);
                } else {
                    showError(resultBox, data.error, data.hint);
                }
            } catch (error) {
                console.error('âŒ [executeFind] ìš”ì²­ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                console.log('='.repeat(60));
                showError(resultBox, 'ì„œë²„ì™€ í†µì‹ í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        function showSuccess(resultBox, result, executionTime, resultCount) {
            resultBox.classList.remove('error');
            resultBox.classList.add('success', 'show', 'collapsed');
            resultBox.innerHTML = `
                <div class="result-header" onclick="toggleResultBox(this)">
                    <span>ì‹¤í–‰ ì„±ê³µ (${executionTime}ms, ê²°ê³¼: ${resultCount}ê°œ)</span>
                    <span class="toggle-icon">â–¼</span>
                </div>
                <div class="result-content">
                    <pre>${JSON.stringify(result, null, 2)}</pre>
                </div>
            `;
        }

        function showError(resultBox, error, hint) {
            resultBox.classList.remove('success');
            resultBox.classList.add('error', 'show', 'collapsed');
            resultBox.innerHTML = `
                <div class="result-header" onclick="toggleResultBox(this)">
                    <span>ì˜¤ë¥˜ ë°œìƒ</span>
                    <span class="toggle-icon">â–¼</span>
                </div>
                <div class="result-content">
                    <p style="color: #FF5252; margin: 8px 0;">${error}</p>
                    ${hint ? `<p style="color: #B8C5D1; font-size: 13px; margin-top: 8px;">${hint}</p>` : ''}
                </div>
            `;
        }

        function toggleResultBox(header) {
            const resultBox = header.closest('.result-box');
            if (resultBox) {
                resultBox.classList.toggle('collapsed');
            }
        }

        async function checkIndexStatus(collection, indexName) {
            // localStorageì—ì„œ ë¨¼ì € ì½ê¸°
            let connectionString = localStorage.getItem('atlasDemoConnectionString');
            let dbName = localStorage.getItem('atlasDemoDbName');
            
            // ì—†ìœ¼ë©´ ì…ë ¥ í•„ë“œì—ì„œ ì½ê¸°
            const connectionStringInput = document.getElementById('connectionString');
            const dbNameInput = document.getElementById('dbName');
            
            if (!connectionString && connectionStringInput) {
                connectionString = connectionStringInput.value.trim();
            }
            if (!dbName && dbNameInput) {
                dbName = dbNameInput.value.trim();
            }
            
            connectionString = connectionString ? connectionString.trim() : '';
            dbName = dbName ? dbName.trim() : '';
            
            const resultBox = document.getElementById(`result-indexes-${collection}-check`);
            
            if (!connectionString || !dbName) {
                showError(resultBox, 'ì—°ê²° ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.', 'ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— MongoDB Atlas ì—°ê²° ë¬¸ìì—´ê³¼ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì—°ê²° ë¬¸ìì—´ í˜•ì‹ ê²€ì¦
            if (!connectionString.startsWith('mongodb://') && !connectionString.startsWith('mongodb+srv://')) {
                showError(resultBox, 'ì˜¬ë°”ë¥¸ ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.', 'ì—°ê²° ë¬¸ìì—´ì€ mongodb:// ë˜ëŠ” mongodb+srv://ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            if (connectionString.includes('localhost') || connectionString.includes('127.0.0.1') || connectionString.includes(':28000')) {
                showError(resultBox, 'ì—°ê²° ë¬¸ìì—´ì— localhostê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.', 'MongoDB Atlas ì—°ê²° ë¬¸ìì—´ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            resultBox.classList.remove('show', 'success', 'error');
            resultBox.classList.add('show');
            resultBox.innerHTML = '<div class="result-header">ì¸ë±ìŠ¤ ìƒíƒœ í™•ì¸ ì¤‘...</div><div class="loading"></div>';

            try {
                const response = await fetch('/api/execute-query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        connectionString,
                        dbName,
                        collection: collection,
                        query: null,
                        queryType: 'getSearchIndexes'
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    const indexList = Array.isArray(data.result) ? data.result : [];
                    
                    if (indexList.length === 0) {
                        // Indexê°€ ì—†ê±°ë‚˜ ì¡°íšŒì— ì‹¤íŒ¨í•œ ê²½ìš°
                        resultBox.classList.remove('success');
                        resultBox.classList.add('error', 'show', 'collapsed');
                        resultBox.innerHTML = `
                            <div class="result-header" onclick="toggleResultBox(this)">
                                <span>ì¸ë±ìŠ¤ ìƒíƒœ í™•ì¸ ì™„ë£Œ</span>
                                <span class="toggle-icon">â–¼</span>
                            </div>
                            <div class="result-content">
                                <p style="color: #FF5252; margin: 8px 0; font-size: 16px; font-weight: bold;">âŒ Indexê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                                <p style="color: #B8C5D1; margin: 8px 0; font-size: 14px;">ì•„ë˜ "í•´ê²° ë°©ë²• 2"ì—ì„œ Index ìƒì„± ë°©ë²•ì„ í™•ì¸í•˜ì„¸ìš”.</p>
                                <p style="color: #7A8B99; margin: 8px 0; font-size: 12px;">ì°¸ê³ : Indexê°€ ìƒì„± ì¤‘ì´ë©´ Atlas UIì—ì„œ í™•ì¸í•˜ì„¸ìš”. Index ìƒì„±ì€ ëª‡ ë¶„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                            </div>
                        `;
                    } else {
                        // Index ëª©ë¡ ì „ì²´ í‘œì‹œ
                        let indexListHTML = '<div style="margin-top: 12px;">';
                        let targetIndexFound = false;
                        
                        indexList.forEach((idx, index) => {
                            // ì¸ë±ìŠ¤ ìƒíƒœ í™•ì¸ (ì—¬ëŸ¬ í•„ë“œ í™•ì¸)
                            let status = 'ì•Œ ìˆ˜ ì—†ìŒ';
                            if (idx.status) {
                                status = idx.status; // READY, BUILDING, FAILED, PENDING ë“±
                            } else if (idx.queryable === true) {
                                status = 'READY';
                            } else if (idx.queryable === false) {
                                status = 'BUILDING';
                            } else if (idx.latestDefinition) {
                                // latestDefinitionì´ ìˆìœ¼ë©´ ìƒì„± ì¤‘ì¼ ìˆ˜ ìˆìŒ
                                status = 'BUILDING';
                            }
                            
                            const statusColor = status === 'READY' ? '#00ED64' : 
                                                status === 'BUILDING' || status === 'PENDING' ? '#FFC107' : 
                                                status === 'FAILED' ? '#FF5252' : '#B8C5D1';
                            const statusIcon = status === 'READY' ? 'âœ…' : 
                                              status === 'BUILDING' || status === 'PENDING' ? 'â³' : 
                                              status === 'FAILED' ? 'âŒ' : 'â“';
                            
                            if (idx.name === indexName) {
                                targetIndexFound = true;
                            }
                            
                            indexListHTML += `
                                <div style="margin-bottom: 16px; padding: 12px; background: rgba(0, 0, 0, 0.2); border-radius: 4px; border-left: 3px solid ${statusColor};">
                                    <p style="color: ${statusColor}; margin: 0 0 8px 0; font-size: 15px; font-weight: bold;">
                                        ${statusIcon} <strong>${idx.name || 'ì´ë¦„ ì—†ìŒ'}</strong> - ìƒíƒœ: <strong>${status}</strong>
                                    </p>
                                    ${status === 'READY' ? 
                                        '<p style="color: #00ED64; margin: 4px 0; font-size: 13px;">âœ… Indexê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤. ê²€ìƒ‰ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>' :
                                        status === 'BUILDING' || status === 'PENDING' ?
                                        '<p style="color: #FFC107; margin: 4px 0; font-size: 13px;">â³ Indexê°€ ìƒì„± ì¤‘ì…ë‹ˆë‹¤. ëª‡ ë¶„ í›„ ë‹¤ì‹œ í™•ì¸í•˜ì„¸ìš”. (ì´ë¦„: ' + (idx.name || 'ì•Œ ìˆ˜ ì—†ìŒ') + ', ìƒíƒœ: ' + status + ')</p>' :
                                        status === 'FAILED' ?
                                        '<p style="color: #FF5252; margin: 4px 0; font-size: 13px;">âŒ Index ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. Atlas UIì—ì„œ í™•ì¸í•˜ì„¸ìš”.</p>' :
                                        '<p style="color: #B8C5D1; margin: 4px 0; font-size: 13px;">â“ Index ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ì´ë¦„: ' + (idx.name || 'ì•Œ ìˆ˜ ì—†ìŒ') + ')</p>'
                                    }
                                    <details style="margin-top: 8px;">
                                        <summary style="color: #B8C5D1; font-size: 12px; cursor: pointer;">ìƒì„¸ ì •ë³´ ë³´ê¸°</summary>
                                        <pre style="margin-top: 8px; padding: 8px; background: rgba(0, 0, 0, 0.3); border-radius: 4px; font-size: 11px; overflow-x: auto;">${JSON.stringify(idx, null, 2)}</pre>
                                    </details>
                                </div>
                            `;
                        });
                        
                        indexListHTML += '</div>';
                        
                        resultBox.classList.remove('error');
                        resultBox.classList.add('success', 'show', 'collapsed');
                        resultBox.innerHTML = `
                            <div class="result-header" onclick="toggleResultBox(this)">
                                <span>ì¸ë±ìŠ¤ ëª©ë¡ ë° ìƒíƒœ í™•ì¸ ì™„ë£Œ</span>
                                <span class="toggle-icon">â–¼</span>
                            </div>
                            <div class="result-content">
                                <p style="color: #B8C5D1; margin: 8px 0; font-size: 14px;">ì´ <strong>${indexList.length}</strong>ê°œì˜ Indexê°€ ìˆìŠµë‹ˆë‹¤.</p>
                                ${targetIndexFound ? 
                                    `<p style="color: #00ED64; margin: 8px 0; font-size: 14px;">âœ… ì°¾ê³  ìˆëŠ” Index '${indexName}'ê°€ ëª©ë¡ì— ìˆìŠµë‹ˆë‹¤.</p>` :
                                    indexName ? 
                                    `<p style="color: #FFC107; margin: 8px 0; font-size: 14px;">âš ï¸ ì°¾ê³  ìˆëŠ” Index '${indexName}'ê°€ ëª©ë¡ì— ì—†ìŠµë‹ˆë‹¤. Index ì´ë¦„ì„ í™•ì¸í•˜ì„¸ìš”.</p>` :
                                    ''
                                }
                                ${indexListHTML}
                            </div>
                        `;
                    }
                } else {
                    // ì—ëŸ¬ê°€ ë°œìƒí•œ ê²½ìš°
                    let errorMessage = data.error || 'Index ëª©ë¡ì„ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                    let errorHint = data.hint || '';
                    
                    if (data.error && (data.error.includes('getSearchIndexes') || data.error.includes('Search Index'))) {
                        errorHint = 'MongoDB ë“œë¼ì´ë²„ë¥¼ í†µí•œ Index ëª©ë¡ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\n' +
                            'ê°€ëŠ¥í•œ ì›ì¸:\n' +
                            '1. Indexê°€ ì•„ì§ ìƒì„±ë˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n' +
                            '2. Indexê°€ ìƒì„± ì¤‘(BUILDING)ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n' +
                            '3. MongoDB ë“œë¼ì´ë²„ ë²„ì „ ë¬¸ì œì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n' +
                            'í•´ê²° ë°©ë²•:\n' +
                            '1. MongoDB Atlas UIì—ì„œ ì§ì ‘ í™•ì¸í•˜ì„¸ìš”:\n' +
                            '   - Atlas ì½˜ì†” â†’ Search â†’ Indexes\n' +
                            '   - Index ì´ë¦„ê³¼ ìƒíƒœë¥¼ í™•ì¸í•˜ì„¸ìš”\n' +
                            '2. Indexê°€ BUILDING ìƒíƒœë©´ ëª‡ ë¶„ í›„ ë‹¤ì‹œ í™•ì¸í•˜ì„¸ìš”.\n' +
                            '3. Indexê°€ ì—†ìœ¼ë©´ "í•´ê²° ë°©ë²• 2"ì—ì„œ Index ìƒì„± ë°©ë²•ì„ í™•ì¸í•˜ì„¸ìš”.';
                    }
                    
                    resultBox.classList.remove('success');
                    resultBox.classList.add('error', 'show', 'collapsed');
                    resultBox.innerHTML = `
                        <div class="result-header" onclick="toggleResultBox(this)">
                            <span>ì¸ë±ìŠ¤ ìƒíƒœ í™•ì¸ ì™„ë£Œ</span>
                            <span class="toggle-icon">â–¼</span>
                        </div>
                        <div class="result-content">
                            <p style="color: #FF5252; margin: 8px 0; font-size: 16px; font-weight: bold;">âŒ ${errorMessage}</p>
                            <p style="color: #B8C5D1; margin: 8px 0; font-size: 14px; white-space: pre-line;">${errorHint}</p>
                            <p style="color: #7A8B99; margin: 8px 0; font-size: 12px; margin-top: 12px;">ğŸ’¡ íŒ: Indexê°€ ìƒì„± ì¤‘ì´ë©´ Atlas UIì—ì„œ ì´ë¦„ê³¼ ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('âŒ ì¸ë±ìŠ¤ ìƒíƒœ í™•ì¸ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                showError(resultBox, 'ì„œë²„ì™€ í†µì‹ í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        async function checkIndexStatusForExample5(collection, indexName) {
            // localStorageì—ì„œ ë¨¼ì € ì½ê¸°
            let connectionString = localStorage.getItem('atlasDemoConnectionString');
            let dbName = localStorage.getItem('atlasDemoDbName');
            
            // ì—†ìœ¼ë©´ ì…ë ¥ í•„ë“œì—ì„œ ì½ê¸°
            const connectionStringInput = document.getElementById('connectionString');
            const dbNameInput = document.getElementById('dbName');
            
            if (!connectionString && connectionStringInput) {
                connectionString = connectionStringInput.value.trim();
            }
            if (!dbName && dbNameInput) {
                dbName = dbNameInput.value.trim();
            }
            
            connectionString = connectionString ? connectionString.trim() : '';
            dbName = dbName ? dbName.trim() : '';
            
            // ì˜ˆì œ 5 ì „ìš© ê²°ê³¼ ë°•ìŠ¤ ID ì‚¬ìš©
            const resultBox = document.getElementById('result-indexes-bigProducts-autocomplete-check');
            
            if (!connectionString || !dbName) {
                showError(resultBox, 'ì—°ê²° ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.', 'ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— MongoDB Atlas ì—°ê²° ë¬¸ìì—´ê³¼ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì—°ê²° ë¬¸ìì—´ í˜•ì‹ ê²€ì¦
            if (!connectionString.startsWith('mongodb://') && !connectionString.startsWith('mongodb+srv://')) {
                showError(resultBox, 'ì˜¬ë°”ë¥¸ ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.', 'ì—°ê²° ë¬¸ìì—´ì€ mongodb:// ë˜ëŠ” mongodb+srv://ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            if (connectionString.includes('localhost') || connectionString.includes('127.0.0.1') || connectionString.includes(':28000')) {
                showError(resultBox, 'ì—°ê²° ë¬¸ìì—´ì— localhostê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.', 'MongoDB Atlas ì—°ê²° ë¬¸ìì—´ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            resultBox.classList.remove('show', 'success', 'error');
            resultBox.classList.add('show');
            resultBox.innerHTML = '<div class="result-header">ì¸ë±ìŠ¤ ìƒíƒœ í™•ì¸ ì¤‘...</div><div class="loading"></div>';

            try {
                const response = await fetch('/api/execute-query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        connectionString,
                        dbName,
                        collection: collection,
                        query: null,
                        queryType: 'getSearchIndexes'
                    })
                });

                const data = await response.json();
                
                if (data.success && Array.isArray(data.result)) {
                    const indexList = data.result;
                    let targetIndexFound = false;
                    let indexListHTML = '<div style="margin-top: 12px;">';
                    
                    indexList.forEach(idx => {
                        const status = idx.status || (idx.queryable === true ? 'READY' : 'BUILDING');
                        const statusColor = status === 'READY' ? '#00ED64' : 
                                          status === 'BUILDING' || status === 'PENDING' ? '#FFC107' : 
                                          status === 'FAILED' ? '#FF5252' : '#B8C5D1';
                        const statusIcon = status === 'READY' ? 'âœ…' : 
                                          status === 'BUILDING' || status === 'PENDING' ? 'â³' : 
                                          status === 'FAILED' ? 'âŒ' : 'â“';
                        
                        if (idx.name === indexName) {
                            targetIndexFound = true;
                        }
                        
                        indexListHTML += `
                            <div style="margin-bottom: 16px; padding: 12px; background: rgba(0, 0, 0, 0.2); border-radius: 4px; border-left: 3px solid ${statusColor};">
                                <p style="color: ${statusColor}; margin: 0 0 8px 0; font-size: 15px; font-weight: bold;">
                                    ${statusIcon} <strong>${idx.name || 'ì´ë¦„ ì—†ìŒ'}</strong> - ìƒíƒœ: <strong>${status}</strong>
                                </p>
                                ${status === 'READY' ? 
                                    '<p style="color: #00ED64; margin: 4px 0; font-size: 13px;">âœ… Indexê°€ ì¤€ë¹„ë˜ì—ˆìŠµë‹ˆë‹¤. ê²€ìƒ‰ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>' :
                                    status === 'BUILDING' || status === 'PENDING' ?
                                    '<p style="color: #FFC107; margin: 4px 0; font-size: 13px;">â³ Indexê°€ ìƒì„± ì¤‘ì…ë‹ˆë‹¤. ëª‡ ë¶„ í›„ ë‹¤ì‹œ í™•ì¸í•˜ì„¸ìš”. (ì´ë¦„: ' + (idx.name || 'ì•Œ ìˆ˜ ì—†ìŒ') + ', ìƒíƒœ: ' + status + ')</p>' :
                                    status === 'FAILED' ?
                                    '<p style="color: #FF5252; margin: 4px 0; font-size: 13px;">âŒ Index ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. Atlas UIì—ì„œ í™•ì¸í•˜ì„¸ìš”.</p>' :
                                    '<p style="color: #B8C5D1; margin: 4px 0; font-size: 13px;">â“ Index ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ì´ë¦„: ' + (idx.name || 'ì•Œ ìˆ˜ ì—†ìŒ') + ')</p>'
                                }
                                <details style="margin-top: 8px;">
                                    <summary style="color: #B8C5D1; font-size: 12px; cursor: pointer;">ìƒì„¸ ì •ë³´ ë³´ê¸°</summary>
                                    <pre style="margin-top: 8px; padding: 8px; background: rgba(0, 0, 0, 0.3); border-radius: 4px; font-size: 11px; overflow-x: auto;">${JSON.stringify(idx, null, 2)}</pre>
                                </details>
                            </div>
                        `;
                    });
                    
                    indexListHTML += '</div>';
                    
                    resultBox.classList.remove('error');
                    resultBox.classList.add('success', 'show', 'collapsed');
                    resultBox.innerHTML = `
                        <div class="result-header" onclick="toggleResultBox(this)">
                            <span>ì¸ë±ìŠ¤ ëª©ë¡ ë° ìƒíƒœ í™•ì¸ ì™„ë£Œ</span>
                            <span class="toggle-icon">â–¼</span>
                        </div>
                        <div class="result-content">
                            <p style="color: #B8C5D1; margin: 8px 0; font-size: 14px;">ì´ <strong>${indexList.length}</strong>ê°œì˜ Indexê°€ ìˆìŠµë‹ˆë‹¤.</p>
                            ${targetIndexFound ? 
                                `<p style="color: #00ED64; margin: 8px 0; font-size: 14px;">âœ… ì°¾ê³  ìˆëŠ” Index '${indexName}'ê°€ ëª©ë¡ì— ìˆìŠµë‹ˆë‹¤.</p>` :
                                indexName ? 
                                `<p style="color: #FFC107; margin: 8px 0; font-size: 14px;">âš ï¸ ì°¾ê³  ìˆëŠ” Index '${indexName}'ê°€ ëª©ë¡ì— ì—†ìŠµë‹ˆë‹¤. Index ì´ë¦„ì„ í™•ì¸í•˜ì„¸ìš”.</p>` :
                                ''
                            }
                            ${indexListHTML}
                        </div>
                    `;
                } else {
                    // ì—ëŸ¬ê°€ ë°œìƒí•œ ê²½ìš°
                    let errorMessage = data.error || 'Index ëª©ë¡ì„ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                    let errorHint = data.hint || '';
                    
                    if (data.error && (data.error.includes('getSearchIndexes') || data.error.includes('Search Index'))) {
                        errorHint = 'MongoDB ë“œë¼ì´ë²„ë¥¼ í†µí•œ Index ëª©ë¡ ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\n' +
                            'ê°€ëŠ¥í•œ ì›ì¸:\n' +
                            '1. Indexê°€ ì•„ì§ ìƒì„±ë˜ì§€ ì•Šì•˜ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n' +
                            '2. Indexê°€ ìƒì„± ì¤‘(BUILDING)ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n' +
                            '3. MongoDB ë“œë¼ì´ë²„ ë²„ì „ ë¬¸ì œì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n' +
                            'í•´ê²° ë°©ë²•:\n' +
                            '1. MongoDB Atlas UIì—ì„œ ì§ì ‘ í™•ì¸í•˜ì„¸ìš”:\n' +
                            '   - Atlas ì½˜ì†” â†’ Search â†’ Indexes\n' +
                            '   - Index ì´ë¦„ê³¼ ìƒíƒœë¥¼ í™•ì¸í•˜ì„¸ìš”\n' +
                            '2. Indexê°€ BUILDING ìƒíƒœë©´ ëª‡ ë¶„ í›„ ë‹¤ì‹œ í™•ì¸í•˜ì„¸ìš”.\n' +
                            '3. Indexê°€ ì—†ìœ¼ë©´ ì•„ë˜ "Index ìƒì„±" ì„¹ì…˜ì—ì„œ Index ìƒì„± ë°©ë²•ì„ í™•ì¸í•˜ì„¸ìš”.';
                    }
                    
                    resultBox.classList.remove('success');
                    resultBox.classList.add('error', 'show', 'collapsed');
                    resultBox.innerHTML = `
                        <div class="result-header" onclick="toggleResultBox(this)">
                            <span>ì¸ë±ìŠ¤ ìƒíƒœ í™•ì¸ ì™„ë£Œ</span>
                            <span class="toggle-icon">â–¼</span>
                        </div>
                        <div class="result-content">
                            <p style="color: #FF5252; margin: 8px 0; font-size: 16px; font-weight: bold;">âŒ ${errorMessage}</p>
                            <p style="color: #B8C5D1; margin: 8px 0; font-size: 14px; white-space: pre-line;">${errorHint}</p>
                            <p style="color: #7A8B99; margin: 8px 0; font-size: 12px; margin-top: 12px;">ğŸ’¡ íŒ: Indexê°€ ìƒì„± ì¤‘ì´ë©´ Atlas UIì—ì„œ ì´ë¦„ê³¼ ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('âŒ ì¸ë±ìŠ¤ ìƒíƒœ í™•ì¸ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                showError(resultBox, 'ì„œë²„ì™€ í†µì‹ í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        async function checkIndexSize(collection, indexType) {
            // localStorageì—ì„œ ë¨¼ì € ì½ê¸°
            let connectionString = localStorage.getItem('atlasDemoConnectionString');
            let dbName = localStorage.getItem('atlasDemoDbName');
            
            // ì—†ìœ¼ë©´ ì…ë ¥ í•„ë“œì—ì„œ ì½ê¸°
            const connectionStringInput = document.getElementById('connectionString');
            const dbNameInput = document.getElementById('dbName');
            
            if (!connectionString && connectionStringInput) {
                connectionString = connectionStringInput.value.trim();
            }
            if (!dbName && dbNameInput) {
                dbName = dbNameInput.value.trim();
            }
            
            connectionString = connectionString ? connectionString.trim() : '';
            dbName = dbName ? dbName.trim() : '';
            
            const resultBox = document.getElementById(`result-index-size-${indexType}`);
            
            if (!connectionString || !dbName) {
                showError(resultBox, 'ì—°ê²° ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.', 'ìƒë‹¨ì˜ ì—°ê²° ì •ë³´ ì…ë ¥ í¼ì— MongoDB Atlas ì—°ê²° ë¬¸ìì—´ê³¼ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì—°ê²° ë¬¸ìì—´ í˜•ì‹ ê²€ì¦
            if (!connectionString.startsWith('mongodb://') && !connectionString.startsWith('mongodb+srv://')) {
                showError(resultBox, 'ì˜¬ë°”ë¥¸ ì—°ê²° ë¬¸ìì—´ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.', 'ì—°ê²° ë¬¸ìì—´ì€ mongodb:// ë˜ëŠ” mongodb+srv://ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            resultBox.classList.remove('show', 'success', 'error');
            resultBox.classList.add('show');
            resultBox.innerHTML = '<div class="result-header">ì¸ë±ìŠ¤ ì‚¬ì´ì¦ˆ ì¡°íšŒ ì¤‘...</div><div class="loading"></div>';

            try {
                // ì¸ë±ìŠ¤ ì´ë¦„ ê²°ì • (dynamic ë˜ëŠ” static)
                const indexName = indexType === 'dynamic' ? 'bigProductSearchDynamic' : 'bigProductSearchStatic';
                
                const response = await fetch('/api/execute-query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        connectionString,
                        dbName,
                        collection: collection,
                        query: null,
                        queryType: 'getSearchIndexes'
                    })
                });

                const data = await response.json();
                
                if (data.success && Array.isArray(data.result)) {
                    const indexList = data.result;
                    const targetIndex = indexList.find(idx => idx.name === indexName);
                    
                    if (targetIndex) {
                        // ì¸ë±ìŠ¤ ì •ë³´ í‘œì‹œ
                        const status = targetIndex.status || (targetIndex.queryable === true ? 'READY' : 'BUILDING');
                        const statusColor = status === 'READY' ? '#00ED64' : status === 'BUILDING' ? '#FFC107' : '#FF5252';
                        
                        resultBox.classList.remove('error');
                        resultBox.classList.add('success', 'show', 'collapsed');
                        resultBox.innerHTML = `
                            <div class="result-header" onclick="toggleResultBox(this)">
                                <span>ì¸ë±ìŠ¤ ì‚¬ì´ì¦ˆ ì¡°íšŒ ì™„ë£Œ (${indexName})</span>
                                <span class="toggle-icon">â–¼</span>
                            </div>
                            <div class="result-content">
                                <div style="margin-bottom: 16px; padding: 12px; background: rgba(0, 0, 0, 0.2); border-radius: 4px; border-left: 3px solid ${statusColor};">
                                    <p style="color: ${statusColor}; margin: 0 0 8px 0; font-size: 15px; font-weight: bold;">
                                        ğŸ“Š <strong>${indexName}</strong> - ìƒíƒœ: <strong>${status}</strong>
                                    </p>
                                    <p style="color: #B8C5D1; margin: 4px 0; font-size: 13px;">
                                        ğŸ’¡ <strong>ì¸ë±ìŠ¤ ì‚¬ì´ì¦ˆ í™•ì¸ ë°©ë²•:</strong>
                                    </p>
                                    <ol style="color: #B8C5D1; margin: 8px 0; padding-left: 20px; font-size: 13px;">
                                        <li>MongoDB Atlas UI â†’ Search â†’ Indexes</li>
                                        <li>ì¸ë±ìŠ¤ ì´ë¦„ "${indexName}" í´ë¦­</li>
                                        <li>"Index Size" ë˜ëŠ” "Storage Size" í™•ì¸</li>
                                    </ol>
                                    <p style="color: #7A8B99; margin: 8px 0; font-size: 12px; margin-top: 12px;">
                                        âš ï¸ ì¸ë±ìŠ¤ ì‚¬ì´ì¦ˆëŠ” MongoDB ë“œë¼ì´ë²„ë¡œ ì§ì ‘ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. Atlas UIì—ì„œ í™•ì¸í•˜ì„¸ìš”.
                                    </p>
                                </div>
                                <details style="margin-top: 8px;">
                                    <summary style="color: #B8C5D1; font-size: 12px; cursor: pointer;">ì¸ë±ìŠ¤ ìƒì„¸ ì •ë³´ ë³´ê¸°</summary>
                                    <pre style="margin-top: 8px; padding: 8px; background: rgba(0, 0, 0, 0.3); border-radius: 4px; font-size: 11px; overflow-x: auto;">${JSON.stringify(targetIndex, null, 2)}</pre>
                                </details>
                            </div>
                        `;
                    } else {
                        resultBox.classList.remove('success');
                        resultBox.classList.add('error', 'show', 'collapsed');
                        resultBox.innerHTML = `
                            <div class="result-header" onclick="toggleResultBox(this)">
                                <span>ì¸ë±ìŠ¤ ì‚¬ì´ì¦ˆ ì¡°íšŒ ì™„ë£Œ</span>
                                <span class="toggle-icon">â–¼</span>
                            </div>
                            <div class="result-content">
                                <p style="color: #FFC107; margin: 8px 0; font-size: 16px; font-weight: bold;">âš ï¸ ì¸ë±ìŠ¤ '${indexName}'ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                                <p style="color: #B8C5D1; margin: 8px 0; font-size: 14px;">
                                    í˜„ì¬ ë“±ë¡ëœ ì¸ë±ìŠ¤ ëª©ë¡:
                                </p>
                                <ul style="color: #B8C5D1; margin: 8px 0; padding-left: 20px; font-size: 13px;">
                                    ${indexList.length > 0 ? 
                                        indexList.map(idx => `<li>${idx.name || 'ì´ë¦„ ì—†ìŒ'}</li>`).join('') :
                                        '<li>ë“±ë¡ëœ ì¸ë±ìŠ¤ê°€ ì—†ìŠµë‹ˆë‹¤.</li>'
                                    }
                                </ul>
                                <p style="color: #7A8B99; margin: 8px 0; font-size: 12px; margin-top: 12px;">
                                    ğŸ’¡ ì¸ë±ìŠ¤ë¥¼ ìƒì„±í•˜ë ¤ë©´ Atlas UIì—ì„œ "${indexName}" ì´ë¦„ìœ¼ë¡œ ì¸ë±ìŠ¤ë¥¼ ìƒì„±í•˜ì„¸ìš”.
                                </p>
                            </div>
                        `;
                    }
                } else {
                    showError(resultBox, data.error || 'ì¸ë±ìŠ¤ ëª©ë¡ì„ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', data.hint || '');
                }
            } catch (error) {
                console.error('âŒ ì¸ë±ìŠ¤ ì‚¬ì´ì¦ˆ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
                showError(resultBox, 'ì„œë²„ì™€ í†µì‹ í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        // ì½”ë“œ ë³µì‚¬ ê¸°ëŠ¥
        function copyCodeToClipboard(button, codeText) {
            navigator.clipboard.writeText(codeText).then(() => {
                const originalText = button.textContent;
                button.textContent = 'ë³µì‚¬ë¨!';
                button.classList.add('copied');
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
                alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•´ì£¼ì„¸ìš”.');
            });
        }

        // ëª¨ë“  ì½”ë“œ ë¸”ë¡ì— ë³µì‚¬ ë²„íŠ¼ ì¶”ê°€
        function addCopyButtonsToCodeBlocks() {
            const codeBlocks = document.querySelectorAll('.code-block');
            codeBlocks.forEach((block, index) => {
                // ì´ë¯¸ ë³µì‚¬ ë²„íŠ¼ì´ ìˆìœ¼ë©´ ìŠ¤í‚µ
                if (block.querySelector('.copy-btn')) {
                    return;
                }

                const codeElement = block.querySelector('code');
                if (codeElement) {
                    const codeText = codeElement.textContent || codeElement.innerText;
                    const copyButton = document.createElement('button');
                    copyButton.className = 'copy-btn';
                    copyButton.textContent = 'ë³µì‚¬';
                    copyButton.onclick = () => copyCodeToClipboard(copyButton, codeText);
                    block.appendChild(copyButton);
                }
            });
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë³µì‚¬ ë²„íŠ¼ ì¶”ê°€
        document.addEventListener('DOMContentLoaded', () => {
            addCopyButtonsToCodeBlocks();
        });

        // ë™ì ìœ¼ë¡œ ì¶”ê°€ë˜ëŠ” ì½”ë“œ ë¸”ë¡ì—ë„ ë³µì‚¬ ë²„íŠ¼ ì¶”ê°€ë¥¼ ìœ„í•´ MutationObserver ì‚¬ìš©
        const observer = new MutationObserver(() => {
            addCopyButtonsToCodeBlocks();
        });

        observer.observe(document.body, {
            childList: true,
            subtree: true
        });
    </script>
</body>
</html>
